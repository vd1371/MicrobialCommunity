;; The feed (organics) and the different groups of bacteria are breeds of turtles
Breed [carbs carb] ;; Carbohydrates
Breed [glucose a-glucose];; Glucose

Breed [proteins protein] ;; Proteins
Breed [glycines glycine] ;; Glycines
Breed [serines serine] ;; Serine
Breed [threonines threonine] ;; Threonine
Breed [aspartates aspartate] ;; Aspartate
Breed [glutamics glutamic] ;; Glutamic acid

Breed [lipids lipid] ;; Lipids
Breed [myristates myristate] ;; Myristates
Breed [palmitates palmitate] ;; Palmitate
Breed [stearates stearate] ;; Stearate
Breed [oleates oleate] ;; Oleate
Breed [linoleates linoleate] ;; Linoleate

Breed [ammonium a-ammonium] ;; Ammonium
Breed [ammonia a-ammonia] ;; Ammonia
Breed [water a-water] ;; Water is considered as infinite and each patch contains 100 moles
Breed [bicarbonates bicarbonate] ;; The concentration of diluted bicarbonate is considered
Breed [CO2s CO2] ;; The concentration of diluted carbon dioxide is considered
Breed [CH4s CH4] ;; The concentration of diluted methane is considered
Breed [hydrogens hydrogen] ;; Hydrogens
Breed [protons proton] ;; The concentration of protons depends on the pH
Breed [butyrates butyrate] ;; Butyrates
Breed [propionates propionate] ;; Propionates
Breed [ethanols ethanol] ;; Ethanols
Breed [acetates acetate] ;; Acetates

Breed [clostridiales_FB1 clostridial_FB1] ;; Clostridium beijerinckii a fermentive bacteria (FB) representing Equation 1 based on Lin et al., 2007
Breed [clostridiales_FB2 clostridial_FB2] ;; Clostridium cochlearium JCM 1396 as Fermentive Bacteria (FB) representing Equation 2 based on Cibis et al., 2016
Breed [clostridiales_FB3 clostridial_FB3] ;; Clostridium cochlearium JCM 1396 as Fermentive Bacteria (FB) representing Equation 3 based on Cibis et al., 2016
Breed [clostridiales_FB4 clostridial_FB4] ;; Ruminococcus albus,  R. faecis, R. torques. as Fermentive Bacteria (FB) representing Equation 4 based on Ntaikou et al., 2010 and Vavilini et al., 2000

Breed [clostridiales_FB6 clostridial_FB6] ;; Hathewaya histolytica and Clostridium sticklandii as Fermentive Bacteria (FB) representing Equation 6 based on Lawson and Rainey, 2016; Fonknechten et al., 2010.
Breed [clostridiales_FB7 clostridial_FB7] ;; Hathewaya histolytica and Clostridium sticklandii as Fermentive Bacteria (FB) representing Equation 7 based on Lawson and Rainey, 2016; Fonknechten et al., 2010.
Breed [clostridiales_FB8 clostridial_FB8] ;; Hathewaya histolytica, Clostridium sticklandii, Hathewaya limosa (Clostridium limosum) and Clostridium Sporogenes as Fermentive Bacteria (FB) representing Equation 8 based on Lawson and Rainey, 2016; Fonknechten et al., 2010; and Bergey et al., 2001.
Breed [clostridiales_FB9 clostridial_FB9] ;; Hathewaya histolytica and Clostridium sporogenes as Fermentive Bacteria (FB) representing Equation 9 based on Lawson and Rainey, 2016; and Bergey et al., 2001.
Breed [clostridiales_FB10 clostridial_FB10] ;; Hathewaya histolytica, Clostridium tetanomorphum, Acetroanaerobium sticklandii (Clostridium sticklandii), peptococcus aerogenes now named as Peptoniphilus asaccharolyticus as Fermentive Bacteria (FB) representing Equation 10 based on Lawson and Rainey, 2016; Wilde et al., 1989; Fonknechten et al., 2010; and Ezaki et al., 2001.

Breed [bacteroidales_FB1 bacteroidal_FB1] ;; Butyricimonas faecihominis, Butyricimonas paravirosa and Mucinivorans hirudinis as Fermentive Bacteria (FB) representing Equation 1 based on Sakamoto et al., 2014 and Nelson et al., 2015
Breed [bacteroidales_FB2 bacteroidal_FB2] ;; Porphyromonas pasteri, Parabacteroides chartae and Mucinivorans hirudinis as Fermentive Bacteria (FB) representing Equation 2 based on Sakamoto et al., 2015; Tan et al., 2012 and Nelson et al., 2015
Breed [bacteroidales_FB3 bacteroidal_FB3] ;; Bacteroides cellulosilyticus, Proteiniphilum saccharofermentans, Petrimonas mucosa, Fermentimonas caenicola, and Mucinivorans hirudinis as Fermentive Bacteria (FB) representing Equation 3 based on Robert et al., 2007; Hahnke et al., 2016 and Nelson et al., 2015
Breed [bacteroidales_FB4 bacteroidal_FB4] ;; Bacteroides xylanolyticus and Mucinivorans hirudinis as Fermentive Bacteria (FB) representing Equation 4 based on Scholten-Koerselman et al., 1986 and Nelson et al., 2015
Breed [bacteroidales_FB5 bacteroidal_FB5] ;; Bacteroides koreensis, Bacteroides kribbi, Petrimonas sulfuriphila, Acetobacteroides hydrogenigenes and Mucinivorans hirudinis as Fermentive Bacteria (FB) representing Equation 5 based on Shin et al., 2017, Grabowski et al., 2005; Su et al., 2014 and and Nelson et al., 2015

Breed [bacteroidales_FB6 bacteroidal_FB6] ;; Proteiniphilum acetatigens as Fermentive Bacteria (FB) representing Equation 6 based on Chen and Dong, 2005 and Hahnke et al.,2016
Breed [bacteroidales_FB7 bacteroidal_FB7] ;; Proteiniphilum acetatigens as Fermentive Bacteria (FB) representing Equation 7 based on Chen and Dong, 2005 and Hahnke et al.,2016
Breed [bacteroidales_FB8 bacteroidal_FB8] ;; Proteiniphilum acetatigens as Fermentive Bacteria (FB) representing Equation 8 based on Chen and Dong, 2005 and Hahnke et al.,2016

Breed [thermotogales_FB5 thermotogal_FB5] ;; Thermosipho affectus and Oceanotoga teriensis as Fermentive Bacteria (FB) representing Equation 5 based on Podosokorskaya et al., 2011 and Jayasinghearachchi and Lal, 2011
Breed [thermotogales_FB6 thermotogal_FB6] ;; Oceanotoga teriensis and Coprobacter secundus as Fermentive Bacteria (FB) representing Equation 6 based on Jayasinghearachchi and Lal, 2011; and Shkoporov et al., 2015
Breed [thermotogales_FB7 thermotogal_FB7] ;; Oceanotoga teriensis as Fermentive Bacteria (FB) representing Equation 7 based on Jayasinghearachchi and Lal, 2011
Breed [thermotogales_FB8 thermotogal_FB8] ;; Oceanotoga teriensis as Fermentive Bacteria (FB) representing Equation 8 based on Jayasinghearachchi and Lal, 2011
Breed [thermotogales_FB9 thermotogal_FB13] ;; Oceanotoga teriensis as Fermentive Bacteria (FB) representing Equation 9 based on Jayasinghearachchi and Lal, 2011
Breed [thermotogales_FB10 thermotogal_FB10] ;; Oceanotoga teriensis and Coprobacter secundus as Fermentive Bacteria (FB) representing Equation 10 based on Jayasinghearachchi and Lal, 2011; and Shkoporov et al., 2015

Breed [syntrophomonas_AC11 syntrophomona_AC11] ;; Syntrophomonas curvata, Syntrophomonas palmitatica, Syntrophomonas Saponavida, and Syntrophomonas sapovorans as acetogenic bacteria (AC)representing Equation 11 based on Zhang et al., 2004; Hatamoto et al., 2007; and Roy et al., 1986.
Breed [syntrophomonas_AC12 syntrophomona_AC12] ;; Syntrophomonas curvata, Syntrophomonas palmitatica, Syntrophomonas Saponavida, Syntrophomonas sapovorans and Syntrophomonas zehnderi as acetogenic bacteria (AC)representing Equation 12 based on Zhang et al., 2004; Hatamoto et al., 2007; Roy et al., 1986; and Sousa et al., 2007.
Breed [syntrophomonas_AC13 syntrophomona_AC13] ;; Syntrophomonas curvata, Syntrophomonas palmitatica, Syntrophomonas Saponavida, and Syntrophomonas sapovorans as acetogenic bacteria (AC)representing Equation 13 based on Zhang et al., 2004; Hatamoto et al., 2007; and Roy et al., 1986.
Breed [syntrophomonas_AC14 syntrophomona_AC14] ;; Syntrophomonas curvata, Syntrophomonas Saponavida, Syntrophomonas sapovorans and Syntrophomonas zehnderi as acetogenic bacteria (AC)representing Equation 14 based on Zhang et al., 2004; Roy et al., 1986; and Sousa et al., 2007.
Breed [syntrophomonas_AC15 syntrophomona_AC15] ;; Syntrophomonas curvata, Syntrophomonas Saponavida, Syntrophomonas sapovorans and Syntrophomonas zehnderi as acetogenic bacteria (AC)representing Equation 15 based on Zhang et al., 2004; Roy et al., 1986; and Sousa et al., 2007.

Breed [syntrophomonas_AC16 syntrophomona_AC16] ;; Syntrophomonas wolfei an Acetogenic bacteria (AC) representing Equation 16 based on Gujer and Zehnder 1983; Lowe et al., 1993 and Agler et al., 2010

Breed [syntrophus_AC12 a-syntrophus_AC12] ;; Syntrophus aciditrophicus as acetogenic bacteria (AC) representing Equation 12 based on Jackson et al., 1999.
Breed [syntrophus_AC13 a-syntrophus_AC13] ;; Syntrophus aciditrophicus as acetogenic bacteria (AC) representing Equation 13 based on Jackson et al., 1999.
Breed [syntrophus_AC16 a-syntrophus_AC16] ;; Syntrophus aciditrophicus as acetogenic bacteria (AC) representing Equation 16 based on Jackson et al., 1999.

Breed [Syntrophobacterales_AC17 Syntrophobacteral_AC17] ;; Syntrophobacter wolinii, Syntrophobacter fumaroxidans and Smithella propionica as acetogenic bacteria (AC) representing Equation 17 based on Heyes and Hall, 1983; Boone and Bryant, 1980, and Liu et al., 1999.

Breed [C.kluyveri_AC18 a-C.kluyveri_AC18] ;; Clostridium kluyveri as acetogenic bacteria (AC) representing Equation 18 based on Agler et al., 2010, Garcia-Gen et al., 2013, Weimer and Stevenson 2012; and Schink et al., 1985
Breed [C.aceticum_FB5/HAB19 clostridium_FB5/HAB19] ;; Clostridium aceticum as Fermentive Bacteria (FB) representing Equation 5 and as Homoacetogenic Bacteria (HAB) representing Equation 19 based on Munisamy et al., 2017; Amani et al., 2010 and Saady, 2013
Breed [Acetobacterium.woodii_FB5/HAB19 Acetobacterium_FB5/HAB19] ;; Acetobacterium woodii as Fermentive Bacteria (FB) representing Equation 5 and as Homoacetogenic Bacteria (HAB) representing Equation 19 based on Munisamy et al., 2017; Agler et al., 2011 and Saady, 2013
Breed [C.aceticum_HAB19 a-C.aceticum_HAB19] ;; Clostridium aceticum and Acetobacterium woodii are Homoacetogenic bacteria (HAB) representing Equation 19 based on Amani et al., 2010; Agler et al., 2011 and Saady 2013
Breed [C.ultunense_FB5/HPB20 a-C.ultunense_FB5/HPB20] ;; Clostridium ultunense as Fermentive Bacteria (FB) representing Equation 5 and as Hydrogen-producing bacteria (HPB) representing Equation 20 based on Westerholm et al., 2010; Schnurer et al., 1996 and Muller et al., 2013

Breed [M.sarcinales_AM21/HM22 M.sarcinal_AM21/HM22] ;; Methanosarcinal barkeri as Acetoclastic methanogen (AM) representing Equation 21 and as Hydrogenotrophic methanogen (HM) representing Equation 22 based on Qu et al., 2009; Ling et al., 2018 and Kalyuzhnyi and Fedorovich 1998
Breed [M.concilii_AM21 a-M.concilii_AM21] ;; Methanosaeta concilii as Acetoclastic methanogen (AM) representing Equation 21 based on Amani et al., 2010

Breed [M.microbiales_HM22 a-M.microbiales_HM22] ;; Methanoculleus bourgensis and Methanospirillum hungatei as Hydrogenotrophic methanogen (HM) representing Eq. 22 based on Westerholm et al., 2010; Schunerer et al., 1996; and Sousa et al., 2009.
Breed [M.bacteriales_HM22 a-M.bacteriales_HM22] ;; Methanobacterium bryantii and Methanobacterium formicicum as Hydrogenotrophic methanogen (HM) representing Eq. 22 based on Amani et al., 2010 and Sousa et al., 2009.

carbs-own [carbs_mass] ;; The feed, ammonium and the diff. groups of bacteria have mass which represent the moles
glucose-own [glucose_mass]

proteins-own [proteins_mass]
glycines-own [glycines_mass]
serines-own [serines_mass]
threonines-own [threonines_mass]
aspartates-own [aspartates_mass]
glutamics-own [glutamics_mass]

lipids-own [lipids_mass]
myristates-own [myristates_mass]
palmitates-own [palmitates_mass]
stearates-own [stearates_mass]
oleates-own [oleates_mass]
linoleates-own [linoleates_mass]

CO2s-own[CO2s_mass]
CH4s-own [CH4s_mass]
ammonia-own [ammonia_mass]
ammonium-own [ammonium_mass]
butyrates-own [butyrates_mass]
propionates-own [propionates_mass]
ethanols-own [ethanols_mass]
acetates-own [acetates_mass]
bicarbonates-own [bicarbonates_mass]
hydrogens-own [hydrogens_mass]
Protons-own [Protons_mass]

clostridiales_FB1-own
[
  Clostridiales_FB1_mass
  uptake_FB1 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB2-own
[
  Clostridiales_FB2_mass
  uptake_FB2 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB3-own
[
  Clostridiales_FB3_mass
  uptake_FB3 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB4-own
[
  Clostridiales_FB4_mass
  uptake_FB4 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB6-own
[
  Clostridiales_FB6_mass
  uptake_FB6 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB7-own
[
  Clostridiales_FB7_mass
  uptake_FB7 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB8-own
[
  Clostridiales_FB8_mass
  uptake_FB8 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB9-own
[
  Clostridiales_FB9_mass
  uptake_FB9 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

clostridiales_FB10-own
[
  Clostridiales_FB10_mass
  uptake_FB10 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB1-own
[
  bacteroidales_FB1_mass
  uptake_b_FB1 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


bacteroidales_FB2-own
[
  bacteroidales_FB2_mass
  uptake_b_FB2 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB3-own
[
  bacteroidales_FB3_mass
  uptake_b_FB3 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB4-own
[
  bacteroidales_FB4_mass
  uptake_b_FB4 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB5-own
[
  bacteroidales_FB5_mass
  uptake_b_FB5 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB6-own
[
  bacteroidales_FB6_mass
  uptake_b_FB6 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB7-own
[
  bacteroidales_FB7_mass
  uptake_b_FB7 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

bacteroidales_FB8-own
[
  bacteroidales_FB8_mass
  uptake_b_FB8 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


thermotogales_FB5-own
[
  thermotogales_FB5_mass
  uptake_t_FB5 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

thermotogales_FB6-own
[
  thermotogales_FB6_mass
  uptake_t_FB6 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

thermotogales_FB7-own
[
  thermotogales_FB7_mass
  uptake_t_FB7 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

thermotogales_FB8-own
[
  thermotogales_FB8_mass
  uptake_t_FB8 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

thermotogales_FB9-own
[
  thermotogales_FB9_mass
  uptake_t_FB9 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

thermotogales_FB10-own
[
  thermotogales_FB10_mass
  uptake_t_FB10 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophomonas_AC11-own
[
  syntrophomonas_AC11_mass
  uptake_s_AC11 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophomonas_AC12-own
[
  syntrophomonas_AC12_mass
  uptake_s_AC12 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophomonas_AC13-own
[
  syntrophomonas_AC13_mass
  uptake_s_AC13 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophomonas_AC14-own
[
  syntrophomonas_AC14_mass
  uptake_s_AC14 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophomonas_AC15-own
[
  syntrophomonas_AC15_mass
  uptake_s_AC15 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


syntrophomonas_AC16-own
[
  syntrophomonas_AC16_mass
  uptake_s_AC16 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophus_AC12-own
[
  syntrophus_AC12_mass
  uptake_su_AC12 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophus_AC13-own
[
  syntrophus_AC13_mass
  uptake_su_AC13 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

syntrophus_AC16-own
[
  syntrophus_AC16_mass
  uptake_su_AC16 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

Syntrophobacterales_AC17-own
[
  Syntrophobacterales_AC17_mass
  uptake_s_AC17 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

C.kluyveri_AC18-own
[
  C.kluyveri_AC18_mass
  uptake_AC18 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

C.aceticum_HAB19-own
[
  C.aceticum_HAB19_mass
  uptake_HAB19 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


C.ultunense_FB5/HPB20-own
[
  C.ultunense_FB5/HPB20_mass
  uptake_FB5 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for glucose
  uptake_HPB20 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for hydrogen
  Gr ;; In-situ Gibbs free energy of the energy reaction
  Gr_2
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

C.aceticum_FB5/HAB19-own
[
  C.aceticum_FB5/HAB19_mass
  uptake_FB5 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for glucose
  uptake_HAB19 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for hydrogen
  Gr ;; In-situ Gibbs free energy of the glucose energy reaction
  Gr_2 ;; In-situ Gibbs free energy of the hydrogen energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

Acetobacterium.woodii_FB5/HAB19-own
[
  Acetobacterium.woodii_FB5/HAB19_mass
  uptake_FB5 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for glucose
  uptake_HAB19 ;; The maximum uptake rate of each bacteria in mmol/mmol/h for hydrogen
  Gr ;; In-situ Gibbs free energy of the glucose energy reaction
  Gr_2 ;; In-situ Gibbs free energy of the hydrogen energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]

M.sarcinales_AM21/HM22-own
[
  M.sarcinales_AM21/HM22_mass
  uptake_AM21 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  uptake_HM22 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  Gr_2
  energy_fs_acetate ;; The fraction of energy used for synthesis
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


M.concilii_AM21-own
[
  M.concilii_AM21_mass
  uptake_AM21 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


M.microbiales_HM22-own
[
 M.microbiales_HM22_mass
  uptake_HM22 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


M.bacteriales_HM22-own
[
 M.bacteriales_HM22_mass
  uptake_HM22 ;; The maximum uptake rate of each bacteria in mmol/mmol/h
  Gr ;; In-situ Gibbs free energy of the energy reaction
  energy_fs ;; The fraction of energy used for synthesis
  energy_fe ;; The fraction of energy used for energy
]


patches-own
[
  moles
]

Globals
[
;; OLR_Feed= Organic loading rate in g VSS/Ld
;; mgCOD/mgVSS= ratio of COD to VSS in the feed sludge
;; Ammonium_concentration= Ammonium concentration in the feed sludge in mg/L
;; Reactor's working volume= The working volume of the reactor in L
;; Temperature= The temperature of the reactor in degrees Celsius
;; Carbohydrates_percentage= the percentage of carbohydrates in the feed sludge
;; MLVSS= The mixed liquor volatiles suspended solids in mg/L
;; Bacteria_percentage= Represents the percentage of each bacteria group in the reactor
feed_volume
time
Temp ;; Converts the temperature in degrees Celsius to degrees Kelvin.


;; The following globals are used to determine the concentration at the beginning of each tick which is used for in-situ Gr determination
Initial_concentration_glucose

Initial_concentration_glycines
Initial_concentration_serines
Initial_concentration_threonines
Initial_concentration_aspartates
Initial_concentration_glutamics

Initial_concentration_myristates
Initial_concentration_palmitates
Initial_concentration_stearates
Initial_concentration_oleates
Initial_concentration_linoleates

Initial_concentration_ammonium
Initial_concentration_ammonia

Initial_concentration_bicarbonates
Initial_concentration_CO2s
Initial_concentration_CH4s
Initial_concentration_hydrogens
Initial_concentration_protons
Initial_concentration_butyrates
Initial_concentration_propionates
Initial_concentration_ethanols
Initial_concentration_acetates

;; The following globals are used for the determination of concentration of the gasses and then determine the dissolved gas according to Henry's law by using the Henry's constant influenced by temperature
CO2%
CH4%
H2%
LCO2
LCH4
LH2

;; The following globals account for the final count of the elements of interest

;; REACTANTS AND PRODUCTS ;;;


effluent_CO2s_mol
effluent_CO2s_ml
effluent_CH4s_mol
effluent_CH4s_ml
effluent_H2s_mol
effluent_H2s_ml
last_tick_hydrogen

total_carbs
total_glucose

total_proteins
total_glycines
total_serines
total_threonines
total_aspartates
total_glutamics

total_lipids
total_myristates
total_palmitates
total_stearates
total_oleates
total_linoleates

total_ammonium
total_ammonia
total_bicarbonates

last_day_methane
last_day_CO2
last_day_biogas
total_CO2s_mol
total_CO2s_ml
accumul_CO2s_ml
accumul_CO2s_ml_daily
total_CH4s_mol
total_CH4s_ml
accumul_CH4s_ml
accumul_CH4s_ml_daily
total_hydrogens_mol
total_hydrogens_ml
accumul_hydrogens_ml
accumul_hydrogens_ml_daily
Total_biogas_production
Total_biogas_daily

Methane_content_hourly
Methane_content_daily
Methane_daily
CO2_daily
Biogas_daily

total_protons
total_butyrates
total_propionates
total_ethanols
total_acetates

;;;BACTERIA;;;

total_clostridiales_FB1
total_clostridiales_FB2
total_clostridiales_FB3
total_clostridiales_FB4

total_clostridiales_FB6
total_clostridiales_FB7
total_clostridiales_FB8
total_clostridiales_FB9
total_clostridiales_FB10

total_bacteroidales_FB1
total_bacteroidales_FB2
total_bacteroidales_FB3
total_bacteroidales_FB4
total_bacteroidales_FB5
total_bacteroidales_FB6
total_bacteroidales_FB7
total_bacteroidales_FB8

total_thermotogales_FB5
total_thermotogales_FB6
total_thermotogales_FB7
total_thermotogales_FB8
total_thermotogales_FB9
total_thermotogales_FB10

total_syntrophomonas_AC11
total_syntrophomonas_AC12
total_syntrophomonas_AC13
total_syntrophomonas_AC14
total_syntrophomonas_AC15
 total_syntrophomonas_AC16

total_syntrophus_AC12
total_syntrophus_AC13
total_syntrophus_AC16

total_Syntrophobacterales_AC17

total_C.kluyveri_AC18
total_C.aceticum_HAB19
total_C.ultunense_FB5/HPB20
total_C.aceticum_FB5/HAB19
total_Acetobacterium.woodii_FB5/HAB19

total_M.sarcinales_AM21/HM22
total_M.concilii_AM21

total_M.microbiales_HM22
total_M.bacteriales_HM22

total_percentage_bacteroidales
total_percentage_clostridiales
total_percentage_thermotogales
total_percentage_syntrophomonas
total_percentage_clostridium
total_percentage_syntrophobacterales
total_percentage_syntrophus
total_percentage_methanobacteriales
total_percentage_methanomicrobiales
total_percentage_methanosarcinales
total_percentage_methanosaeta
]


to setup
  clear-all
  set time 0
  set temp (temperature + 273.15) ;; To convert from degrees Celsius to degrees kelvin
  set Initial_concentration_glucose 0 ;; This implies that the concentration at time 0 is o mmol/L

  set Initial_concentration_glycines 0
  set Initial_concentration_serines 0
  set Initial_concentration_threonines 0
  set Initial_concentration_aspartates 0
  set Initial_concentration_glutamics 0

  set Initial_concentration_myristates 0
  set Initial_concentration_palmitates 0
  set Initial_concentration_stearates 0
  set Initial_concentration_oleates 0
  set Initial_concentration_linoleates 0

  set Initial_concentration_ammonium 0
  set Initial_concentration_ammonia 0
  set Initial_concentration_bicarbonates 0
  set Initial_concentration_CO2s 0
  set Initial_concentration_CH4s 0
  set Initial_concentration_hydrogens 0
  set Initial_concentration_protons 0
  set Initial_concentration_butyrates 0
  set Initial_concentration_propionates 0
  set Initial_concentration_ethanols 0
  set Initial_concentration_acetates 0

  set total_carbs 0
  set total_glucose 0

  set total_proteins 0
  set total_glycines 0
  set total_serines 0
  set total_threonines 0
  set total_aspartates 0
  set total_glutamics 0

  set total_lipids 0
  set total_myristates 0
  set total_palmitates 0
  set total_stearates 0
  set total_oleates 0
  set total_linoleates 0

  set total_ammonium 0
  set total_ammonia 0

  set effluent_CO2s_mol 0
  set effluent_CO2s_ml 0
  set effluent_CH4s_mol 0
  set effluent_CH4s_ml 0
  set effluent_h2s_mol 0
  set effluent_h2s_ml 0
  set last_tick_hydrogen 0

  set total_bicarbonates 0

  set last_day_methane 0
  set last_day_CO2 0
  set last_day_biogas 0
  set total_CO2s_mol 0
  set total_CO2s_ml 0
  set accumul_CO2s_ml 0
  set accumul_CO2s_ml_daily 0
  set total_CH4s_mol 0
  set total_CH4s_ml 0
  set accumul_CH4s_ml 0
  set accumul_CH4s_ml_daily 0
  set total_hydrogens_mol 0
  set total_hydrogens_ml 0
  set accumul_hydrogens_ml 0
  set accumul_hydrogens_ml_daily 0
  set Total_biogas_production 0
  set Total_biogas_daily 0
  set methane_content_hourly 0
  set methane_content_daily 0
  set methane_daily 0
  set CO2_daily 0
  set biogas_daily 0

  set total_protons 0
  set total_butyrates 0
  set total_propionates 0
  set total_ethanols 0
  set total_acetates 0

  set total_clostridiales_FB1 0
  set total_clostridiales_FB2 0
  set total_clostridiales_FB3 0
  set total_clostridiales_FB4 0

  set total_clostridiales_FB6 0
  set total_clostridiales_FB7 0
  set total_clostridiales_FB8 0
  set total_clostridiales_FB9 0
  set total_clostridiales_FB10 0

  set total_bacteroidales_FB1 0
  set total_bacteroidales_FB2 0
  set total_bacteroidales_FB3 0
  set total_bacteroidales_FB4 0
  set total_bacteroidales_FB5 0
  set total_bacteroidales_FB6 0
  set total_bacteroidales_FB7 0
  set total_bacteroidales_FB8 0

  set total_thermotogales_FB5 0
  set total_thermotogales_FB6 0
  set total_thermotogales_FB7 0
  set total_thermotogales_FB8 0
  set total_thermotogales_FB9 0
  set total_thermotogales_FB10 0

  set total_syntrophomonas_AC11 0
  set total_syntrophomonas_AC12 0
  set total_syntrophomonas_AC13 0
  set total_syntrophomonas_AC14 0
  set total_syntrophomonas_AC15 0
  set total_syntrophomonas_AC16 0

  set total_syntrophus_AC12 0
  set total_syntrophus_AC13 0
  set total_syntrophus_AC16 0

  set total_Syntrophobacterales_AC17 0

  set total_C.kluyveri_AC18 0
  set total_C.aceticum_HAB19 0
  set total_C.ultunense_FB5/HPB20 0
  set total_C.aceticum_FB5/HAB19 0
  set total_Acetobacterium.woodii_FB5/HAB19 0

  set total_M.sarcinales_AM21/HM22 0
  set total_M.concilii_AM21 0

  set total_M.microbiales_HM22 0
  set total_M.bacteriales_HM22 0


  set total_percentage_bacteroidales bacteroidales_percentage
  set total_percentage_clostridiales clostridiales_percentage
  set total_percentage_thermotogales thermotogales_percentage
  set total_percentage_syntrophomonas syntrophomonas_percentage
  set total_percentage_clostridium clostridium_percentage
  set total_percentage_syntrophobacterales syntrophobacterales_percentage
  set total_percentage_syntrophus syntrophus_percentage
  set total_percentage_methanobacteriales methanobacteriales_percentage
  set total_percentage_methanomicrobiales methanomicrobiales_percentage
  set total_percentage_methanosarcinales methanosarcinales_percentage
  set total_percentage_methanosaeta methanosaeta_percentage

  ;;;WATER;;;
  ask patches [set pcolor blue set moles (111)]

  set feed_volume (((((Reactor_working_volume * 1000 / SRT) * (OLR_Feed * SRT)) / 1000) * 1) / VSS_sludge / 24) ;; 17.09 g/L is the average VS measured for CEPT sludge from 8/June/2016 to 31/March/2017 at Stonecutters Island STWs

;;; CO2 ;;;

  set-default-shape CO2s "circle"
  create-CO2s (289)
  [set color orange
    set size 0.5
    set CO2s_mass (((((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))) * ((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)) / 289) ;; It is assumed that the concentration of CO2 in water due to its pressure of 1 atm is 1133 mg/L and 44.01 is the molecular weight of CO2 in g/mol CO2
    setxy random-xcor random-ycor
  ]

;;; HYDROGENS;;;
  set-default-shape hydrogens "default"
  create-hydrogens (222)
  [ set color sky
    set size 0.5
    set hydrogens_mass (((((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))) * ((0.000000865 / (((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)))) * reactor_working_volume / 1000 / 2.02 * 1000)) / 222) ;; It is assumed that the concentration of hydrogen in water due to its pressure of 1 atm is 1.6 mg/L and 2.02 is the molecular weight of H2 in g/mol H2
    setxy random-xcor random-ycor
  ]

;;; CH4 ;;;

set-default-shape CH4s "circle"
create-CH4s (29)
[set color violet
  set size 0.5
  set CH4s_mass (((((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))) * ((4.5 / 1000000000 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)) / 29) ;; It is assumed that the concentration of methane in water due to its pressure of 1 atm is 19.1169 mg/L and 16.04 is the molecular weight of CH4 in g/mol CH4
  setxy random-xcor random-ycor
]

;;;PROTONS;;;
  set-default-shape protons "default"
  create-protons (222)
  [ set color cyan
    set size 0.5
    set protons_mass (10 ^ (- pH) * Reactor_working_volume * 1000) / 222 ;; This is related to the pH which at 7 has a concentration of 0.0000001 M/L
    setxy random-xcor random-ycor
  ]

  setup-feed
  setup-bacteria
  output-1

  reset-ticks


end


to setup-feed

  ;;;CARBS;;;

  set-default-shape carbs "circle";; Carbohydrates shape
  Create-carbs (933) ;; Create the carbs available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set carbs_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.21 * 0.24) / 1000 / 1.1852 / 162.141 * 1000)/ 933 / 24
    setxy random-xcor random-ycor
  ]

  ;;;GLUCOSE;;;

  set-default-shape glucose "circle";; Glucose shape
  Create-glucose (1) ;; Create the glucose available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set glucose_mass 0
    setxy random-xcor random-ycor
  ]

 ;;;PROTEINS;;;

  set-default-shape proteins "circle";; Proteins shape
  Create-proteins (1000) ;; Create the proteins available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set proteins_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.30 * 0.24) / 1000 / 1.5 / 352.391 * 1000)/ 1000 / 24
    setxy random-xcor random-ycor
  ]

 ;;;GLYCINE;;;

  set-default-shape glycines "circle";; glycine shape
  Create-glycines (1) ;; Create the glycine available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set glycines_mass 0
    setxy random-xcor random-ycor
  ]

 ;;;SERINE;;;

  set-default-shape serines "circle";; serine shape
  Create-serines (1) ;; Create the serine available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set serines_mass 0
    setxy random-xcor random-ycor
  ]

 ;;;THREONINE;;;

  set-default-shape threonines "circle";; threonine shape
  Create-threonines (1) ;; Create the threonine available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set threonines_mass 0
    setxy random-xcor random-ycor
  ]

 ;;;ASPARTATE;;;

  set-default-shape aspartates "circle";; aspartate shape
  Create-aspartates (1) ;; Create the aspartate available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set aspartates_mass 0
    setxy random-xcor random-ycor
  ]


 ;;;GLUTAMICS;;;

  set-default-shape glutamics "circle";; glutamic shape
  Create-glutamics (1) ;; Create the glutamics available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set glutamics_mass 0
    setxy random-xcor random-ycor
  ]

  ;;;LIPIDS;;;

  set-default-shape lipids "circle";; Lipids shape
  Create-lipids (1000) ;; Create the lipids available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set lipids_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.39 * 0.24) / 1000 / 2.8295 / 787.264 * 1000)/ 1000 / 24
    setxy random-xcor random-ycor
  ]

  ;;;MYRISTATES;;;

  set-default-shape myristates "circle";; myristate shape
  Create-myristates (1) ;; Create the myristates available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set myristates_mass 0
    setxy random-xcor random-ycor
  ]

  ;;;PALMITATES;;;

  set-default-shape palmitates "circle";; palmitate shape
  Create-palmitates (1) ;; Create the palmitates available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set palmitates_mass 0
    setxy random-xcor random-ycor
  ]

  ;;;STEARATATES;;;

  set-default-shape stearates "circle";; stearate shape
  Create-stearates (1) ;; Create the stearates available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set stearates_mass 0
    setxy random-xcor random-ycor
  ]

  ;;;OLEATES;;;

  set-default-shape oleates "circle";; oleate shape
  Create-oleates (1) ;; Create the oleates available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set oleates_mass 0
    setxy random-xcor random-ycor
  ]

  ;;;LINOLEATES;;;

  set-default-shape linoleates "circle";; linoleate shape
  Create-linoleates (1) ;; Create the linoleates available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set linoleates_mass 0
    setxy random-xcor random-ycor
  ]

;;; AMMONIUM;;;

  set-default-shape ammonium "triangle"
  Create-Ammonium (222) ;; Create the ammonium available in mmol/h, then initialize ther variables
  [
    set color pink
    set size 0.5
    set ammonium_mass (283) * feed_volume / 1000 / 18.0385 * 1000 / 222
    setxy random-xcor random-ycor
  ]

;;; AMMONIA;;;

  set-default-shape ammonia "triangle"
  Create-Ammonia (1) ;; Create the ammonia available in mmol/h, then initialize ther variables
  [
    set color pink
    set size 0.5
    set ammonia_mass (0)
    setxy random-xcor random-ycor
  ]

;;; BICARBONATES ;;;
  set-default-shape bicarbonates "default"
  create-bicarbonates (289)
  [ set color lime
    set size 0.5
    set bicarbonates_mass (( 126 * reactor_working_volume / 1000 / 61.0168 * 1000) / 289)
    setxy random-xcor random-ycor
  ]

;;;REACTANTS;;;


;;; BUTYRATES ;;;

set-default-shape butyrates "default"
create-butyrates (1)
[ set color turquoise
  set size 0.5
  set butyrates_mass 0
]

;;; PROPIONATES ;;;

set-default-shape propionates "default"
create-propionates (1)
[ set color gray
  set size 0.5
  set propionates_mass 0
]

;;; ETHANOLS ;;;

set-default-shape ethanols "default"
create-ethanols (1)
[ set color brown
  set size 0.5
  set ethanols_mass 0
]

;;; ACETATES ;;;

set-default-shape acetates "default"
create-acetates (1)
[ set color yellow
  set size 0.5
  set acetates_mass 0
]

end

to setup-bacteria

     ;;;CLOSTRIDIALES;;; Eq. 1

  set-default-shape clostridiales_FB1 "square"
  Create-Clostridiales_FB1 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB1_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB1 1.03
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


      ;;;CLOSTRIDIALES;;; Eq. 2

  set-default-shape clostridiales_FB2 "square"
  Create-Clostridiales_FB2 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB2_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB2 0.9367
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

   ;;;CLOSTRIDIALES;;; Eq. 3

  set-default-shape clostridiales_FB3 "square"
  Create-Clostridiales_FB3 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB3_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB3 0.9367
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

  ;;;CLOSTRIDIALES;;; Eq. 4

  set-default-shape clostridiales_FB4 "square"
  Create-Clostridiales_FB4 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB4_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB4 3.4553
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIALES;;; Eq. 6

  set-default-shape clostridiales_FB6 "square"
  Create-Clostridiales_FB6 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB6_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB6 (1.08 + random-float 6.27)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIALES;;; Eq. 7

  set-default-shape clostridiales_FB7 "square"
  Create-Clostridiales_FB7 round  (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB7_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB7 (1.08 + random-float 3.332)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIALES;;; Eq. 8

  set-default-shape clostridiales_FB8 "square"
  Create-Clostridiales_FB8 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB8_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB8 (1.08 + random-float 1.677)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIALES;;; Eq. 9

  set-default-shape clostridiales_FB9 "square"
  Create-Clostridiales_FB9 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB9_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB9 (1.08 + random-float 2.597)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIALES;;; Eq. 10

  set-default-shape clostridiales_FB10 "square"
  Create-Clostridiales_FB10 round (67) ;; Create the clostridiales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Clostridiales_FB10_mass ((MLVSS / 1000 * Clostridiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 9) / round (67));; Assumes each agent will start with the same mass
    set uptake_FB10 (1.08 + random-float 1.371)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 1

  set-default-shape bacteroidales_FB1 "square"
  Create-bacteroidales_FB1 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB1_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB1 1.03
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 2

  set-default-shape bacteroidales_FB2 "square"
  Create-bacteroidales_FB2 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB2_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB2 0.9367
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 3

  set-default-shape bacteroidales_FB3 "square"
  Create-bacteroidales_FB3 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB3_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB3 0.9367
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;;BACTEROIDALES;;; Eq. 4

  set-default-shape bacteroidales_FB4 "square"
  Create-bacteroidales_FB4 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB4_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB4 3.4553
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 5

  set-default-shape bacteroidales_FB5 "square"
  Create-bacteroidales_FB5 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB5_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB5 0.0207
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 6

  set-default-shape bacteroidales_FB6 "square"
  Create-bacteroidales_FB6 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB6_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB6 (1.08 + random-float 6.27)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 7

  set-default-shape bacteroidales_FB7 "square"
  Create-bacteroidales_FB7 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB7_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB7 (1.08 + random-float 3.332)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;BACTEROIDALES;;; Eq. 8

  set-default-shape bacteroidales_FB8 "square"
  Create-bacteroidales_FB8 round (107) ;; Create the bacteroidales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set bacteroidales_FB8_mass ((MLVSS / 1000 * bacteroidales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 8) / round (107));; Assumes each agent will start with the same mass
    set uptake_b_FB8 (1.08 + random-float 1.677)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;;THERMOTOGALES;;; Eq. 5

  set-default-shape thermotogales_FB5 "square"
  Create-thermotogales_FB5 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB5_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB5 0.0207
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;THERMOTOGALES;;; Eq. 6

  set-default-shape thermotogales_FB6 "square"
  Create-thermotogales_FB6 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB6_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB6 (1.08 + random-float 6.27)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;THERMOTOGALES;;; Eq. 7

  set-default-shape thermotogales_FB7 "square"
  Create-thermotogales_FB7 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB7_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB7 (1.08 + random-float 3.332)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;THERMOTOGALES;;; Eq. 8

  set-default-shape thermotogales_FB8 "square"
  Create-thermotogales_FB8 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB8_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB8 (1.08 + random-float 1.677)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;THERMOTOGALES;;; Eq. 9

  set-default-shape thermotogales_FB9 "square"
  Create-thermotogales_FB9 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB9_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB9 (1.08 + random-float 2.597)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;THERMOTOGALES;;; Eq. 10

  set-default-shape thermotogales_FB10 "square"
  Create-thermotogales_FB10 round (66) ;; Create the thermotogales in mmol, then initialize their variables
  [
    set color red
    set size 1
    set thermotogales_FB10_mass ((MLVSS / 1000 * thermotogales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 6) / round (66));; Assumes each agent will start with the same mass
    set uptake_t_FB10 (1.08 + random-float 1.371)
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

  ;;; SYNTROPHOMONAS ;;; Eq. 11

  set-default-shape syntrophomonas_AC11 "square"
  Create-syntrophomonas_AC11 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophomonas_AC11_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC11 0.0197
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHOMONAS ;;; Eq. 12

  set-default-shape syntrophomonas_AC12 "square"
  Create-syntrophomonas_AC12 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophomonas_AC12_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC12 0.0184
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHOMONAS ;;; Eq. 13

  set-default-shape syntrophomonas_AC13 "square"
  Create-syntrophomonas_AC13 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophomonas_AC13_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC13 0.0128
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHOMONAS ;;; Eq. 14

  set-default-shape syntrophomonas_AC14 "square"
  Create-syntrophomonas_AC14 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophomonas_AC14_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC14 0.0669
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHOMONAS ;;; Eq. 15

  set-default-shape syntrophomonas_AC15 "square"
  Create-syntrophomonas_AC15 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophomonas_AC15_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC15 0.0842
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;; SYNTROPHOMONAS ;;; Eq. 16

  set-default-shape syntrophomonas_AC16 "square"
  Create-syntrophomonas_AC16 round (49) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color green
    set size 1;; The size of Syntrophomonas
    set syntrophomonas_AC16_mass ((MLVSS / 1000 * Syntrophomonas_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 6) / round (49));; Assumes each agent will start with the same mass
    set uptake_s_AC16 0.8433
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHUS ;;; Eq. 12

  set-default-shape syntrophus_AC12 "square"
  Create-syntrophus_AC12 (3) ;; Create the syntrophus in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophus_AC12_mass (MLVSS / 1000 * Syntrophus_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 4) / 3;; Assumes each agent will start with the same mass
    set uptake_su_AC12 0.0184
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;; SYNTROPHUS ;;; Eq. 13

  set-default-shape syntrophus_AC13 "square"
  Create-syntrophus_AC13 (3) ;; Create the syntrophus in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophus_AC13_mass (MLVSS / 1000 * Syntrophus_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 4) / 3;; Assumes each agent will start with the same mass
    set uptake_su_AC13 0.0128
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; SYNTROPHUS ;;; Eq. 16

  set-default-shape syntrophus_AC16 "square"
  Create-syntrophus_AC16 (3) ;; Create the syntrophus in mmol, then initialize their variables
  [
    set color green
    set size 1
    set syntrophus_AC16_mass (MLVSS / 1000 * Syntrophus_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 4) / 3;; Assumes each agent will start with the same mass
    set uptake_su_AC16 0.8433
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;; SYNTROPHOBACTERALES ;;; Eq. 17

  set-default-shape Syntrophobacterales_AC17 "square"
  Create-Syntrophobacterales_AC17 (11) ;; Create the syntrophus in mmol, then initialize their variables
  [
    set color green
    set size 1
    set Syntrophobacterales_AC17_mass (MLVSS / 1000 * Syntrophobacterales_percentage / 100  * (Reactor_working_volume) / 113 * 1000 / 1) / 11;; Assumes each agent will start with the same mass
    set uptake_s_AC17 0.7044
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


    ;;; CLOSTRIDIUM ;;; Eq. 18

  set-default-shape C.kluyveri_AC18 "square"
  Create-C.kluyveri_AC18 round (30) ;; Create the Clostridiums in mmol, then initialize their variables
  [
    set color green
    set size 1
    set C.kluyveri_AC18_mass ((MLVSS / 1000 * Clostridium_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 5) / round (30));; Assumes each agent will start with the same mass
    set uptake_AC18 0.2080
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

  ;;; CLOSTRIDIUM ;;;
  ;;; HOMOACETOGENIC BACTERIA;;; Eq. 19 Clostridum aceticum and Acetobacterium woodii


  set-default-shape C.aceticum_HAB19 "square"
  Create-C.aceticum_HAB19 (30) ;; Create the Clostridums in mmol, then initialize their variables
  [
    set color green
    set size 1
    set C.aceticum_HAB19_mass ((MLVSS / 1000 * Clostridium_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 5) / round (30));; Assumes each agent will start with the same mass
    set uptake_HAB19 0.1876
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;; CLOSTRIDIUM ;;;
  ;;; HYDROGEN-PRODUCING BACTERIA;; Eq. 5 and Eq. 20 Clostridium Ultunense

   set-default-shape C.ultunense_FB5/HPB20 "square"
  Create-C.ultunense_FB5/HPB20 round (30) ;; Create the clostridiums in mmol, then initialize their variables
  [
    set color red
    set size 1
    set C.ultunense_FB5/HPB20_mass ((MLVSS / 1000 * Clostridium_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 5) / round (30));; Assumes each agent will start with the same mass
    set uptake_FB5 0.0207
    set uptake_HPB20 0.0375
    set Gr 0
    set Gr_2 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


  ;;;CLOSTRIDUM;;; Eq. 5 and Eq. 19

  set-default-shape C.aceticum_FB5/HAB19 "square"
  Create-C.aceticum_FB5/HAB19 round ( 30) ;; Create the clostridiums in mmol, then initialize their variables
  [
    set color red
    set size 1
    set C.aceticum_FB5/HAB19_mass ((MLVSS / 1000 * Clostridium_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 5) / round (30));; Assumes each agent will start with the same mass
    set uptake_FB5 0.0207
    set uptake_HAB19 0.1876
    set Gr 0
    set Gr_2 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

;;;CLOSTRIDIUM;;; Eq. 5 and Eq. 19

  set-default-shape Acetobacterium.woodii_FB5/HAB19 "square"
  Create-Acetobacterium.woodii_FB5/HAB19 round (30) ;; Create the clostridiums in mmol, then initialize their variables
  [
    set color red
    set size 1
    set Acetobacterium.woodii_FB5/HAB19_mass ((MLVSS / 1000 * Clostridium_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 5) / round (30));; Assumes each agent will start with the same mass
    set uptake_FB5 0.0207
    set uptake_HAB19 0.1876
    set Gr 0
    set Gr_2 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]

  ;;; METHANOSARCINALES ;;;

  ;;; METHANOSARCINALES AM21/HM22;;; Eq. 21 and Eq. 22
  set-default-shape M.sarcinales_AM21/HM22 "square"
  Create-M.sarcinales_AM21/HM22 (11) ;; Create the syntrophomans in mmol, then initialize their variables
  [
    set color cyan
    set size 1
    set M.sarcinales_AM21/HM22_mass ((MLVSS / 1000 * Methanosarcinales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 1) / 11);; Assumes each agent will start with the same mass
    set uptake_AM21 0.6073
    set uptake_HM22 0.2897
    set Gr 0
    set Gr_2 0
    set energy_fs_acetate 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


  ;;; METHANOSAETAS ;;;

  ;;;METHANOSAETAS AM21;; Eq. 21 Methanosaeta concilii

    set-default-shape M.concilii_AM21 "square"
  Create-M.concilii_AM21 (11) ;; Create the methanosaetas in mmol, then initialize their variables
  [
    set color cyan
    set size 1
    set M.concilii_AM21_mass ((MLVSS / 1000 * Methanosaeta_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 1) / 11);; Assumes each agent will start with the same mass
    set uptake_AM21 0.6074
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


   ;;; METHANOMICROBIALES ;;;

  ;;;METHANOMICROBIALES HM22;;; Eq. 22 M.microbiales for M.bourgensis and M. Hungatei

   set-default-shape M.microbiales_HM22 "square"
  Create-M.microbiales_HM22 (10) ;; Create the methanomicrobiales in mmol, then initialize their variables
  [
    set color cyan
    set size 1;;
    set M.microbiales_HM22_mass ((MLVSS / 1000 * Methanomicrobiales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 1) / 10);; Assumes each agent will start with the same mass
    set uptake_HM22 0.2897
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]


;;; METHANOBACTERIALES;;;


;;METHANOBACTERIALES HM22;;; Eq. 22 M.bacteriales for Methanobacterium bryantii and M. formicicum
 set-default-shape M.bacteriales_HM22 "square"
  Create-M.bacteriales_HM22 (5) ;; Create the methanobacteriales in mmol, then initialize their variables
  [
    set color cyan
    set size 1;;
    set M.bacteriales_HM22_mass ((MLVSS / 1000 * Methanobacteriales_percentage / 100 * (Reactor_working_volume) / 113 * 1000 / 1) / 5);; Assumes each agent will start with the same mass
    set uptake_HM22 0.2897
    set Gr 0
    set energy_fs 0
    set energy_fe 0
    setxy random-xcor random-ycor
  ]
end


to output-1
if (file-exists? "TestOutput-AD.csv") [carefully [file-delete "TestOutput-AD.csv"] [print error-message]]
   file-open "TestOutput-AD.csv"

      file-type "tick,"

      file-type "IC glucose (mM/L),"

      file-type "IC glycines (mM/L),"
      file-type "IC serines (mM/L),"
      file-type "IC threonines (mM/L),"
      file-type "IC aspartates (mM/L),"
      file-type "IC glutamics (mM/L),"

      file-type "IC myristates (mM/L),"
      file-type "IC palmitates (mM/L),"
      file-type "IC stearates (mM/L),"
      file-type "IC oleates (mM/L),"
      file-type "IC linoleates (mM/L),"

      file-type "IC ammonium (mM/L),"
      file-type "IC ammonia (mM/L),"

      file-type "IC bicarbonates (mM/L),"
      file-type "IC CO2s (mM/L),"
      file-type "IC CH4s (mM/L),"
      file-type "IC H2s (mM/L),"

      file-type "IC butyrates (mM/L),"
      file-type "IC propionates (mM/L),"
      file-type "IC ethanols (mM/L),"
      file-type "IC acetates (mM/L),"

      file-type "CH4 (mM),"
      file-type "Effluent CH4 (mM),"
      file-type "LCH4 (mM/L),"

      file-type "Daily CH4 (mL),"
      file-type "Daily CO2 (mL),"
      file-type "Daily biogas (mL),"
      file-type "Methane content daily (%),"

      file-type "CH4s Acc (ml),"
      file-type "CO2s Acc (ml),"
      file-type "H2s Acc (ml),"
      file-type "Acc biogas production (ml),"

      file-type "carbs (mM),"
      file-type "glucose (mM),"

      file-type "proteins (mM),"
      file-type "glycines (mM),"
      file-type "serines (mM),"
      file-type "threonines (mM),"
      file-type "aspartates (mM),"
      file-type "glutamics (mM),"

      file-type "lipids (mM),"
      file-type "myristates (mM),"
      file-type "palmitates (mM),"
      file-type "stearates (mM),"
      file-type "oleates (mM),"
      file-type "linoleates (mM),"

      file-type "ammonium (mM),"
      file-type "ammonia (mM),"
      file-type "bicarbonates (mM),"
      file-type "butyrates (mM),"
      file-type "propionates (mM),"
      file-type "ethanols (mM),"
      file-type "acetates (mM),"

      file-type "Bacteroidales (%),"
      file-type "Clostridiales(%),"
      file-type "Thermotogales (%),"
      file-type "Syntrophomonas (%),"
      file-type "Syntrophus (%),"
      file-type "Clostridium (%),"
      file-type "Syntrophobacterales (%),"
      file-type "Methanobacteriales (%),"
      file-type "Methanomicrobiales (%),"
      file-type "Methanosarcinales (%),"
      file-type "Methanosaeta (%),"

      file-type "C.aceticum_FB5/HAB19 (%),"
      file-type "Acetobacterium.woodii_FB5/HAB19 (%),"
      file-print "C.aceticum_HAB19 (%),"
    file-close
end

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;PROCEDURES;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


to go
  if not any? turtles [stop]

  ask carbs
  [
    Hydrolyse_glucose
    move_carbs
    combine_carbs
    die_carbs
  ]

  ask glucose
  [
    Divide_hydrolysed_glucose
    move_glucose
    combine_glucose
    die_glucose
  ]

  ask proteins
  [
    hydrolyse_glycine
    hydrolyse_serine
    hydrolyse_threonine
    hydrolyse_aspartate
    hydrolyse_glutamic
    move_proteins
    combine_proteins
    die_proteins
  ]

  ask glycines
  [
    move_glycines
    combine_glycines
    die_glycines
  ]

  ask serines
  [
    move_serines
    combine_serines
    die_serines
  ]

  ask threonines
  [
    move_threonines
    combine_threonines
    die_threonines
  ]

  ask aspartates
  [
    move_aspartates
    combine_aspartates
    die_aspartates
  ]

  ask glutamics
  [
    move_glutamics
    combine_glutamics
    die_glutamics
  ]

  ask lipids
  [
    hydrolyse_myristate
    hydrolyse_palmitate
    hydrolyse_stearate
    hydrolyse_oleate
    hydrolyse_linoleate
    move_lipids
    combine_lipids
    die_lipids
  ]

  ask myristates
  [
    move_myristates
    combine_myristates
    die_myristates
  ]

  ask palmitates
  [
    move_palmitates
    combine_palmitates
    die_palmitates
  ]

  ask stearates
  [
    move_stearates
    combine_stearates
    die_stearates
  ]

  ask oleates
  [
    move_oleates
    combine_oleates
    die_oleates
  ]

  ask linoleates
  [
    move_linoleates
    combine_linoleates
    die_linoleates
  ]

    ask ammonium
  [
    move_ammonium
    combine_ammonium
    death_ammonium
  ]

  ask ammonia
  [
    move_ammonia
    combine_ammonia
    death_ammonia
  ]

  Calculate_concentrations

  ask clostridiales_FB1
  [
    move_bacteria
    FB1_eat_glucose
    reproduce_FB1
    death_FB1
  ]

  ask clostridiales_FB2
  [
    move_bacteria
    FB2_eat_glucose
    reproduce_FB2
    death_FB2
  ]

  ask clostridiales_FB3
  [
    move_bacteria
    FB3_eat_glucose
    reproduce_FB3
    death_FB3
  ]

  ask clostridiales_FB4
  [
    move_bacteria
    FB4_eat_glucose
    reproduce_FB4
    death_FB4
  ]

  ask clostridiales_FB6
  [
    move_bacteria
    FB6_c_eat_glycine
    reproduce_c_FB6
    death_c_FB6
  ]

  ask clostridiales_FB7
  [
    move_bacteria
    FB7_c_eat_serine
    reproduce_c_FB7
    death_c_FB7
  ]

  ask clostridiales_FB8
  [
    move_bacteria
    FB8_c_eat_threonine
    reproduce_c_FB8
    death_c_FB8
  ]

  ask clostridiales_FB9
  [
    move_bacteria
    FB9_c_eat_aspartate
    reproduce_c_FB9
    death_c_FB9
  ]

  ask clostridiales_FB10
  [
    move_bacteria
    FB10_c_eat_glutamic
    reproduce_c_FB10
    death_c_FB10
  ]

  ask bacteroidales_FB1
  [
    move_bacteria
    FB1_b_eat_glucose
    reproduce_b_FB1
    death_b_FB1
  ]


  ask bacteroidales_FB2
  [
    move_bacteria
    FB2_b_eat_glucose
    reproduce_b_FB2
    death_b_FB2
  ]

  ask bacteroidales_FB3
  [
    move_bacteria
    FB3_b_eat_glucose
    reproduce_b_FB3
    death_b_FB3
  ]

  ask bacteroidales_FB4
  [
    move_bacteria
    FB4_b_eat_glucose
    reproduce_b_FB4
    death_b_FB4
  ]


  ask bacteroidales_FB5
  [
    move_bacteria
    FB5_b_eat_glucose
    reproduce_b_FB5
    death_b_FB5
  ]

  ask bacteroidales_FB6
  [
    move_bacteria
    FB6_b_eat_glycine
    reproduce_b_FB6
    death_b_FB6
  ]

  ask bacteroidales_FB7
  [
    move_bacteria
    FB7_b_eat_serine
    reproduce_b_FB7
    death_b_FB7
  ]

  ask bacteroidales_FB8
  [
    move_bacteria
    FB8_b_eat_threonine
    reproduce_b_FB8
    death_b_FB8
  ]

  ask thermotogales_FB5
  [
    move_bacteria
    FB5_t_eat_glucose
    reproduce_t_FB5
    death_t_FB5
  ]

  ask thermotogales_FB6
  [
    move_bacteria
    FB6_t_eat_glycine
    reproduce_t_FB6
    death_t_FB6
  ]

  ask thermotogales_FB7
  [
    move_bacteria
    FB7_t_eat_serine
    reproduce_t_FB7
    death_t_FB7
  ]

  ask thermotogales_FB8
  [
    move_bacteria
    FB8_t_eat_threonine
    reproduce_t_FB8
    death_t_FB8
  ]

  ask thermotogales_FB9
  [
    move_bacteria
    FB9_t_eat_aspartate
    reproduce_t_FB9
    death_t_FB9
  ]

  ask thermotogales_FB10
  [
    move_bacteria
    FB10_t_eat_glutamic
    reproduce_t_FB10
    death_t_FB10
  ]

    ask syntrophomonas_AC11
  [
    move_bacteria
    AC11_s_eat_myristate
    reproduce_s_AC11
    death_s_AC11
  ]

  ask syntrophomonas_AC12
  [
    move_bacteria
    AC12_s_eat_palmitate
    reproduce_s_AC12
    death_s_AC12
  ]

  ask syntrophomonas_AC13
  [
    move_bacteria
    AC13_s_eat_stearate
    reproduce_s_AC13
    death_s_AC13
  ]

  ask syntrophomonas_AC14
  [
    move_bacteria
    AC14_s_eat_oleate
    reproduce_s_AC14
    death_s_AC14
  ]

  ask syntrophomonas_AC15
  [
    move_bacteria
    AC15_s_eat_linoleate
    reproduce_s_AC15
    death_s_AC15
  ]

  ask syntrophomonas_AC16
  [
    move_bacteria
    AC16_s_eat_butyrate
    reproduce_s_AC16
    death_s_AC16
  ]

  ask syntrophus_AC12
  [
    move_bacteria
    AC12_su_eat_palmitate
    reproduce_su_AC12
    death_su_AC12
  ]

  ask syntrophus_AC13
  [
    move_bacteria
    AC13_su_eat_stearate
    reproduce_su_AC13
    death_su_AC13
  ]

  ask syntrophus_AC16
  [
    move_bacteria
    AC16_su_eat_butyrate
    reproduce_su_AC16
    death_su_AC16
  ]

  ask Syntrophobacterales_AC17
  [
    move_bacteria
    AC17_s_eat_propionate
    reproduce_s_AC17
    death_s_AC17
  ]

  ask C.kluyveri_AC18
  [
    move_bacteria
    AC18_eat_ethanol
    reproduce_AC18
    death_AC18
  ]

  ask C.aceticum_HAB19
  [
    move_bacteria
    HAB19_eat_hydrogen
    reproduce_HAB19
    death_HAB19
  ]

  ask C.ultunense_FB5/HPB20
  [
    move_bacteria
    FB5/HPB20_eat_glucose_or_acetate
    reproduce_FB5/HPB20
    death_FB5/HPB20
  ]

  ask C.aceticum_FB5/HAB19
  [
    move_bacteria
    CA_FB5/HAB19_eat_glucose_or_hydrogen
    reproduce_FB5/HAB19_CA
    death_FB5/HAB19_CA
  ]

  ask Acetobacterium.woodii_FB5/HAB19
  [
    move_bacteria
    AW_FB5/HAB19_eat_glucose_or_hydrogen
    reproduce_FB5/HAB19_AW
    death_FB5/HAB19_AW
  ]

  ask M.sarcinales_AM21/HM22
  [
    move_bacteria
    AM21/HM22_eat_acetate_or_hydrogen
    reproduce_AM21/HM22
    death_AM21/HM22
  ]

  ask M.concilii_AM21
  [
    move_bacteria
    AM21_eat_acetate
    reproduce_AM21
    death_AM21
  ]


  ask M.microbiales_HM22
  [
    move_bacteria
    Mm_HM22_eat_hydrogen
    reproduce_Mm_HM22
    death_Mm_HM22
  ]

  ask M.bacteriales_HM22
  [
    move_bacteria
    Mb_HM22_eat_hydrogen
    reproduce_Mb_HM22
    death_Mb_HM22
  ]

  ask CO2s
  [
    move_CO2s
    combine_CO2s
    death_CO2s
  ]

  ask water
  [
    death_water
  ]

  ask bicarbonates
  [
    move_bicarbonates
    combine_bicarbonates
    death_bicarbonates
  ]

  ask CH4s
  [
    move_CH4s
    combine_CH4s
  ]

  ask hydrogens
  [
    move_hydrogens
    divide_hydrogens
    death_hydrogens
  ]

  ask protons
  [
    move_protons
    combine_protons
    death_protons
  ]

  ask butyrates
  [
    move_butyrates
    combine_butyrates
    death_butyrates
  ]

  ask propionates
  [
    move_propionates
    combine_propionates
    death_propionates
  ]

  ask ethanols
  [
    move_ethanols
    combine_ethanols
    death_ethanols
  ]

  ask acetates
  [
    move_acetates
    combine_acetates
    death_acetates
  ]



 set time time + 1

 count_carbs
 count_glucose

 count_proteins
 count_glycines
 count_serines
 count_threonines
 count_aspartates
 count_glutamics

 count_lipids
 count_myristates
 count_palmitates
 count_stearates
 count_oleates
 count_linoleates

 count_ammonium
 count_ammonia
 count_bicarbonates

 count_CO2s_mol
 count_CO2s_ml
 count_accumul_CO2s_ml
  count_accumul_CO2s_ml_daily
 count_CH4s_mol
 count_CH4s_ml
 count_accumul_CH4s_ml
 count_accumul_CH4s_ml_daily
 count_hydrogens_mol
 count_hydrogens_ml
 count_accumul_hydrogens_ml
 count_accumul_hydrogens_ml_daily
 count_total_biogas_production
 count_total_biogas_daily
 count_methane_daily
 count_CO2_daily
 count_biogas_daily
 count_methane_content_hourly
 count_methane_content_daily


 escape_CO2s
 escape_CH4s
 escape_hydrogens

 count_protons
 count_butyrates
 count_propionates
 count_ethanols
 count_acetates


 ;;;BACTERIA;;;

 count_clostridiales_FB1
 count_clostridiales_FB2
 count_clostridiales_FB3
 count_clostridiales_FB4

 count_clostridiales_FB6
 count_clostridiales_FB7
 count_clostridiales_FB8
 count_clostridiales_FB9
 count_clostridiales_FB10


 count_bacteroidales_FB1
 count_bacteroidales_FB2
 count_bacteroidales_FB3
 count_bacteroidales_FB4
 count_bacteroidales_FB5
 count_bacteroidales_FB6
 count_bacteroidales_FB7
 count_bacteroidales_FB8

 count_thermotogales_FB5
 count_thermotogales_FB6
 count_thermotogales_FB7
 count_thermotogales_FB8
 count_thermotogales_FB9
 count_thermotogales_FB10

 count_syntrophomonas_AC11
 count_syntrophomonas_AC12
 count_syntrophomonas_AC13
 count_syntrophomonas_AC14
 count_syntrophomonas_AC15
 count_syntrophomonas_AC16

 count_syntrophus_AC12
 count_syntrophus_AC13
 count_syntrophus_AC16

 count_Syntrophobacterales_AC17


 count_C.kluyveri_AC18
 count_C.aceticum_HAB19
 count_C.ultunense_FB5/HPB20
 count_C.aceticum_FB5/HAB19
 count_Acetobacterium.woodii_FB5/HAB19

 count_M.sarcinales_AM21/HM22
 count_M.concilii_AM21
 count_M.microbiales_HM22
 count_M.bacteriales_HM22


 calculate_bacteroidales_percentage
 calculate_clostridiales_percentage
 calculate_thermotogales_percentage
 calculate_syntrophomonas_percentage
 calculate_clostridium_percentage
 calculate_syntrophobacterales_percentage
 calculate_syntrophus_percentage
 calculate_methanobacteriales_percentage
 calculate_methanomicrobiales_percentage
 calculate_methanosarcinales_percentage
 calculate_methanosaeta_percentage



 output-2


 tick
  set last_tick_hydrogen effluent_H2s_mol
  set last_day_methane accumul_CH4s_ml_daily
  set last_day_CO2 accumul_CO2s_ml_daily
  set last_day_biogas total_biogas_daily
 if (time > 0 and time < 48) [continuous-feed-df0.25]
 if (time >= 48 ) [continuous-feed-df0.70]
 if (time = 482) [stop]
end

;;; CARBOHYDRATES ;;;
to hydrolyse_glucose
  if time > 0 and time < 216
  [
  if (carbs_mass < 200) [
    let hydrolized_glucose_mass carbs_mass
    hatch-glucose 1 [set color turquoise set size 0.5 set glucose_mass (glucose_mass + (hydrolized_glucose_mass * ((0.21 + random-float 0.37) / 24))) rt random 360 fd 1] ;;Munisamy et al., 2017 based on Christ et al., 2000
    set carbs_mass (carbs_mass - (carbs_mass * ((0.21 + random-float 0.37) / 24)))
  ]
  ]
  if time >= 216
  [
  if (carbs_mass < 200) [
    let hydrolized_glucose_mass carbs_mass
    hatch-glucose 1 [set color turquoise set size 0.5 set glucose_mass (glucose_mass + (hydrolized_glucose_mass * ((0.58 + random-float 1.36) / 24))) rt random 360 fd 1] ;;Munisamy et al., 2017 based on Christ et al., 2000
    set carbs_mass (carbs_mass - (carbs_mass * ((0.58 + random-float 1.36) / 24)))
  ]
  ]
end

to move_carbs
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_carbs
  let target one-of other carbs with
  [carbs_mass <= 0.01]
  if target != nobody
  [set carbs_mass carbs_mass + [carbs_mass] of target
   ask target [die]
  ]
end

to die_carbs
  if carbs_mass <= 0 [die]
end

;;; GLUCOSE ;;;

to divide_hydrolysed_glucose
   if (glucose_mass > 2)
   [
    set glucose_mass (glucose_mass / 2)
    hatch 1 [
    make_hydrolysed_glucose
    right random 360
    fd 1
  ]
 ]

end

to move_glucose
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_glucose
  if glucose_mass < 3.4553
  [
  let target one-of other glucose with
  [glucose_mass <= 3.4553]
  if target != nobody
  [set glucose_mass glucose_mass + [glucose_mass] of target
   ask target [die]
  ]]
end

to die_glucose
  if glucose_mass <= 0 [die]
end



;;; PROTEINS ;;;
to hydrolyse_glycine
  if time > 0 and time < 216
  [
  if (proteins_mass < 200) [
    let hydrolized_glycine_mass proteins_mass
    hatch-glycines 1 [set color turquoise set size 0.5 set glycines_mass (glycines_mass + (hydrolized_glycine_mass * ((0.0096 + random-float 0.0904) / 24) * 0.336)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.0096 + random-float 0.0904) / 24) * 0.336))
  ]]
  if time >= 216
  [
    if (proteins_mass < 200) [
    let hydrolized_glycine_mass proteins_mass
    hatch-glycines 1 [set color turquoise set size 0.5 set glycines_mass (glycines_mass + (hydrolized_glycine_mass * ((0.1 + random-float 0.48) / 24) * 0.336)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.1 + random-float 0.48) / 24) * 0.336))
  ]
  ]
end

to hydrolyse_serine
  if time > 0 and time < 216
  [
  if (proteins_mass < 200) [
    let hydrolized_serine_mass proteins_mass
    hatch-serines 1 [set color turquoise set size 0.5 set serines_mass (serines_mass + (hydrolized_serine_mass * ((0.0096 + random-float 0.0904) / 24) * 0.114)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.0096 + random-float 0.0904) / 24) * 0.114))
  ]]
  if time >= 216
  [
     if (proteins_mass < 200) [
    let hydrolized_serine_mass proteins_mass
    hatch-serines 1 [set color turquoise set size 0.5 set serines_mass (serines_mass + (hydrolized_serine_mass * ((0.1 + random-float 0.48) / 24) * 0.114)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.1 + random-float 0.48) / 24) * 0.114))
]]
end

to hydrolyse_threonine
  if time > 0 and time < 216
  [
  if (proteins_mass < 200) [
    let hydrolized_threonine_mass proteins_mass
    hatch-threonines 1 [set color turquoise set size 0.5 set threonines_mass (threonines_mass + (hydrolized_threonine_mass * ((0.0096 + random-float 0.0904) / 24) * 0.096)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.0096 + random-float 0.0904) / 24) * 0.096))
  ]]
  if time >= 216
  [
    if (proteins_mass < 200) [
    let hydrolized_threonine_mass proteins_mass
    hatch-threonines 1 [set color turquoise set size 0.5 set threonines_mass (threonines_mass + (hydrolized_threonine_mass * ((0.1 + random-float 0.48) / 24) * 0.096)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.1 + random-float 0.48) / 24) * 0.096))
]]
end

to hydrolyse_aspartate
  if time > 0 and time < 216
  [
  if (proteins_mass < 200) [
    let hydrolized_aspartate_mass proteins_mass
    hatch-aspartates 1 [set color turquoise set size 0.5 set aspartates_mass (aspartates_mass + (hydrolized_aspartate_mass * ((0.0096 + random-float 0.0904) / 24) * 0.176)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.0096 + random-float 0.0904) / 24) * 0.176))
  ]]
  if time >= 216
  [if (proteins_mass < 200) [
    let hydrolized_aspartate_mass proteins_mass
    hatch-aspartates 1 [set color turquoise set size 0.5 set aspartates_mass (aspartates_mass + (hydrolized_aspartate_mass * ((0.1 + random-float 0.48) / 24) * 0.176)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.1 + random-float 0.48) / 24) * 0.176))
]]
end

to hydrolyse_glutamic
  if time > 0 and time < 216
  [
  if (proteins_mass < 200) [
    let hydrolized_glutamic_mass proteins_mass
    hatch-glutamics 1 [set color turquoise set size 0.5 set glutamics_mass (glutamics_mass + (hydrolized_glutamic_mass * ((0.0096 + random-float 0.0904) / 24) * 0.27)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.0096 + random-float 0.0904) / 24) * 0.27))
  ]]
  if time >= 216
  [
    if (proteins_mass < 200) [
    let hydrolized_glutamic_mass proteins_mass
    hatch-glutamics 1 [set color turquoise set size 0.5 set glutamics_mass (glutamics_mass + (hydrolized_glutamic_mass * ((0.1 + random-float 0.48) / 24) * 0.27)) rt random 360 fd 1] ;; Gavala and Lyberatos, and Lalman based on Woods and Melina, 1965
    set proteins_mass (proteins_mass - (proteins_mass * ((0.1 + random-float 0.48) / 24) * 0.27))
]]
end

to move_proteins
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to die_proteins
  if proteins_mass <= 0 [die]
end

to combine_proteins
  let target one-of other proteins with
  [proteins_mass <= 0.01]
  if target != nobody
  [set proteins_mass proteins_mass + [proteins_mass] of target
   ask target [die]
  ]
end

to move_glycines
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end


to combine_glycines
  if glycines_mass < 7.35
  [
  let target one-of other glycines with
  [glycines_mass <= 7.35]
  if target != nobody
  [set glycines_mass glycines_mass + [glycines_mass] of target
   ask target [die]
  ]]
end

to die_glycines
  if glycines_mass <= 0 [die]
end

to move_serines
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_serines
  if serines_mass < 0.9
  [
  let target one-of other serines with
  [serines_mass <= 4.412]
  if target != nobody
  [set serines_mass serines_mass + [serines_mass] of target
   ask target [die]
  ]]
end

to die_serines
  if serines_mass <= 0 [die]
end

to move_threonines
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_threonines
  if threonines_mass < 2.757
  [
  let target one-of other threonines with
  [threonines_mass <= 2.757]
  if target != nobody
  [set threonines_mass threonines_mass + [threonines_mass] of target
   ask target [die]
  ]]
end

to die_threonines
  if threonines_mass <= 0 [die]
end

to move_aspartates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_aspartates
  if aspartates_mass < 0.9
  [
  let target one-of other aspartates with
  [aspartates_mass <= 3.677]
  if target != nobody
  [set aspartates_mass aspartates_mass + [aspartates_mass] of target
   ask target [die]
  ]]
end

to die_aspartates
  if aspartates_mass <= 0 [die]
end

to move_glutamics
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_glutamics
  if glutamics_mass < 2.451
  [
  let target one-of other glutamics with
  [glutamics_mass <= 2.451]
  if target != nobody
  [set glutamics_mass glutamics_mass + [glutamics_mass] of target
   ask target [die]
  ]]
end

to die_glutamics
  if glutamics_mass <= 0 [die]
end

;;; LIPIDS ;;;
to hydrolyse_myristate
  if (lipids_mass < 200) [
    let hydrolized_myristate_mass lipids_mass
    hatch-myristates 1 [set color turquoise set size 0.5 set myristates_mass (myristates_mass + (hydrolized_myristate_mass * ((0.0096 + random-float 0.1604) / 24) * 0.022)) rt random 360 fd 1] ;;
    set lipids_mass (lipids_mass - (lipids_mass * ((0.0096 + random-float 0.1604) / 24) * 0.022))
  ]
end

to hydrolyse_palmitate
  if (lipids_mass < 200) [
    let hydrolized_palmitate_mass lipids_mass
    hatch-palmitates 1 [set color turquoise set size 0.5 set palmitates_mass (palmitates_mass + (hydrolized_palmitate_mass * ((0.0096 + random-float 0.1604) / 24) * 0.164)) rt random 360 fd 1] ;;
    set lipids_mass (lipids_mass - (lipids_mass * ((0.0096 + random-float 0.1604) / 24) * 0.164))
  ]
end

to hydrolyse_stearate
  if (lipids_mass < 200) [
    let hydrolized_stearate_mass lipids_mass
    hatch-stearates 1 [set color turquoise set size 0.5 set stearates_mass (stearates_mass + (hydrolized_stearate_mass * ((0.0096 + random-float 0.1604) / 24) * 0.081)) rt random 360 fd 1] ;;
    set lipids_mass (lipids_mass - (lipids_mass * ((0.0096 + random-float 0.1604) / 24) * 0.081))
  ]
end

to hydrolyse_oleate
  if (lipids_mass < 200) [
    let hydrolized_oleate_mass lipids_mass
    hatch-oleates 1 [set color turquoise set size 0.5 set oleates_mass (oleates_mass + (hydrolized_oleate_mass * ((0.0096 + random-float 0.1604) / 24) * 0.305)) rt random 360 fd 1] ;;
    set lipids_mass (lipids_mass - (lipids_mass * ((0.0096 + random-float 0.1604) / 24) * 0.305))
  ]
end

to hydrolyse_linoleate
  if (lipids_mass < 200) [
    let hydrolized_linoleate_mass lipids_mass
    hatch-linoleates 1 [set color turquoise set size 0.5 set linoleates_mass (linoleates_mass + (hydrolized_linoleate_mass * ((0.0096 + random-float 0.1604) / 24) * 0.292)) rt random 360 fd 1] ;;
    set lipids_mass (lipids_mass - (lipids_mass * ((0.0096 + random-float 0.1604) / 24) * 0.292))
  ]
end

to move_lipids
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_lipids
  let target one-of other lipids with
  [lipids_mass <= 0.01]
  if target != nobody
  [set lipids_mass lipids_mass + [lipids_mass] of target
   ask target [die]
  ]
end

to die_lipids
  if lipids_mass <= 0 [die]
end

to move_myristates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_myristates
  if myristates_mass < 0.0197
  [
  let target one-of other myristates with
  [myristates_mass <= 0.0197]
  if target != nobody
  [set myristates_mass myristates_mass + [myristates_mass] of target
   ask target [die]
  ]
  ]
end

to die_myristates
  if myristates_mass <= 0 [die]
end

to move_palmitates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_palmitates
  if palmitates_mass < 0.0184
  [
  let target one-of other palmitates with
  [palmitates_mass <= 0.0184]
  if target != nobody
  [set palmitates_mass palmitates_mass + [palmitates_mass] of target
   ask target [die]
  ]]
end

to die_palmitates
  if palmitates_mass <= 0 [die]
end

to move_stearates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end


to combine_stearates
  if stearates_mass < 0.0128
  [
  let target one-of other stearates with
  [stearates_mass <= 0.0128]
  if target != nobody
  [set stearates_mass stearates_mass + [stearates_mass] of target
   ask target [die]
  ]
  ]
end

to die_stearates
  if stearates_mass <= 0 [die]
end

to move_oleates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_oleates
  if oleates_mass < 0.0669
  [
  let target one-of other oleates with
  [oleates_mass <= 0.0669]
  if target != nobody
  [set oleates_mass oleates_mass + [oleates_mass] of target
   ask target [die]
  ]]
end

to die_oleates
  if oleates_mass <= 0 [die]
end

to move_linoleates
  set Heading  90;; Simulates the rotation of the mixer in the AD reactor
   forward 1
end

to combine_linoleates
  if linoleates_mass < 0.0842
  [
  let target one-of other linoleates with
  [linoleates_mass <= 0.0842]
  if target != nobody
  [set linoleates_mass linoleates_mass + [linoleates_mass] of target
   ask target [die]
  ]
  ]
end

to die_linoleates
  if linoleates_mass <= 0 [die]
end


to move_ammonium
  set heading 90;; Simulates the rotation of the mixer in the AD reactor
  forward 1
end

to combine_ammonium
  if ammonium_mass < 1
  [
  let target one-of other ammonium with
  [ammonium_mass <= 1]
  if target != nobody
  [set ammonium_mass ammonium_mass + [ammonium_mass] of target
   ask target [die]
  ]]
end

to death_ammonium
if ammonium_mass <= 0 [die]
end

;;; AMMONIA;;;

to move_ammonia
  set heading 90;; Simulates the rotation of the mixer in the AD reactor
  forward 1
end

to combine_ammonia
  if ammonia_mass < 1
  [
  let target one-of other ammonia with
  [ammonia_mass <= 1]
  if target != nobody
  [set ammonia_mass ammonia_mass + [ammonia_mass] of target
   ask target [die]
  ]
  ]
end

to death_ammonia
if ammonia_mass <= 0 [die]
end


to Calculate_concentrations
  set Initial_concentration_glucose ((sum [glucose_mass] of glucose + 0.000000001) / Reactor_working_volume)

  set Initial_concentration_glycines ((sum [glycines_mass] of glycines + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_serines ((sum [serines_mass] of serines + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_threonines ((sum [threonines_mass] of threonines + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_aspartates ((sum [aspartates_mass] of aspartates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_glutamics ((sum [glutamics_mass] of glutamics + 0.000000001) / Reactor_working_volume)

  set Initial_concentration_myristates ((sum [myristates_mass] of myristates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_palmitates ((sum [palmitates_mass] of palmitates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_stearates ((sum [stearates_mass] of stearates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_oleates ((sum [oleates_mass] of oleates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_linoleates ((sum [linoleates_mass] of linoleates + 0.000000001) / Reactor_working_volume)

  set Initial_concentration_ammonium ((sum [ammonium_mass] of ammonium + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_ammonia ((sum [ammonia_mass] of ammonia + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_butyrates ((sum [butyrates_mass] of butyrates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_propionates ((sum [propionates_mass] of propionates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_ethanols ((sum [ethanols_mass] of ethanols + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_acetates ((sum [acetates_mass] of acetates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_bicarbonates ((sum [bicarbonates_mass] of bicarbonates + 0.000000001) / Reactor_working_volume)
  set Initial_concentration_protons ((sum [protons_mass] of protons + 0.000000001) / Reactor_working_volume)

  set Initial_concentration_hydrogens ((sum [hydrogens_mass] of hydrogens + 0.0000001) / Reactor_working_volume)
  set Initial_concentration_CO2s ((sum [CO2s_mass] of CO2s + 0.0000001) / Reactor_working_volume)
  set Initial_concentration_CH4s ((sum [CH4s_mass] of CH4s + 0.0000001) / Reactor_working_volume)

  set H2% (Initial_concentration_hydrogens) / (Initial_concentration_CO2s + Initial_concentration_CH4s + Initial_concentration_hydrogens)
  set CO2% (Initial_concentration_CO2s) / (Initial_concentration_CO2s + Initial_concentration_CH4s + Initial_concentration_hydrogens)
  set CH4% (Initial_concentration_CH4s) / (Initial_concentration_CO2s + Initial_concentration_CH4s + Initial_concentration_hydrogens)

  set LH2 ((sum [hydrogens_mass] of hydrogens + 0.0000001) / Reactor_working_volume )
  set LCO2 ((sum [CO2s_mass] of CO2s + 0.0000001) / Reactor_working_volume )
  set LCH4 ((sum [CH4s_mass] of CH4s + 0.0000001) / Reactor_working_volume )
end



to move_bacteria
  set heading 90;; Simulates the rotation of the mixer in the AD reactor
  forward 6 ;; Tries to imitate that the biggest mas will move faster
end

;;; CLOSTRIDIALES ;;;

;;; CLOSTRIDIALES FB1;;; For Equation 1

to FB1_eat_glucose;; Clostridial procedure ;; maximum uptake rate is up to 1.03 mmol/mmmolh so... 24.72 mmol/mmol d (Lin et al., 2007) for Clostridium beijerinckii
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
    let prey up-to-n-of 2 other target
    let num_prey count prey
    ifelse (sum [glucose_mass] of prey) > uptake_FB1
      [
        let food_1 min (list uptake_FB1 [glucose_mass] of prey)
        set Gr (-30.9150 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_butyrates ^ (1 / 8)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_1 energy_fs
        let fe_1 energy_fe

        let glucose_re_r ((1 / 8) * 1000 * fe_1)
        let NH4_rs_r ((1 / 20) * 1000 * fs_1)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_1)
        let glucose_rs_r ((1 / 24) * 1000 * fs_1)

        let butyrate_re_p ((1 / 8) * 1000 * fe_1)
        let CO2s_re_p ((1 / 4) * 1000 * fe_1)
        let H2_re_p ((1 / 4) * 1000 * fe_1)
        let H+_re_p ((1 / 8) * 1000 * fe_1)
        let biomass_rs_p ((1 / 20) * 1000 * fs_1)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_1)
        let H2O_rs_p ((1 / 5) * 1000 * fs_1)

        let H2O_sum (H2O_rs_p)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let butyrates_sum (butyrate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Clostridiales_FB1_mass Clostridiales_FB1_mass + (food_1 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_1 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_1 / glucose_sum * NH4_sum)]
        hatch-Butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_1 / glucose_sum * butyrates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_1 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_1 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_1 / glucose_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_1 / glucose_sum * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_1 / num_prey)]
      ]
      [
        set Gr (-30.9150 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_butyrates ^ (1 / 8)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_1b energy_fs
        let fe_1b energy_fe

        let glucose_re_r_1b ((1 / 8) * 1000 * fe_1b)
        let NH4_rs_r_1b ((1 / 20) * 1000 * fs_1b)
        let HCO3_rs_r_1b ((1 / 20) * 1000 * fs_1b)
        let glucose_rs_r_1b ((1 / 24) * 1000 * fs_1b)

        let butyrate_re_p_1b ((1 / 8) * 1000 * fe_1b)
        let CO2s_re_p_1b ((1 / 4) * 1000 * fe_1b)
        let H2_re_p_1b ((1 / 4) * 1000 * fe_1b)
        let H+_re_p_1b ((1 / 8) * 1000 * fe_1b)
        let biomass_rs_p_1b ((1 / 20) * 1000 * fs_1b)
        let CO2_rs_p_1b ( (1 / 20) * 1000 * fs_1b)
        let H2O_rs_p_1b ((1 / 5) * 1000 * fs_1b)

        let H2O_sum_1b (H2O_rs_p_1b)
        let H2_sum_1b (H2_re_p_1b)
        let H+_sum_1b (H+_re_p_1b)
        let CO2_sum_1b (CO2s_re_p_1b + CO2_rs_p_1b)
        let HCO3_sum_1b (HCO3_rs_r_1b)
        let butyrates_sum_1b (butyrate_re_p_1b)
        let glucose_sum_1b (glucose_re_r_1b + glucose_rs_r_1b)
        let NH4_sum_1b (NH4_rs_r_1b)
        let biomass_sum_1b (biomass_rs_p_1b)

        set Clostridiales_FB1_mass Clostridiales_FB1_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * biomass_sum_1b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_1b * HCO3_sum_1b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_1b * NH4_sum_1b)]
        hatch-Butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * butyrates_sum_1b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * CO2_sum_1b) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * H2_sum_1b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass +((sum [glucose_mass] of prey) / glucose_sum_1b * H+_sum_1b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles +((sum [glucose_mass] of prey) / glucose_sum_1b * H2O_sum_1b)
          ask prey [die]]
      ]
    ]
  ]

end

to reproduce_FB1
  if clostridiales_FB1_mass > 1
  [
  set Clostridiales_FB1_mass (Clostridiales_FB1_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB1 1.03
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB1
  set Clostridiales_FB1_mass (Clostridiales_FB1_mass - Clostridiales_FB1_mass * (0.02 / 24));; Represents decay rate per hour based on Antonopoulou et al., 2012.
end


;;; CLOSTRIDIALES FB2;;; For Equation 2

to FB2_eat_glucose;; Clostridial procedure ;; maximum uptake rate is up to 22.4805 mmol/mmol d so... 0.9367 mmol/mmmol h (Batstone et al., 2002 based on Siegrist et al., 2002 and Jeyaseelan et al., 1997) for Clostridium cochlearium JCM 1396 (Cibis et al., 2016)
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
      let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB2
      [
        let food_2 min (list uptake_FB2 [glucose_mass] of prey)
        set Gr (-13.9528 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 12)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (5 / 12)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 12) * (1 ^ (5 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_2 energy_fs
        let fe_2 energy_fe

        let glucose_re_r ((1 / 12) * 1000 * fe_2)
        let H2O_re_r ((1 / 6) * 1000 * fe_2)
        let NH4_rs_r ((1 / 20) * 1000 * fs_2)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_2)
        let glucose_rs_r ((1 / 24) * 1000 * fs_2)

        let propionate_re_p ((1 / 12) * 1000 * fe_2)
        let CO2s_re_p ((1 / 4) * 1000 * fe_2)
        let H2_re_p ((5 / 12) * 1000 * fe_2)
        let H+_re_p ((1 / 12) * 1000 * fe_2)
        let biomass_rs_p ((1 / 20) * 1000 * fs_2)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_2)
        let H2O_rs_p ((1 / 5) * 1000 * fs_2)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let propionates_sum (propionate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Clostridiales_FB2_mass Clostridiales_FB2_mass + (food_2 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_2 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_2 / glucose_sum * NH4_sum) ]
        ask n-of 1 patches [set pcolor black set moles moles - (food_2 / glucose_sum * H2O_sum) ]
        if moles = 0 [die]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + (food_2 / glucose_sum * propionates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_2 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_2 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_2 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_2 / num_prey)]
      ]
      [
        set Gr (-13.9528 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 12)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (5 / 12)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 12) * (1 ^ (5 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_2b energy_fs
        let fe_2b energy_fe

        let glucose_re_r_2b ((1 / 12) * 1000 * fe_2b)
        let H2O_re_r_2b ((1 / 6) * 1000 * fe_2b)
        let NH4_rs_r_2b ((1 / 20) * 1000 * fs_2b)
        let HCO3_rs_r_2b ((1 / 20) * 1000 * fs_2b)
        let glucose_rs_r_2b ((1 / 24) * 1000 * fs_2b)

        let propionate_re_p_2b ((1 / 12) * 1000 * fe_2b)
        let CO2s_re_p_2b ((1 / 4) * 1000 * fe_2b)
        let H2_re_p_2b ((5 / 12) * 1000 * fe_2b)
        let H+_re_p_2b ((1 / 12) * 1000 * fe_2b)
        let biomass_rs_p_2b ((1 / 20) * 1000 * fs_2b)
        let CO2_rs_p_2b ( (1 / 20) * 1000 * fs_2b)
        let H2O_rs_p_2b ((1 / 5) * 1000 * fs_2b)

        let H2O_sum_2b (H2O_rs_p_2b - H2O_re_r_2b)
        let H2_sum_2b (H2_re_p_2b)
        let H+_sum_2b (H+_re_p_2b)
        let CO2_sum_2b (CO2s_re_p_2b + CO2_rs_p_2b)
        let HCO3_sum_2b (HCO3_rs_r_2b)
        let propionates_sum_2b (propionate_re_p_2b)
        let glucose_sum_2b (glucose_re_r_2b + glucose_rs_r_2b)
        let NH4_sum_2b (NH4_rs_r_2b)
        let biomass_sum_2b (biomass_rs_p_2b)

        set Clostridiales_FB2_mass Clostridiales_FB2_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * biomass_sum_2b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_2b * HCO3_sum_2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_2b * NH4_sum_2b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_2b * H2O_sum_2b)]
        if moles = 0 [die]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * propionates_sum_2b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * CO2_sum_2b) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * H2_sum_2b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * H+_sum_2b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_FB2
  if clostridiales_FB2_mass > 1
  [
  set Clostridiales_FB2_mass (Clostridiales_FB2_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB2 0.9367
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB2
  set Clostridiales_FB2_mass (Clostridiales_FB2_mass - Clostridiales_FB2_mass * (0.02 / 24));; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; CLOSTRIDIALES FB3;;; For Equation 3

to FB3_eat_glucose;; Clostridial procedure ;; maximum uptake rate is up to 22.4805 mmol/mmol d so... 0.9367 mmol/mmmol h (Batstone et al., 2002 based on Siegrist et al., 2002 and Jeyaseelan et al., 1997) for Clostridium cochlearium JCM 1396 (Cibis et al., 2016)
if time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB3
      [
        let food_3 min (list uptake_FB3 [glucose_mass] of prey)
        set Gr (-12.7374 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 18)) * (Initial_concentration_acetates ^ (1 / 36)) * (LCO2 ^ (1 / 36)) * (1 ^ (1 / 36)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_3 energy_fs
        let fe_3 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_3)
        let NH4_rs_r ((1 / 20) * 1000 * fs_3)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_3)
        let glucose_rs_r ((1 / 24) * 1000 * fs_3)

        let propionate_re_p ((1 / 18) * 1000 * fe_3)
        let acetate_re_p ((1 / 36) * 1000 * fe_3)
        let CO2s_re_p ((1 / 36) * 1000 * fe_3)
        let H2O_re_p ((1 / 36) * 1000 * fe_3)
        let H+_re_p ((1 / 12) * 1000 * fe_3)
        let biomass_rs_p ((1 / 20) * 1000 * fs_3)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_3)
        let H2O_rs_p ((1 / 5) * 1000 * fs_3)

        let H2O_sum (H2O_re_p + H2O_rs_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let propionates_sum (propionate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Clostridiales_FB3_mass Clostridiales_FB3_mass + (food_3 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_3  / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_3 / glucose_sum * NH4_sum)]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + (food_3 / glucose_sum * propionates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_3 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_3 / glucose_sum * acetate_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_3 / glucose_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_3 / glucose_sum * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_3 / num_prey)]
      ]
      [
        set Gr (-12.7374 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 18)) * (Initial_concentration_acetates ^ (1 / 36)) * (LCO2 ^ (1 / 36)) * (1 ^ (1 / 36)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_3b energy_fs
        let fe_3b energy_fe

        let glucose_re_r_3b ((1 / 24) * 1000 * fe_3b)
        let NH4_rs_r_3b ((1 / 20) * 1000 * fs_3b)
        let HCO3_rs_r_3b ((1 / 20) * 1000 * fs_3b)
        let glucose_rs_r_3b ((1 / 24) * 1000 * fs_3b)

        let propionate_re_p_3b ((1 / 18) * 1000 * fe_3b)
        let acetate_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let CO2s_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let H2O_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let H+_re_p_3b ((1 / 12) * 1000 * fe_3b)
        let biomass_rs_p_3b ((1 / 20) * 1000 * fs_3b)
        let CO2_rs_p_3b (( 1 / 20) * 1000 * fs_3b)
        let H2O_rs_p_3b ((1 / 5) * 1000 * fs_3b)

        let H2O_sum_3b (H2O_re_p_3b + H2O_rs_p_3b)
        let H+_sum_3b (H+_re_p_3b)
        let CO2_sum_3b (CO2s_re_p_3b + CO2_rs_p_3b)
        let HCO3_sum_3b (HCO3_rs_r_3b)
        let acetate_sum_3b (acetate_re_p_3b)
        let propionates_sum_3b (propionate_re_p_3b)
        let glucose_sum_3b (glucose_re_r_3b + glucose_rs_r_3b)
        let NH4_sum_3b (NH4_rs_r_3b)
        let biomass_sum_3b (biomass_rs_p_3b)

        set Clostridiales_FB3_mass Clostridiales_FB3_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * biomass_sum_3b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_3b * HCO3_sum_3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_3b * NH4_sum_3b)]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * propionates_sum_3b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * CO2_sum_3b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * acetate_sum_3b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * H+_sum_3b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glucose_mass] of prey) / glucose_sum_3b * H2O_sum_3b)]
        ask prey [die]
      ]
    ]
  ]
end

to reproduce_FB3
  if clostridiales_FB3_mass > 1
  [
  set Clostridiales_FB3_mass (Clostridiales_FB3_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB3 0.9367
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB3
  set Clostridiales_FB3_mass (Clostridiales_FB3_mass - Clostridiales_FB3_mass * (0.02 / 24));; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; CLOSTRIDIALES FB4;;; For Equation 4


to FB4_eat_glucose;; Clostridial procedure ;; maximum uptake rate is up to 82.928 mmol/mmol d so... 3.4553 mmol/mmmol h (Ntaikou et al., 2010) for Ruminococcus albus,  R. faecis, R. torques. representing Equation 4 based on Ntaikou et al., 2010 and Vavilini et al., 2000
if time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB4
      [
        let food_4 min (list uptake_FB4 [glucose_mass] of prey)
        set Gr (-27.2900 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_ethanols ^ (1 / 4)) * (LCO2 ^ (1 / 4))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_4 energy_fs
        let fe_4 energy_fe

        let glucose_re_r ((1 / 8) * 1000 * fe_4)
        let NH4_rs_r ((1 / 20) * 1000 * fs_4)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_4)
        let glucose_rs_r ((1 / 24) * 1000 * fs_4)

        let ethanol_re_p ((1 / 4) * 1000 * fe_4)
        let CO2s_re_p ((1 / 4) * 1000 * fe_4)
        let biomass_rs_p ((1 / 20) * 1000 * fs_4)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_4)
        let H2O_rs_p ((1 / 5) * 1000 * fs_4)

        let H2O_sum (H2O_rs_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let ethanol_sum (ethanol_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Clostridiales_FB4_mass Clostridiales_FB4_mass + (food_4 / glucose_sum * biomass_rs_p)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_4 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_4 / glucose_sum * NH4_sum)]
        hatch-ethanols 1 [set color brown set size 0.5 set ethanols_mass ethanols_mass + (food_4 / glucose_sum * ethanol_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_4 / glucose_sum  * CO2_sum) right random 360 fd 2]
        if pcolor = black
        [set pcolor blue set moles moles + (food_4 / glucose_sum  * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_4 / num_prey)]
      ]
      [
        set Gr (-27.2900 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_ethanols ^ (1 / 4)) * (LCO2 ^ (1 / 4))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_4b energy_fs
        let fe_4b energy_fe

        let glucose_re_r_4b ((1 / 8) * 1000 * fe_4b)
        let NH4_rs_r_4b ((1 / 20) * 1000 * fs_4b)
        let HCO3_rs_r_4b ((1 / 20) * 1000 * fs_4b)
        let glucose_rs_r_4b ((1 / 24) * 1000 * fs_4b)

        let ethanol_re_p_4b ((1 / 4) * 1000 * fe_4b)
        let CO2s_re_p_4b ((1 / 4) * 1000 * fe_4b)
        let biomass_rs_p_4b ((1 / 20) * 1000 * fs_4b)
        let CO2_rs_p_4b ( (1 / 20 )* 1000 * fs_4b)
        let H2O_rs_p_4b ((1 / 5) * 1000 * fs_4b)

        let H2O_sum_4b (H2O_rs_p_4b)
        let CO2_sum_4b (CO2s_re_p_4b + CO2_rs_p_4b)
        let HCO3_sum_4b (HCO3_rs_r_4b)
        let ethanol_sum_4b (ethanol_re_p_4b)
        let glucose_sum_4b (glucose_re_r_4b + glucose_rs_r_4b)
        let NH4_sum_4b (NH4_rs_r_4b)
        let biomass_sum_4b (biomass_rs_p_4b)

        set Clostridiales_FB4_mass Clostridiales_FB4_mass + ((sum [glucose_mass] of prey)  / glucose_sum_4b * biomass_rs_p_4b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_4b * HCO3_sum_4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_4b * NH4_sum_4b)]
        hatch-ethanols 1 [set color brown set size 0.5 set ethanols_mass ethanols_mass + ((sum [glucose_mass] of prey) / glucose_sum_4b * ethanol_sum_4b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_4b  * CO2_sum_4b) right random 360 fd 2]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glucose_mass] of prey) / glucose_sum_4b  * H2O_sum_4b)]
        ask prey [die]
      ]
    ]
  ]
end

to reproduce_FB4
  if clostridiales_FB4_mass > 1
  [
  set Clostridiales_FB4_mass (Clostridiales_FB4_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB4 3.4553
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB4
  set Clostridiales_FB4_mass (Clostridiales_FB4_mass - Clostridiales_FB4_mass * (0.03 / 24)) ;; Represents decay rate per hour based on Vavilin et al., 2002.
end


;;; CLOSTRIDIALES FB6;;; For Equation 6

to FB6_c_eat_glycine;; Clostridial procedure ;; maximum uptake rate is up to 1.08-7.35 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glycines in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glycines_mass] of prey) > uptake_FB6
      [
        let food_6 min (list uptake_FB6 [glycines_mass] of prey)
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6 energy_fs
        let fe_6 energy_fe

        let glycine_re_r (( 1 / 2) * 1000 * fe_6)
        let H2_re_r ( (1 / 2) * 1000 * fe_6)
        let CO2_rs_r ((1 / 5) * 1000 * fs_6)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_6)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_6)
        let H2_rs_r ((1 / 2) * 1000 * fs_6)

        let acetate_re_p ( (1 / 2) * 1000 * fe_6)
        let NH3_re_p ((1 / 2) * 1000 * fe_6)
        let H+_re_p ((1 / 2) * 1000 * fe_6)
        let biomass_rs_p ((1 / 20) * 1000 * fs_6)
        let H2O_rs_p ((9 / 20) * 1000 * fs_6)

        let H2O_sum ( H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r )
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p)
        let biomass_sum (biomass_rs_p)
        let glycine_sum (glycine_re_r)

        set Clostridiales_FB6_mass Clostridiales_FB6_mass + (food_6 / glycine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_6 / glycine_sum * H2_sum)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_6 / glycine_sum * CO2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_6 / glycine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_6 / glycine_sum * NH4_sum)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_6 / glycine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_6 / glycine_sum * NH3_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_6 / glycine_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_6 / glycine_sum * H2O_sum)]
        ask prey [set glycines_mass glycines_mass - (food_6 / num_prey)]
      ]
      [
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6b energy_fs
        let fe_6b energy_fe

        let glycine_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let H2_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let CO2_rs_r_6b ((1 / 5) * 1000 * fs_6b)
        let NH4_rs_r_6b ( (1 / 20) * 1000 * fs_6b)
        let HCO3_rs_r_6b ((1 / 20) * 1000 * fs_6b)
        let H2_rs_r_6b ((1 / 2) * 1000 * fs_6b)

        let acetate_re_p_6b ( (1 / 2) * 1000 * fe_6b)
        let NH3_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let H+_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let biomass_rs_p_6b ((1 / 20) * 1000 * fs_6b)
        let H2O_rs_p_6b ((9 / 20) * 1000 * fs_6b)

        let H2O_sum_6b ( H2O_rs_p_6b )
        let H2_sum_6b (H2_re_r_6b + H2_rs_r_6b )
        let H+_sum_6b (H+_re_p_6b )
        let CO2_sum_6b (CO2_rs_r_6b)
        let HCO3_sum_6b (HCO3_rs_r_6b)
        let acetate_sum_6b (acetate_re_p_6b)
        let NH4_sum_6b (NH4_rs_r_6b)
        let NH3_sum_6b (NH3_re_p_6b)
        let biomass_sum_6b (biomass_rs_p_6b)
        let glycine_sum_6b (glycine_re_r_6b)

        set Clostridiales_FB6_mass Clostridiales_FB6_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * biomass_sum_6b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * H2_sum_6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * CO2_sum_6b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glycines_mass] of prey)/ glycine_sum_6b * HCO3_sum_6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * NH4_sum_6b)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [glycines_mass] of prey)/ glycine_sum_6b * acetate_sum_6b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * NH3_sum_6b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * H+_sum_6b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glycines_mass] of prey) / glycine_sum_6b * H2O_sum_6b)]

        ask prey [die]
      ]
    ]
]

end

to reproduce_c_FB6
  if clostridiales_FB6_mass > 1
  [
  set Clostridiales_FB6_mass (Clostridiales_FB6_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB6 (1.08 + random-float 6.27)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_c_FB6
  set Clostridiales_FB6_mass (Clostridiales_FB6_mass - Clostridiales_FB6_mass * ((0.02) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; CLOSTRIDIALES FB7;;; For Equation 7

to FB7_c_eat_serine;; Clostridial procedure ;; maximum uptake rate is up to 1.08-4.412 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target serines in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [serines_mass] of prey) > uptake_FB7
      [
        let food_7 min (list uptake_FB7 [serines_mass] of prey)
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7 energy_fs
        let fe_7 energy_fe

        let serine_re_r ( (1 / 10) * 1000 * fe_7)
        let H2O_re_r ( (1 / 10) * 1000 * fe_7)
        let serine_rs_r ((1 / 10) * 1000 * fs_7)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_7)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_7)

        let acetate_re_p ( (1 / 10) * 1000 * fe_7)
        let NH3_re_p ((1 / 10) * 1000 * fe_7)
        let CO2_re_p ((1 / 10) * 1000 * fe_7)
        let H2_re_p ((1 / 10) * 1000 * fe_7)
        let H+_re_p ((1 / 10) * 1000 * fe_7)
        let biomass_rs_p ((1 / 20) * 1000 * fs_7)
        let CO2_rs_p ((1 / 10) * 1000 * fs_7)
        let NH3_rs_p ((1 / 10) * 1000 * fs_7)
        let H2O_rs_p ((3 / 20) * 1000 * fs_7)

        let H2O_sum ( H2O_re_r + H2O_rs_p )
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let serine_sum (serine_re_r + serine_rs_r)

        set Clostridiales_FB7_mass Clostridiales_FB7_mass + (food_7 / serine_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_7 / serine_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_7 / serine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_7 / serine_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_7 / serine_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_7 / serine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_7 / serine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_7 / serine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_7 / serine_sum * NH3_sum) right random 360 fd 3]

        ask prey [set serines_mass serines_mass - (food_7 / num_prey)]
      ]
      [
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7b energy_fs
        let fe_7b energy_fe

        let serine_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let H2O_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let serine_rs_r_7b ((1 / 10) * 1000 * fs_7b)
        let NH4_rs_r_7b ( (1 / 20) * 1000 * fs_7b)
        let HCO3_rs_r_7b ((1 / 20) * 1000 * fs_7b)

        let acetate_re_p_7b ( (1 / 10) * 1000 * fe_7b)
        let NH3_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let CO2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H+_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let biomass_rs_p_7b ((1 / 20) * 1000 * fs_7b)
        let CO2_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let NH3_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let H2O_rs_p_7b ((3 / 20) * 1000 * fs_7b)

        let H2O_sum_7b ( H2O_re_r_7b + H2O_rs_p_7b )
        let H2_sum_7b (H2_re_p_7b)
        let H+_sum_7b (H+_re_p_7b )
        let CO2_sum_7b (CO2_re_p_7b + CO2_rs_p_7b)
        let HCO3_sum_7b (HCO3_rs_r_7b)
        let acetate_sum_7b (acetate_re_p_7b)
        let NH4_sum_7b (NH4_rs_r_7b)
        let NH3_sum_7b (NH3_re_p_7b + NH3_rs_p_7b)
        let biomass_sum_7b (biomass_rs_p_7b)
        let serine_sum_7b (serine_re_r_7b + serine_rs_r_7b)

        set Clostridiales_FB7_mass Clostridiales_FB7_mass + ((sum [serines_mass] of prey) / serine_sum_7b * biomass_sum_7b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [serines_mass] of prey) / serine_sum_7b * H2O_sum_7b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [serines_mass] of prey) / serine_sum_7b * HCO3_sum_7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [serines_mass] of prey) / serine_sum_7b * NH4_sum_7b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H2_sum_7b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H+_sum_7b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [serines_mass] of prey) / serine_sum_7b * CO2_sum_7b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [serines_mass] of prey) / serine_sum_7b * acetate_sum_7b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [serines_mass] of prey) / serine_sum_7b * NH3_sum_7b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_c_FB7
  if clostridiales_FB7_mass > 1
  [
  set Clostridiales_FB7_mass (Clostridiales_FB7_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB7 (1.08 + random-float 3.332)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_c_FB7
  set Clostridiales_FB7_mass (Clostridiales_FB7_mass - Clostridiales_FB7_mass * ((0.02) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end


;;; CLOSTRIDIALES FB8;;; For Equation 8

to FB8_c_eat_threonine;; Clostridial procedure ;; maximum uptake rate is up to 1.08-2.757 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target threonines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [threonines_mass] of prey) > uptake_FB8
      [
        let food_8 min (list uptake_FB8 [threonines_mass] of prey)
        set Gr (-6.5252 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8 energy_fs
        let fe_8 energy_fe

        let threonine_re_r ( (1 / 18) * 1000 * fe_8)
        let H2_re_r ( (1 / 18) * 1000 * fe_8)
        let threonine_rs_r ((1 / 18) * 1000 * fs_8)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_8)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_8)
        let H2_rs_r ((1 / 18) * 1000 * fs_8)

        let acetate_re_p ( (1 / 18) * 1000 * fe_8)
        let butyrate_re_p ((1 / 36) * 1000 * fe_8)
        let NH3_re_p ((1 / 18) * 1000 * fe_8)
        let H+_re_p ((1 / 12) * 1000 * fe_8)
        let biomass_rs_p ((1 / 20) * 1000 * fs_8)
        let CO2_rs_p ((1 / 45) * 1000 * fs_8)
        let NH3_rs_p ((1 / 18) * 1000 * fs_8)
        let H2O_rs_p ((31 / 180) * 1000 * fs_8)

        let H2O_sum (H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let butyrate_sum (butyrate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let threonine_sum (threonine_re_r + threonine_rs_r)

        set Clostridiales_FB8_mass Clostridiales_FB8_mass + (food_8 / threonine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_8 / threonine_sum * H2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_8 / threonine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_8 / threonine_sum * NH4_sum)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_8 / threonine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_8 / threonine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_8 / threonine_sum * acetate_sum) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_8 / threonine_sum * butyrate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_8 / threonine_sum * NH3_sum) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_8 / threonine_sum * H2O_sum)]

        ask prey [set threonines_mass threonines_mass - (food_8 / num_prey)]
      ]
      [
        set Gr (-6.5261 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8b energy_fs
        let fe_8b energy_fe

        let threonine_re_r_8b (( 1 / 18) * 1000 * fe_8b)
        let H2_re_r_8b ( (1 / 18) * 1000 * fe_8b)
        let threonine_rs_r_8b ((1 / 18) * 1000 * fs_8b)
        let NH4_rs_r_8b ( (1 / 20) * 1000 * fs_8b)
        let HCO3_rs_r_8b ((1 / 20) * 1000 * fs_8b)
        let H2_rs_r_8b ((1 / 18) * 1000 * fs_8b)

        let acetate_re_p_8b (( 1 / 18) * 1000 * fe_8b)
        let butyrate_re_p_8b ((1 / 36) * 1000 * fe_8b)
        let NH3_re_p_8b ((1 / 18) * 1000 * fe_8b)
        let H+_re_p_8b ((1 / 12) * 1000 * fe_8b)
        let biomass_rs_p_8b ((1 / 20) * 1000 * fs_8b)
        let CO2_rs_p_8b ((1 / 45) * 1000 * fs_8b)
        let NH3_rs_p_8b ((1 / 18) * 1000 * fs_8b)
        let H2O_rs_p_8b ((31 / 180) * 1000 * fs_8b)

        let H2O_sum_8b (H2O_rs_p_8b )
        let H2_sum_8b (H2_re_r_8b + H2_rs_r_8b)
        let H+_sum_8b (H+_re_p_8b )
        let CO2_sum_8b (CO2_rs_p_8b)
        let HCO3_sum_8b (HCO3_rs_r_8b)
        let acetate_sum_8b (acetate_re_p_8b)
        let butyrate_sum_8b (butyrate_re_p_8b)
        let NH4_sum_8b (NH4_rs_r_8b)
        let NH3_sum_8b (NH3_re_p_8b + NH3_rs_p_8b)
        let biomass_sum_8b (biomass_rs_p_8b)
        let threonine_sum_8b (threonine_re_r_8b + threonine_rs_r_8b)

        set Clostridiales_FB8_mass Clostridiales_FB8_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * biomass_sum_8b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * H2_sum_8b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * HCO3_sum_8b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * NH4_sum_8b)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * H+_sum_8b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * CO2_sum_8b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * acetate_sum_8b) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * butyrate_sum_8b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * NH3_sum_8b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [threonines_mass] of prey) / threonine_sum_8b * H2O_sum_8b)]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_c_FB8
  if clostridiales_FB8_mass > 1
  [
  set Clostridiales_FB8_mass (Clostridiales_FB8_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB8 (1.08 + random-float 1.677)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_c_FB8
  set Clostridiales_FB8_mass (Clostridiales_FB8_mass - Clostridiales_FB8_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end


;;; CLOSTRIDIALES FB9;;; For Equation 9

to FB9_c_eat_aspartate;; Clostridial procedure ;; maximum uptake rate is up to 1.08-3.677 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target aspartates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [aspartates_mass] of prey) > uptake_FB9
      [
        let food_9 min (list uptake_FB9 [aspartates_mass] of prey)
        set Gr (-2.7612 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (Initial_concentration_CO2s ^ (1 / 6)) * (Initial_concentration_ammonia ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_aspartates ^ (1 / 12)) * (1 ^ (1 / 6)))))
        set energy_fs 1 / (1 + abs((((18.4243 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_9 energy_fs
        let fe_9 energy_fe

        let aspartate_re_r ( (1 / 12) * 1000 * fe_9)
        let H2O_re_r ( (1 / 6) * 1000 * fe_9)
        let aspartate_rs_r ((1 / 12) * 1000 * fs_9)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_9)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_9)

        let acetate_re_p (( 1 / 12) * 1000 * fe_9)
        let CO2s_re_p ((1 / 6) * 1000 * fe_9)
        let NH3_re_p ((1 / 12) * 1000 * fe_9)
        let H2_re_p ((1 / 6) * 1000 * fe_9)
        let H+_re_p ((1 / 12) * 1000 * fe_9)
        let biomass_rs_p ((1 / 20) * 1000 * fs_9)
        let NH3_rs_p ((1 / 12) * 1000 * fs_9)
        let CO2_rs_p ((2 / 15) * 1000 * fs_9)
        let H2O_rs_p ((7 / 60) * 1000 * fs_9)

        let H2O_sum (H2O_re_r + H2O_rs_p )
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let aspartate_sum (aspartate_re_r + aspartate_rs_r)

        set Clostridiales_FB9_mass Clostridiales_FB9_mass + (food_9 / aspartate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_9 / aspartate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_9 / aspartate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_9 / aspartate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_9 / aspartate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_9 / aspartate_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_9 / aspartate_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_9 / aspartate_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_9 / aspartate_sum * NH3_sum) right random 360 fd 3]

        ask prey [set aspartates_mass aspartates_mass - (food_9 / num_prey)]
      ]
      [
        set Gr (-2.7612 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (Initial_concentration_CO2s ^ (1 / 6)) * (Initial_concentration_ammonia ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_aspartates ^ (1 / 12)) * (1 ^ (1 / 6)))))
        set energy_fs 1 / (1 + abs((((18.4243 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_9b energy_fs
        let fe_9b energy_fe

        let aspartate_re_r_9b ( (1 / 12) * 1000 * fe_9b)
        let H2O_re_r_9b ( (1 / 6) * 1000 * fe_9b)
        let aspartate_rs_r_9b ((1 / 12) * 1000 * fs_9b)
        let NH4_rs_r_9b ( (1 / 20) * 1000 * fs_9b)
        let HCO3_rs_r_9b ((1 / 20) * 1000 * fs_9b)

        let acetate_re_p_9b ( (1 / 12) * 1000 * fe_9b)
        let CO2s_re_p_9b ((1 / 6) * 1000 * fe_9b)
        let NH3_re_p_9b ((1 / 12) * 1000 * fe_9b)
        let H2_re_p_9b ((1 / 6) * 1000 * fe_9b)
        let H+_re_p_9b ((1 / 12) * 1000 * fe_9b)
        let biomass_rs_p_9b ((1 / 20) * 1000 * fs_9b)
        let NH3_rs_p_9b ((1 / 12) * 1000 * fs_9b)
        let CO2_rs_p_9b ((2 / 15) * 1000 * fs_9b)
        let H2O_rs_p_9b ((7 / 60) * 1000 * fs_9b)

        let H2O_sum_9b (H2O_re_r_9b + H2O_rs_p_9b )
        let H2_sum_9b (H2_re_p_9b)
        let H+_sum_9b (H+_re_p_9b )
        let CO2_sum_9b (CO2s_re_p_9b + CO2_rs_p_9b)
        let HCO3_sum_9b (HCO3_rs_r_9b)
        let acetate_sum_9b (acetate_re_p_9b)
        let NH4_sum_9b (NH4_rs_r_9b)
        let NH3_sum_9b (NH3_re_p_9b + NH3_rs_p_9b)
        let biomass_sum_9b (biomass_rs_p_9b)
        let aspartate_sum_9b (aspartate_re_r_9b + aspartate_rs_r_9b)

        set Clostridiales_FB9_mass Clostridiales_FB9_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * biomass_sum_9b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * H2O_sum_9b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * HCO3_sum_9b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * NH4_sum_9b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * H2_sum_9b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * H+_sum_9b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * CO2_sum_9b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * acetate_sum_9b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum  [aspartates_mass] of prey) / aspartate_sum_9b * NH3_sum_9b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_c_FB9
  if clostridiales_FB9_mass > 1
  [
  set Clostridiales_FB9_mass (Clostridiales_FB9_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB9 (1.08 + random-float 2.597)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_c_FB9
  set Clostridiales_FB9_mass (Clostridiales_FB9_mass - Clostridiales_FB9_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; CLOSTRIDIALES FB10;;; For Equation 10

to FB10_c_eat_glutamic;; Clostridial procedure ;; maximum uptake rate is up to 1.08-2.451 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glutamics in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glutamics_mass] of prey) > uptake_FB10
      [
        let food_10 min (list uptake_FB10 [glutamics_mass] of prey)
        set Gr (-3.1746 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * (Initial_concentration_CO2s ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_glutamics ^ (1 / 18)) * (1 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((5.7870 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_10 energy_fs
        let fe_10 energy_fe

        let glutamic_re_r ( (1 / 18) * 1000 * fe_10)
        let H2O_re_r ( (1 / 18) * 1000 * fe_10)
        let glutamic_rs_r ((18 / 12) * 1000 * fs_10)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_10)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_10)

        let acetate_re_p ( (1 / 18) * 1000 * fe_10)
        let butyrate_re_p ((1 / 36) * 1000 * fe_10)
        let NH3_re_p ((1 / 18) * 1000 * fe_10)
        let CO2s_re_p ((1 / 18) * 1000 * fe_10)
        let H+_re_p ((1 / 12) * 1000 * fe_10)
        let biomass_rs_p ((1 / 20) * 1000 * fs_10)
        let NH3_rs_p ((1 / 18) * 1000 * fs_10)
        let CO2_rs_p ((7 / 90) * 1000 * fs_10)
        let H2O_rs_p ((7 / 60) * 1000 * fs_10)

        let H2O_sum (H2O_re_r + H2O_rs_p )
        let H+_sum (H+_re_p )
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let butyrate_sum (butyrate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let glutamic_sum (glutamic_re_r + glutamic_rs_r)

        set Clostridiales_FB10_mass Clostridiales_FB10_mass + (food_10 / glutamic_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_10 / glutamic_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_10 / glutamic_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_10 / glutamic_sum * NH4_sum)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_10 / glutamic_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_10 / glutamic_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_10 / glutamic_sum * acetate_sum) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_10 / glutamic_sum * butyrate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_10 / glutamic_sum * NH3_sum) right random 360 fd 3]

        ask prey [set glutamics_mass glutamics_mass - (food_10 / num_prey)]
      ]
      [
        set Gr (-3.1746 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * (Initial_concentration_CO2s ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_glutamics ^ (1 / 18)) * (1 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((5.7870 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_10b energy_fs
        let fe_10b energy_fe

        let glutamic_re_r_10b ( (1 / 18) * 1000 * fe_10b)
        let H2O_re_r_10b ( (1 / 18) * 1000 * fe_10b)
        let glutamic_rs_r_10b ((18 / 12) * 1000 * fs_10b)
        let NH4_rs_r_10b ( (1 / 20) * 1000 * fs_10b)
        let HCO3_rs_r_10b ((1 / 20) * 1000 * fs_10b)

        let acetate_re_p_10b ( (1 / 18) * 1000 * fe_10b)
        let butyrate_re_p_10b ((1 / 36) * 1000 * fe_10b)
        let NH3_re_p_10b ((1 / 18) * 1000 * fe_10b)
        let CO2s_re_p_10b ((1 / 18) * 1000 * fe_10b)
        let H+_re_p_10b ((1 / 12) * 1000 * fe_10b)
        let biomass_rs_p_10b ((1 / 20) * 1000 * fs_10b)
        let NH3_rs_p_10b ((1 / 18) * 1000 * fs_10b)
        let CO2_rs_p_10b ((7 / 90) * 1000 * fs_10b)
        let H2O_rs_p_10b ((7 / 60) * 1000 * fs_10b)

        let H2O_sum_10b (H2O_re_r_10b + H2O_rs_p_10b )
        let H+_sum_10b (H+_re_p_10b )
        let CO2_sum_10b (CO2s_re_p_10b + CO2_rs_p_10b)
        let HCO3_sum_10b (HCO3_rs_r_10b)
        let acetate_sum_10b (acetate_re_p_10b)
        let butyrate_sum_10b (butyrate_re_p_10b)
        let NH4_sum_10b (NH4_rs_r_10b)
        let NH3_sum_10b (NH3_re_p_10b + NH3_rs_p_10b)
        let biomass_sum_10b (biomass_rs_p_10b)
        let glutamic_sum_10b (glutamic_re_r_10b + glutamic_rs_r_10b)

        set Clostridiales_FB10_mass Clostridiales_FB10_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * biomass_sum_10b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glutamics_mass] of prey) / glutamic_sum_10b * H2O_sum_10b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glutamics_mass] of prey) / glutamic_sum_10b * HCO3_sum_10b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glutamics_mass] of prey) / glutamic_sum_10b * NH4_sum_10b)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * H+_sum_10b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * CO2_sum_10b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * acetate_sum_10b) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * butyrate_sum_10b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * NH3_sum_10b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_c_FB10
  if clostridiales_FB10_mass > 1
  [
  set Clostridiales_FB10_mass (Clostridiales_FB10_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB10 (1.08 + random-float 1.371)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_c_FB10
  set Clostridiales_FB10_mass (Clostridiales_FB10_mass - Clostridiales_FB10_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end


;;; BACTEROIDALES ;;;

;;; BACTEROIDALES FB1;;; For Equation 1

to FB1_b_eat_glucose;; Bacteroidal procedure ;; Based on Clostridiales maximum uptake rate is up to 1.03 mmol/mmmolh so... 24.72 mmol/mmol d (Lin et al., 2007) for Clostridium beijerinckii
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_b_FB1
      [
        let food_1 min (list uptake_b_FB1 [glucose_mass] of prey)
        set Gr (-30.9150 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_butyrates ^ (1 / 8)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_1 energy_fs
        let fe_1 energy_fe

        let glucose_re_r ((1 / 8) * 1000 * fe_1)
        let NH4_rs_r ((1 / 20) * 1000 * fs_1)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_1)
        let glucose_rs_r ((1 / 24) * 1000 * fs_1)

        let butyrate_re_p ((1 / 8) * 1000 * fe_1)
        let CO2s_re_p ((1 / 4) * 1000 * fe_1)
        let H2_re_p ((1 / 4) * 1000 * fe_1)
        let H+_re_p ((1 / 8) * 1000 * fe_1)
        let biomass_rs_p ((1 / 20) * 1000 * fs_1)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_1)
        let H2O_rs_p ((1 / 5) * 1000 * fs_1)

        let H2O_sum (H2O_rs_p)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let butyrates_sum (butyrate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Bacteroidales_FB1_mass Bacteroidales_FB1_mass + (food_1 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_1 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_1 / glucose_sum * NH4_sum)]
        hatch-Butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_1 / glucose_sum * butyrates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_1 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_1 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_1 / glucose_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_1 / glucose_sum * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_1 / num_prey)]
      ]
      [
        set Gr (-30.9150 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_butyrates ^ (1 / 8)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_1b energy_fs
        let fe_1b energy_fe

        let glucose_re_r_1b ((1 / 8) * 1000 * fe_1b)
        let NH4_rs_r_1b ((1 / 20) * 1000 * fs_1b)
        let HCO3_rs_r_1b ((1 / 20) * 1000 * fs_1b)
        let glucose_rs_r_1b ((1 / 24) * 1000 * fs_1b)

        let butyrate_re_p_1b ((1 / 8) * 1000 * fe_1b)
        let CO2s_re_p_1b ((1 / 4) * 1000 * fe_1b)
        let H2_re_p_1b ((1 / 4) * 1000 * fe_1b)
        let H+_re_p_1b ((1 / 8) * 1000 * fe_1b)
        let biomass_rs_p_1b ((1 / 20) * 1000 * fs_1b)
        let CO2_rs_p_1b ( (1 / 20) * 1000 * fs_1b)
        let H2O_rs_p_1b ((1 / 5) * 1000 * fs_1b)

        let H2O_sum_1b (H2O_rs_p_1b)
        let H2_sum_1b (H2_re_p_1b)
        let H+_sum_1b (H+_re_p_1b)
        let CO2_sum_1b (CO2s_re_p_1b + CO2_rs_p_1b)
        let HCO3_sum_1b (HCO3_rs_r_1b)
        let butyrates_sum_1b (butyrate_re_p_1b)
        let glucose_sum_1b (glucose_re_r_1b + glucose_rs_r_1b)
        let NH4_sum_1b (NH4_rs_r_1b)
        let biomass_sum_1b (biomass_rs_p_1b)

        set Bacteroidales_FB1_mass Bacteroidales_FB1_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * biomass_sum_1b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_1b * HCO3_sum_1b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_1b * NH4_sum_1b)]
        hatch-Butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * butyrates_sum_1b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * CO2_sum_1b) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * H2_sum_1b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_1b * H+_sum_1b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glucose_mass] of prey) / glucose_sum_1b * H2O_sum_1b)]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB1
  if bacteroidales_FB1_mass > 1
  [
  set bacteroidales_FB1_mass (bacteroidales_FB1_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB1 1.03
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB1
  set bacteroidales_FB1_mass (bacteroidales_FB1_mass - bacteroidales_FB1_mass * (0.02 / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; BACTEROIDALES FB2;;; For Equation 2

to FB2_b_eat_glucose;; Bacteroidal procedure ;; Based on Clostridiales maximum uptake rate is up to 22.4805 mmol/mmol d so... 0.9367 mmol/mmmol h (Batstone et al., 2002 based on Siegrist et al., 2002 and Jeyaseelan et al., 1997) for Clostridium cochlearium JCM 1396 (Cibis et al., 2016)
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_b_FB2
      [
        let food_2 min (list uptake_b_FB2 [glucose_mass] of prey)
        set Gr (-13.9528 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 12)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (5 / 12)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 12) * (1 ^ (5 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_2 energy_fs
        let fe_2 energy_fe

        let glucose_re_r ((1 / 12) * 1000 * fe_2)
        let H2O_re_r ((1 / 6) * 1000 * fe_2)
        let NH4_rs_r ((1 / 20) * 1000 * fs_2)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_2)
        let glucose_rs_r ((1 / 24) * 1000 * fs_2)

        let propionate_re_p ((1 / 12) * 1000 * fe_2)
        let CO2s_re_p ((1 / 4) * 1000 * fe_2)
        let H2_re_p ((5 / 12) * 1000 * fe_2)
        let H+_re_p ((1 / 12) * 1000 * fe_2)
        let biomass_rs_p ((1 / 20) * 1000 * fs_2)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_2)
        let H2O_rs_p ((1 / 5) * 1000 * fs_2)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let propionates_sum (propionate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Bacteroidales_FB2_mass Bacteroidales_FB2_mass + (food_2 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_2 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_2 / glucose_sum * NH4_sum) ]
        ask n-of 1 patches [set pcolor black set moles moles - (food_2 / glucose_sum * H2O_sum) ]
        if moles = 0 [die]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + (food_2 / glucose_sum * propionates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_2 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_2 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_2 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_2 / num_prey)]
      ]
      [
        set Gr (-13.9528 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 12)) * (LCO2 ^ (1 / 4)) * (LH2 ^ (5 / 12)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 12) * (1 ^ (5 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_2b energy_fs
        let fe_2b energy_fe

        let glucose_re_r_2b ((1 / 12) * 1000 * fe_2b)
        let H2O_re_r_2b ((1 / 6) * 1000 * fe_2b)
        let NH4_rs_r_2b ((1 / 20) * 1000 * fs_2b)
        let HCO3_rs_r_2b ((1 / 20) * 1000 * fs_2b)
        let glucose_rs_r_2b ((1 / 24) * 1000 * fs_2b)

        let propionate_re_p_2b ((1 / 12) * 1000 * fe_2b)
        let CO2s_re_p_2b ((1 / 4) * 1000 * fe_2b)
        let H2_re_p_2b ((5 / 12) * 1000 * fe_2b)
        let H+_re_p_2b ((1 / 12) * 1000 * fe_2b)
        let biomass_rs_p_2b ((1 / 20) * 1000 * fs_2b)
        let CO2_rs_p_2b ( (1 / 20) * 1000 * fs_2b)
        let H2O_rs_p_2b ((1 / 5) * 1000 * fs_2b)

        let H2O_sum_2b (H2O_rs_p_2b - H2O_re_r_2b)
        let H2_sum_2b (H2_re_p_2b)
        let H+_sum_2b (H+_re_p_2b)
        let CO2_sum_2b (CO2s_re_p_2b + CO2_rs_p_2b)
        let HCO3_sum_2b (HCO3_rs_r_2b)
        let propionates_sum_2b (propionate_re_p_2b)
        let glucose_sum_2b (glucose_re_r_2b + glucose_rs_r_2b)
        let NH4_sum_2b (NH4_rs_r_2b)
        let biomass_sum_2b (biomass_rs_p_2b)

        set Bacteroidales_FB2_mass bacteroidales_FB2_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * biomass_sum_2b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_2b * HCO3_sum_2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_2b * NH4_sum_2b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_2b * H2O_sum_2b)]
        if moles = 0 [die]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * propionates_sum_2b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * CO2_sum_2b) right random 360 fd 2]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * H2_sum_2b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_2b * H+_sum_2b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB2
  if bacteroidales_FB2_mass > 1
  [
  set bacteroidales_FB2_mass (Bacteroidales_FB2_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB2 0.9366
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB2
  set Bacteroidales_FB2_mass (bacteroidales_FB2_mass - bacteroidales_FB2_mass * (0.02 / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;BACTEROIDALES FB3;;; For Equation 3

to FB3_b_eat_glucose;; Bacteroidal procedure ;; Based on Clostridiales maximum uptake rate is up to 22.4805 mmol/mmol d so... 0.9367 mmol/mmmol h (Batstone et al., 2002 based on Siegrist et al., 2002 and Jeyaseelan et al., 1997) for Clostridium cochlearium JCM 1396 (Cibis et al., 2016)
if time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_b_FB3
      [
        let food_3 min (list uptake_b_FB3 [glucose_mass] of prey)
        set Gr (-12.7374 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 18)) * (Initial_concentration_acetates ^ (1 / 36)) * (LCO2 ^ (1 / 36)) * (1 ^ (1 / 36)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_3 energy_fs
        let fe_3 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_3)
        let NH4_rs_r ((1 / 20) * 1000 * fs_3)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_3)
        let glucose_rs_r ((1 / 24) * 1000 * fs_3)

        let propionate_re_p ((1 / 18) * 1000 * fe_3)
        let acetate_re_p ((1 / 36) * 1000 * fe_3)
        let CO2s_re_p ((1 / 36) * 1000 * fe_3)
        let H2O_re_p ((1 / 36) * 1000 * fe_3)
        let H+_re_p ((1 / 12) * 1000 * fe_3)
        let biomass_rs_p ((1 / 20) * 1000 * fs_3)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_3)
        let H2O_rs_p ((1 / 5) * 1000 * fs_3)

        let H2O_sum (H2O_re_p + H2O_rs_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let propionates_sum (propionate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Bacteroidales_FB3_mass Bacteroidales_FB3_mass + (food_3 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_3  / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_3 / glucose_sum * NH4_sum)]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + (food_3 / glucose_sum * propionates_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_3 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_3 / glucose_sum * acetate_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_3 / glucose_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_3 / glucose_sum * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_3 / num_prey)]
      ]
      [
        set Gr (-12.7374 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_propionates ^ (1 / 18)) * (Initial_concentration_acetates ^ (1 / 36)) * (LCO2 ^ (1 / 36)) * (1 ^ (1 / 36)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_3b energy_fs
        let fe_3b energy_fe

        let glucose_re_r_3b ((1 / 24) * 1000 * fe_3b)
        let NH4_rs_r_3b ((1 / 20) * 1000 * fs_3b)
        let HCO3_rs_r_3b ((1 / 20) * 1000 * fs_3b)
        let glucose_rs_r_3b ((1 / 24) * 1000 * fs_3b)

        let propionate_re_p_3b ((1 / 18) * 1000 * fe_3b)
        let acetate_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let CO2s_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let H2O_re_p_3b ((1 / 36) * 1000 * fe_3b)
        let H+_re_p_3b ((1 / 12) * 1000 * fe_3b)
        let biomass_rs_p_3b ((1 / 20) * 1000 * fs_3b)
        let CO2_rs_p_3b ( (1 / 20) * 1000 * fs_3b)
        let H2O_rs_p_3b ((1 / 5) * 1000 * fs_3b)

        let H2O_sum_3b (H2O_re_p_3b + H2O_rs_p_3b)
        let H+_sum_3b (H+_re_p_3b)
        let CO2_sum_3b (CO2s_re_p_3b + CO2_rs_p_3b)
        let HCO3_sum_3b (HCO3_rs_r_3b)
        let acetate_sum_3b (acetate_re_p_3b)
        let propionates_sum_3b (propionate_re_p_3b)
        let glucose_sum_3b (glucose_re_r_3b + glucose_rs_r_3b)
        let NH4_sum_3b (NH4_rs_r_3b)
        let biomass_sum_3b (biomass_rs_p_3b)

        set Bacteroidales_FB3_mass Bacteroidales_FB3_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * biomass_sum_3b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_3b * HCO3_sum_3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_3b * NH4_sum_3b)]
        hatch-propionates 1 [set color gray set size 0.5 set propionates_mass propionates_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * propionates_sum_3b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * CO2_sum_3b)right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * acetate_sum_3b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_3b * H+_sum_3b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glucose_mass] of prey) / glucose_sum_3b * H2O_sum_3b)]
        ask prey [die]
      ]
    ]
  ]
end

to reproduce_b_FB3
  if bacteroidales_FB3_mass > 1
  [
  set bacteroidales_FB3_mass (bacteroidales_FB3_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB3 0.9367
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB3
  set Bacteroidales_FB3_mass (Bacteroidales_FB3_mass - Bacteroidales_FB3_mass * (0.02 / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end


;;;BACTEROIDALES FB4;;; For Equation 4


to FB4_b_eat_glucose;; Bacteroidal procedure ;; Based on maximum uptake rate is up to 82.928 mmol/mmol d from Clostridiales so... 3.4553 mmol/mmmol h (Ntaikou et al., 2010) for Ruminococcus albus,  R. faecis, R. torques. representing Equation 4 based on Ntaikou et al., 2010 and Vavilini et al., 2000
if time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_b_FB4
      [
        let food_4 min (list uptake_b_FB4 [glucose_mass] of prey)
        set Gr (-27.2900 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_ethanols ^ (1 / 4)) * (LCO2 ^ (1 / 4))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_4 energy_fs
        let fe_4 energy_fe

        let glucose_re_r ((1 / 8) * 1000 * fe_4)
        let NH4_rs_r ((1 / 20) * 1000 * fs_4)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_4)
        let glucose_rs_r ((1 / 24) * 1000 * fs_4)

        let ethanol_re_p ((1 / 4) * 1000 * fe_4)
        let CO2s_re_p ((1 / 4) * 1000 * fe_4)
        let biomass_rs_p ((1 / 20) * 1000 * fs_4)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_4)
        let H2O_rs_p ((1 / 5) * 1000 * fs_4)

        let H2O_sum (H2O_rs_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let ethanol_sum (ethanol_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Bacteroidales_FB4_mass Bacteroidales_FB4_mass + (food_4 / glucose_sum * biomass_rs_p)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_4 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_4 / glucose_sum * NH4_sum)]
        hatch-ethanols 1 [set color brown set size 0.5 set ethanols_mass ethanols_mass + (food_4 / glucose_sum * ethanol_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_4 / glucose_sum  * CO2_sum) right random 360 fd 2]
        if pcolor = black
        [set pcolor blue set moles moles + (food_4 / glucose_sum  * H2O_sum)]
        ask prey [set glucose_mass glucose_mass - (food_4 / num_prey)]
      ]
      [
        set Gr (-27.2900 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_ethanols ^ (1 / 4)) * (LCO2 ^ (1 / 4))) / (Initial_concentration_glucose ^ (1 / 8))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_4b energy_fs
        let fe_4b energy_fe

        let glucose_re_r_4b ((1 / 8) * 1000 * fe_4b)
        let NH4_rs_r_4b ((1 / 20) * 1000 * fs_4b)
        let HCO3_rs_r_4b ((1 / 20) * 1000 * fs_4b)
        let glucose_rs_r_4b ((1 / 24) * 1000 * fs_4b)

        let ethanol_re_p_4b ((1 / 4) * 1000 * fe_4b)
        let CO2s_re_p_4b ((1 / 4) * 1000 * fe_4b)
        let biomass_rs_p_4b ((1 / 20) * 1000 * fs_4b)
        let CO2_rs_p_4b ( (1 / 20) * 1000 * fs_4b)
        let H2O_rs_p_4b ((1 / 5) * 1000 * fs_4b)

        let H2O_sum_4b (H2O_rs_p_4b)
        let CO2_sum_4b (CO2s_re_p_4b + CO2_rs_p_4b)
        let HCO3_sum_4b (HCO3_rs_r_4b)
        let ethanol_sum_4b (ethanol_re_p_4b)
        let glucose_sum_4b (glucose_re_r_4b + glucose_rs_r_4b)
        let NH4_sum_4b (NH4_rs_r_4b)
        let biomass_sum_4b (biomass_rs_p_4b)

        set Bacteroidales_FB4_mass Bacteroidales_FB4_mass + ((sum [glucose_mass] of prey) / glucose_sum_4b * biomass_rs_p_4b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_4b * HCO3_sum_4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_4b * NH4_sum_4b)]
        hatch-ethanols 1 [set color brown set size 0.5 set ethanols_mass ethanols_mass + ((sum [glucose_mass] of prey) / glucose_sum_4b * ethanol_sum_4b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_4b  * CO2_sum_4b) right random 360 fd 2]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glucose_mass] of prey) / glucose_sum_4b  * H2O_sum_4b)]
        ask prey [die]
      ]
    ]
  ]
end

to reproduce_b_FB4
  if bacteroidales_FB4_mass > 1
  [
  set bacteroidales_FB4_mass (bacteroidales_FB4_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB4 3.4553
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB4
  set Bacteroidales_FB4_mass (Bacteroidales_FB4_mass - Bacteroidales_FB4_mass * (0.03 / 24)) ;; Represents decay rate per hour based on Vavilin et al., 2002.
end


;;;BACTEROIDALES FB5;;; For Equation 5

to FB5_b_eat_glucose;; Bacteroidal procedure ;; based on Clostridiales maximum uptake rate is up to 0.0207 mmol/mmmol h Clostridium aceticum based on Lin et al., 2007.
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_b_FB5
      [
        let food_5 min (list uptake_b_FB5 [glucose_mass] of prey)
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5 energy_fs
        let fe_5 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_5)
        let H2O_re_r ((1 / 12) * 1000 * fe_5)
        let NH4_rs_r ((1 / 20) * 1000 * fs_5)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_5)
        let glucose_rs_r ((1 / 24) * 1000 * fs_5)

        let acetate_re_p ((1 / 12) * 1000 * fe_5)
        let CO2s_re_p ((1 / 12) * 1000 * fe_5)
        let H2_re_p ((1 / 6) * 1000 * fe_5)
        let H+_re_p ((1 / 12) * 1000 * fe_5)
        let biomass_rs_p ((1 / 20) * 1000 * fs_5)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_5)
        let H2O_rs_p ((1 / 5) * 1000 * fs_5)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Bacteroidales_FB5_mass Bacteroidales_FB5_mass + (food_5 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_5 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_5 / glucose_sum * NH4_sum)]
        ask n-of 1 patches [set pcolor black set moles moles - (food_5 / glucose_sum * H2O_sum)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_5 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_5 / glucose_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_5 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_5 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_5 / num_prey)]
      ]
      [
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5b energy_fs
        let fe_5b energy_fe

        let glucose_re_r_5b ((1 / 24) * 1000 * fe_5b)
        let H2O_re_r_5b ((1 / 12) * 1000 * fe_5b)
        let NH4_rs_r_5b ((1 / 20) * 1000 * fs_5b)
        let HCO3_rs_r_5b ((1 / 20 )* 1000 * fs_5b)
        let glucose_rs_r_5b ((1 / 24) * 1000 * fs_5b)

        let acetate_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let CO2s_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let H2_re_p_5b ((1 / 6) * 1000 * fe_5b)
        let H+_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let biomass_rs_p_5b ((1 / 20) * 1000 * fs_5b)
        let CO2_rs_p_5b ( (1 / 20) * 1000 * fs_5b)
        let H2O_rs_p_5b ((1 / 5) * 1000 * fs_5b)

        let H2O_sum_5b (H2O_rs_p_5b - H2O_re_r_5b)
        let H2_sum_5b (H2_re_p_5b)
        let H+_sum_5b (H+_re_p_5b)
        let CO2_sum_5b (CO2s_re_p_5b + CO2_rs_p_5b)
        let HCO3_sum_5b (HCO3_rs_r_5b)
        let acetates_sum_5b (acetate_re_p_5b)
        let glucose_sum_5b (glucose_re_r_5b + glucose_rs_r_5b)
        let NH4_sum_5b (NH4_rs_r_5b)
        let biomass_sum_5b (biomass_rs_p_5b)

        set Bacteroidales_FB5_mass Bacteroidales_FB5_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * biomass_sum_5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey)  / glucose_sum_5b * HCO3_sum_5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * NH4_sum_5b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_5b * H2O_sum_5b)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * CO2_sum_5b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * acetates_sum_5b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H2_sum_5b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H+_sum_5b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB5
  if bacteroidales_FB5_mass > 1
  [
  set bacteroidales_FB5_mass (bacteroidales_FB5_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB5 0.0207
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB5
  set Bacteroidales_FB5_mass (Bacteroidales_FB5_mass - Bacteroidales_FB5_mass * (0.02 / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012
end

;;; BACTEROIDALES FB6;;; For Equation 6

to FB6_b_eat_glycine;; Bacteroidal procedure ;; based on Clostridial's maximum uptake rate is up to 1.08-7.35 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glycines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glycines_mass] of prey) > uptake_b_FB6
      [
        let food_6 min (list uptake_b_FB6 [glycines_mass] of prey)
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6 energy_fs
        let fe_6 energy_fe

        let glycine_re_r ( (1 / 2) * 1000 * fe_6)
        let H2_re_r ( (1 / 2) * 1000 * fe_6)
        let CO2_rs_r ((1 / 5) * 1000 * fs_6)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_6)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_6)
        let H2_rs_r ((1 / 2) * 1000 * fs_6)

        let acetate_re_p ( (1 / 2) * 1000 * fe_6)
        let NH3_re_p ((1 / 2) * 1000 * fe_6)
        let H+_re_p ((1 / 2) * 1000 * fe_6)
        let biomass_rs_p ((1 / 20) * 1000 * fs_6)
        let H2O_rs_p ((9 / 20) * 1000 * fs_6)

        let H2O_sum ( H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r )
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p)
        let biomass_sum (biomass_rs_p)
        let glycine_sum (glycine_re_r)

        set Bacteroidales_FB6_mass Bacteroidales_FB6_mass + (food_6 / glycine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_6 / glycine_sum * H2_sum)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_6 / glycine_sum * CO2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_6 / glycine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_6 / glycine_sum * NH4_sum)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_6 / glycine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_6 / glycine_sum * NH3_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_6 / glycine_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_6 / glycine_sum * H2O_sum)]
        ask prey [set glycines_mass glycines_mass - (food_6 / num_prey)]
      ]
      [
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6b energy_fs
        let fe_6b energy_fe

        let glycine_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let H2_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let CO2_rs_r_6b ((1 / 5) * 1000 * fs_6b)
        let NH4_rs_r_6b ( (1 / 20) * 1000 * fs_6b)
        let HCO3_rs_r_6b ((1 / 20) * 1000 * fs_6b)
        let H2_rs_r_6b ((1 / 2) * 1000 * fs_6b)

        let acetate_re_p_6b ( (1 / 2) * 1000 * fe_6b)
        let NH3_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let H+_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let biomass_rs_p_6b ((1 / 20) * 1000 * fs_6b)
        let H2O_rs_p_6b ((9 / 20) * 1000 * fs_6b)

        let H2O_sum_6b ( H2O_rs_p_6b )
        let H2_sum_6b (H2_re_r_6b + H2_rs_r_6b )
        let H+_sum_6b (H+_re_p_6b )
        let CO2_sum_6b (CO2_rs_r_6b)
        let HCO3_sum_6b (HCO3_rs_r_6b)
        let acetate_sum_6b (acetate_re_p_6b)
        let NH4_sum_6b (NH4_rs_r_6b)
        let NH3_sum_6b (NH3_re_p_6b)
        let biomass_sum_6b (biomass_rs_p_6b)
        let glycine_sum_6b (glycine_re_r_6b)

        set Bacteroidales_FB6_mass Bacteroidales_FB6_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * biomass_sum_6b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * H2_sum_6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * CO2_sum_6b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * HCO3_sum_6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * NH4_sum_6b)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * acetate_sum_6b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * NH3_sum_6b)right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * H+_sum_6b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glycines_mass] of prey) / glycine_sum_6b * H2O_sum_6b)]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB6
  if Bacteroidales_FB6_mass > 1
  [
  set Bacteroidales_FB6_mass (Bacteroidales_FB6_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB6 (1.08 + random-float 6.27)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB6
  set Bacteroidales_FB6_mass (Bacteroidales_FB6_mass - Bacteroidales_FB6_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;BACTEROIDALES FB7;;; For Equation 7

to FB7_b_eat_serine;; Bacteroidal procedure ;; based on Clostridial's maximum uptake rate is up to 1.08-4.412 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target serines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [serines_mass] of prey) > uptake_b_FB7
      [
        let food_7 min (list uptake_b_FB7 [serines_mass] of prey)
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7 energy_fs
        let fe_7 energy_fe

        let serine_re_r (( 1 / 10) * 1000 * fe_7)
        let H2O_re_r ( (1 / 10) * 1000 * fe_7)
        let serine_rs_r ((1 / 10) * 1000 * fs_7)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_7)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_7)

        let acetate_re_p ( (1 / 10) * 1000 * fe_7)
        let NH3_re_p ((1 / 10) * 1000 * fe_7)
        let CO2_re_p ((1 / 10) * 1000 * fe_7)
        let H2_re_p ((1 / 10) * 1000 * fe_7)
        let H+_re_p ((1 / 10) * 1000 * fe_7)
        let biomass_rs_p ((1 / 20) * 1000 * fs_7)
        let CO2_rs_p ((1 / 10) * 1000 * fs_7)
        let NH3_rs_p ((1 / 10) * 1000 * fs_7)
        let H2O_rs_p ((3 / 20) * 1000 * fs_7)

        let H2O_sum ( H2O_re_r + H2O_rs_p )
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let serine_sum (serine_re_r + serine_rs_r)

        set Bacteroidales_FB7_mass Bacteroidales_FB7_mass + (food_7 / serine_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_7 / serine_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_7 / serine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_7 / serine_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_7 / serine_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_7 / serine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_7 / serine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_7 / serine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_7 / serine_sum * NH3_sum) right random 360 fd 3]

        ask prey [set serines_mass serines_mass - (food_7 / num_prey)]
      ]
      [
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7b energy_fs
        let fe_7b energy_fe

        let serine_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let H2O_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let serine_rs_r_7b ((1 / 10) * 1000 * fs_7b)
        let NH4_rs_r_7b ( (1 / 20) * 1000 * fs_7b)
        let HCO3_rs_r_7b ((1 / 20) * 1000 * fs_7b)

        let acetate_re_p_7b (( 1 / 10) * 1000 * fe_7b)
        let NH3_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let CO2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H+_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let biomass_rs_p_7b ((1 / 20) * 1000 * fs_7b)
        let CO2_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let NH3_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let H2O_rs_p_7b ((3 / 20) * 1000 * fs_7b)

        let H2O_sum_7b ( H2O_re_r_7b + H2O_rs_p_7b )
        let H2_sum_7b (H2_re_p_7b)
        let H+_sum_7b (H+_re_p_7b )
        let CO2_sum_7b (CO2_re_p_7b + CO2_rs_p_7b)
        let HCO3_sum_7b (HCO3_rs_r_7b)
        let acetate_sum_7b (acetate_re_p_7b)
        let NH4_sum_7b (NH4_rs_r_7b)
        let NH3_sum_7b (NH3_re_p_7b + NH3_rs_p_7b)
        let biomass_sum_7b (biomass_rs_p_7b)
        let serine_sum_7b (serine_re_r_7b + serine_rs_r_7b)

        set Bacteroidales_FB7_mass Bacteroidales_FB7_mass + ((sum [serines_mass] of prey) / serine_sum_7b * biomass_sum_7b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [serines_mass] of prey) / serine_sum_7b * H2O_sum_7b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [serines_mass] of prey) / serine_sum_7b * HCO3_sum_7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [serines_mass] of prey) / serine_sum_7b * NH4_sum_7b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H2_sum_7b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H+_sum_7b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [serines_mass] of prey) / serine_sum_7b * CO2_sum_7b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [serines_mass] of prey) / serine_sum_7b * acetate_sum_7b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [serines_mass] of prey) / serine_sum_7b * NH3_sum_7b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB7
  if bacteroidales_FB7_mass > 1
  [
  set bacteroidales_FB7_mass (bacteroidales_FB7_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB7 (1.08 + random-float 3.332)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB7
  set Bacteroidales_FB7_mass (Bacteroidales_FB7_mass - Bacteroidales_FB7_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;BACTEROIDALES FB8;;; For Equation 8

to FB8_b_eat_threonine;; Bacteroidal procedure ;; based on Clostridial's maximum uptake rate is up to 1.08-2.757 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target threonines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [threonines_mass] of prey) > uptake_b_FB8
      [
        let food_8 min (list uptake_b_FB8 [threonines_mass] of prey)
        set Gr (-6.5252 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8 energy_fs
        let fe_8 energy_fe

        let threonine_re_r ( (1 / 18) * 1000 * fe_8)
        let H2_re_r ( (1 / 18) * 1000 * fe_8)
        let threonine_rs_r ((1 / 18) * 1000 * fs_8)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_8)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_8)
        let H2_rs_r ((1 / 18) * 1000 * fs_8)

        let acetate_re_p ( (1 / 18) * 1000 * fe_8)
        let butyrate_re_p ((1 / 36) * 1000 * fe_8)
        let NH3_re_p ((1 / 18) * 1000 * fe_8)
        let H+_re_p ((1 / 12) * 1000 * fe_8)
        let biomass_rs_p ((1 / 20) * 1000 * fs_8)
        let CO2_rs_p ((1 / 45) * 1000 * fs_8)
        let NH3_rs_p ((1 / 18) * 1000 * fs_8)
        let H2O_rs_p ((31 / 180) * 1000 * fs_8)

        let H2O_sum (H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let butyrate_sum (butyrate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let threonine_sum (threonine_re_r + threonine_rs_r)

        set Bacteroidales_FB8_mass Bacteroidales_FB8_mass + (food_8 / threonine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_8 / threonine_sum * H2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_8 / threonine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_8 / threonine_sum * NH4_sum)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_8 / threonine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_8 / threonine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_8 / threonine_sum * acetate_sum) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_8 / threonine_sum * butyrate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_8 / threonine_sum * NH3_sum) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_8 / threonine_sum * H2O_sum)]

        ask prey [set threonines_mass threonines_mass - (food_8 / num_prey)]
      ]
      [
        set Gr (-6.5261 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8b energy_fs
        let fe_8b energy_fe

        let threonine_re_r_8b ( (1 / 18) * 1000 * fe_8b)
        let H2_re_r_8b ( (1 / 18) * 1000 * fe_8b)
        let threonine_rs_r_8b ((1 / 18) * 1000 * fs_8b)
        let NH4_rs_r_8b ( (1 / 20) * 1000 * fs_8b)
        let HCO3_rs_r_8b ((1 / 20) * 1000 * fs_8b)
        let H2_rs_r_8b ((1 / 18) * 1000 * fs_8b)

        let acetate_re_p_8b ( (1 / 18) * 1000 * fe_8b)
        let butyrate_re_p_8b ((1 / 36) * 1000 * fe_8b)
        let NH3_re_p_8b ((1 / 18) * 1000 * fe_8b)
        let H+_re_p_8b ((1 / 12) * 1000 * fe_8b)
        let biomass_rs_p_8b ((1 / 20) * 1000 * fs_8b)
        let CO2_rs_p_8b ((1 / 45) * 1000 * fs_8b)
        let NH3_rs_p_8b ((1 / 18) * 1000 * fs_8b)
        let H2O_rs_p_8b ((31 / 180) * 1000 * fs_8b)

        let H2O_sum_8b (H2O_rs_p_8b )
        let H2_sum_8b (H2_re_r_8b + H2_rs_r_8b)
        let H+_sum_8b (H+_re_p_8b )
        let CO2_sum_8b (CO2_rs_p_8b)
        let HCO3_sum_8b (HCO3_rs_r_8b)
        let acetate_sum_8b (acetate_re_p_8b)
        let butyrate_sum_8b (butyrate_re_p_8b)
        let NH4_sum_8b (NH4_rs_r_8b)
        let NH3_sum_8b (NH3_re_p_8b + NH3_rs_p_8b)
        let biomass_sum_8b (biomass_rs_p_8b)
        let threonine_sum_8b (threonine_re_r_8b + threonine_rs_r_8b)

        set Bacteroidales_FB8_mass Bacteroidales_FB8_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * biomass_sum_8b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * H2_sum_8b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * HCO3_sum_8b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * NH4_sum_8b)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * H+_sum_8b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * CO2_sum_8b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * acetate_sum_8b) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * butyrate_sum_8b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * NH3_sum_8b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [threonines_mass] of prey) / threonine_sum_8b * H2O_sum_8b)]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_b_FB8
  if Bacteroidales_FB8_mass > 1
  [
  set Bacteroidales_FB8_mass (Bacteroidales_FB8_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_b_FB8 (1.08 + random-float 1.677)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_b_FB8
  set Bacteroidales_FB8_mass (Bacteroidales_FB8_mass - Bacteroidales_FB8_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end



;;; THERMOTOGALES ;;;;

;;;THERMOTOGALES FB5;;; For Equation 5

to FB5_t_eat_glucose;; Thermotogal procedure ;; based on Clostridiales maximum uptake rate is up to 0.0207 mmol/mmmol h Clostridium aceticum based on Lin et al., 2007.
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_t_FB5
      [
        let food_5 min (list uptake_t_FB5 [glucose_mass] of prey)
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5 energy_fs
        let fe_5 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_5)
        let H2O_re_r ((1 / 12) * 1000 * fe_5)
        let NH4_rs_r ((1 / 20) * 1000 * fs_5)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_5)
        let glucose_rs_r ((1 / 24) * 1000 * fs_5)

        let acetate_re_p ((1 / 12) * 1000 * fe_5)
        let CO2s_re_p ((1 / 12) * 1000 * fe_5)
        let H2_re_p ((1 / 6) * 1000 * fe_5)
        let H+_re_p ((1 / 12) * 1000 * fe_5)
        let biomass_rs_p ((1 / 20) * 1000 * fs_5)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_5)
        let H2O_rs_p ((1 / 5) * 1000 * fs_5)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set Thermotogales_FB5_mass Thermotogales_FB5_mass + (food_5 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_5 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_5 / glucose_sum * NH4_sum)]
        ask n-of 1 patches [set pcolor black set moles moles - (food_5 / glucose_sum * H2O_sum)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_5 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_5 / glucose_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_5 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_5 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_5 / num_prey)]
      ]
      [
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5b energy_fs
        let fe_5b energy_fe

        let glucose_re_r_5b ((1 / 24) * 1000 * fe_5b)
        let H2O_re_r_5b ((1 / 12) * 1000 * fe_5b)
        let NH4_rs_r_5b ((1 / 20 )* 1000 * fs_5b)
        let HCO3_rs_r_5b ((1 / 20) * 1000 * fs_5b)
        let glucose_rs_r_5b ((1 / 24) * 1000 * fs_5b)

        let acetate_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let CO2s_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let H2_re_p_5b ((1 / 6) * 1000 * fe_5b)
        let H+_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let biomass_rs_p_5b ((1 / 20) * 1000 * fs_5b)
        let CO2_rs_p_5b ( (1 / 20) * 1000 * fs_5b)
        let H2O_rs_p_5b ((1 / 5) * 1000 * fs_5b)

        let H2O_sum_5b (H2O_rs_p_5b - H2O_re_r_5b)
        let H2_sum_5b (H2_re_p_5b)
        let H+_sum_5b (H+_re_p_5b)
        let CO2_sum_5b (CO2s_re_p_5b + CO2_rs_p_5b)
        let HCO3_sum_5b (HCO3_rs_r_5b)
        let acetates_sum_5b (acetate_re_p_5b)
        let glucose_sum_5b (glucose_re_r_5b + glucose_rs_r_5b)
        let NH4_sum_5b (NH4_rs_r_5b)
        let biomass_sum_5b (biomass_rs_p_5b)

        set Thermotogales_FB5_mass Thermotogales_FB5_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * biomass_sum_5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * HCO3_sum_5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey)  / glucose_sum_5b * NH4_sum_5b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_5b * H2O_sum_5b)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * CO2_sum_5b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * acetates_sum_5b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H2_sum_5b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H+_sum_5b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB5
  if thermotogales_FB5_mass > 1
  [
  set thermotogales_FB5_mass (thermotogales_FB5_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB5 0.0207
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB5
  set thermotogales_FB5_mass (thermotogales_FB5_mass - thermotogales_FB5_mass * (0.02 / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; THERMOTOGALES FB6;;; For Equation 6

to FB6_t_eat_glycine;; Thermotogal procedure ;; Clostridial's maximum uptake rate is up to 1.08-7.35 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glycines in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glycines_mass] of prey) > uptake_t_FB6
      [
        let food_6 min (list uptake_t_FB6 [glycines_mass] of prey)
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6 energy_fs
        let fe_6 energy_fe

        let glycine_re_r ( (1 / 2) * 1000 * fe_6)
        let H2_re_r ( (1 / 2) * 1000 * fe_6)
        let CO2_rs_r ((1 / 5) * 1000 * fs_6)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_6)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_6)
        let H2_rs_r ((1 / 2) * 1000 * fs_6)

        let acetate_re_p ( (1 / 2) * 1000 * fe_6)
        let NH3_re_p ((1 / 2) * 1000 * fe_6)
        let H+_re_p ((1 / 2) * 1000 * fe_6)
        let biomass_rs_p ((1 / 20) * 1000 * fs_6)
        let H2O_rs_p ((9 / 20) * 1000 * fs_6)

        let H2O_sum ( H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r )
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p)
        let biomass_sum (biomass_rs_p)
        let glycine_sum (glycine_re_r)

        set thermotogales_FB6_mass thermotogales_FB6_mass + (food_6 / glycine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_6 / glycine_sum * H2_sum)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_6 / glycine_sum * CO2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_6 / glycine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_6 / glycine_sum * NH4_sum)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_6 / glycine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_6 / glycine_sum * NH3_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_6 / glycine_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_6 / glycine_sum * H2O_sum)]
        ask prey [set glycines_mass glycines_mass - (food_6 / num_prey)]
      ]
      [
        set Gr (-32.5310 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (Initial_concentration_ammonia ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 2))) / ((Initial_concentration_glycines ^ (1 / 2)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_6b energy_fs
        let fe_6b energy_fe

        let glycine_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let H2_re_r_6b ( (1 / 2) * 1000 * fe_6b)
        let CO2_rs_r_6b ((1 / 5) * 1000 * fs_6b)
        let NH4_rs_r_6b ( (1 / 20) * 1000 * fs_6b)
        let HCO3_rs_r_6b ((1 / 20) * 1000 * fs_6b)
        let H2_rs_r_6b ((1 / 2) * 1000 * fs_6b)

        let acetate_re_p_6b (( 1 / 2) * 1000 * fe_6b)
        let NH3_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let H+_re_p_6b ((1 / 2) * 1000 * fe_6b)
        let biomass_rs_p_6b ((1 / 20) * 1000 * fs_6b)
        let H2O_rs_p_6b ((9 / 20) * 1000 * fs_6b)

        let H2O_sum_6b ( H2O_rs_p_6b )
        let H2_sum_6b (H2_re_r_6b + H2_rs_r_6b )
        let H+_sum_6b (H+_re_p_6b )
        let CO2_sum_6b (CO2_rs_r_6b)
        let HCO3_sum_6b (HCO3_rs_r_6b)
        let acetate_sum_6b (acetate_re_p_6b)
        let NH4_sum_6b (NH4_rs_r_6b)
        let NH3_sum_6b (NH3_re_p_6b)
        let biomass_sum_6b (biomass_rs_p_6b)
        let glycine_sum_6b (glycine_re_r_6b)

        set thermotogales_FB6_mass thermotogales_FB6_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * biomass_sum_6b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * H2_sum_6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * CO2_sum_6b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * HCO3_sum_6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glycines_mass] of prey) / glycine_sum_6b * NH4_sum_6b)]

        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * acetate_sum_6b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * NH3_sum_6b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glycines_mass] of prey) / glycine_sum_6b * H+_sum_6b)right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [glycines_mass] of prey) / glycine_sum_6b * H2O_sum_6b)]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB6
  if Thermotogales_FB6_mass > 1
  [
  set Thermotogales_FB6_mass (Thermotogales_FB6_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB6 (1.08 + random-float 6.27)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB6
  set Thermotogales_FB6_mass (Thermotogales_FB6_mass - Thermotogales_FB6_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;THERMOTOGALES FB7;;; For Equation 7

to FB7_t_eat_serine;; Thermotogal procedure ;; Clostridial's maximum uptake rate is up to 1.08-4.412 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target serines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [serines_mass] of prey) > uptake_t_FB7
      [
        let food_7 min (list uptake_t_FB7 [serines_mass] of prey)
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7 energy_fs
        let fe_7 energy_fe

        let serine_re_r ( (1 / 10) * 1000 * fe_7)
        let H2O_re_r ( (1 / 10) * 1000 * fe_7)
        let serine_rs_r ((1 / 10) * 1000 * fs_7)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_7)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_7)

        let acetate_re_p ( (1 / 10) * 1000 * fe_7)
        let NH3_re_p ((1 / 10) * 1000 * fe_7)
        let CO2_re_p ((1 / 10) * 1000 * fe_7)
        let H2_re_p ((1 / 10) * 1000 * fe_7)
        let H+_re_p ((1 / 10) * 1000 * fe_7)
        let biomass_rs_p ((1 / 20) * 1000 * fs_7)
        let CO2_rs_p ((1 / 10) * 1000 * fs_7)
        let NH3_rs_p ((1 / 10) * 1000 * fs_7)
        let H2O_rs_p ((3 / 20) * 1000 * fs_7)

        let H2O_sum ( H2O_re_r + H2O_rs_p )
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let serine_sum (serine_re_r + serine_rs_r)

        set Thermotogales_FB7_mass Thermotogales_FB7_mass + (food_7 / serine_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_7 / serine_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_7 / serine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_7 / serine_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_7 / serine_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_7 / serine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_7 / serine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_7 / serine_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_7 / serine_sum * NH3_sum) right random 360 fd 3]

        ask prey [set serines_mass serines_mass - (food_7 / num_prey)]
      ]
      [
        set Gr (-7.3822 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 10)) * (Initial_concentration_ammonia ^ (1 / 10)) * (Initial_concentration_CO2s ^ (1 / 10)) * (LH2 ^ (1 / 10)) * ((10 ^ -4) ^ (1 / 10))) / ((Initial_concentration_serines ^ (1 / 10)) * (1 ^ (1 / 10)))))
        set energy_fs 1 / (1 + abs((((23.0591 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_7b energy_fs
        let fe_7b energy_fe

        let serine_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let H2O_re_r_7b ( (1 / 10) * 1000 * fe_7b)
        let serine_rs_r_7b ((1 / 10) * 1000 * fs_7b)
        let NH4_rs_r_7b ( (1 / 20) * 1000 * fs_7b)
        let HCO3_rs_r_7b ((1 / 20) * 1000 * fs_7b)

        let acetate_re_p_7b ( (1 / 10) * 1000 * fe_7b)
        let NH3_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let CO2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H2_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let H+_re_p_7b ((1 / 10) * 1000 * fe_7b)
        let biomass_rs_p_7b ((1 / 20) * 1000 * fs_7b)
        let CO2_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let NH3_rs_p_7b ((1 / 10) * 1000 * fs_7b)
        let H2O_rs_p_7b ((3 / 20) * 1000 * fs_7b)

        let H2O_sum_7b ( H2O_re_r_7b + H2O_rs_p_7b )
        let H2_sum_7b (H2_re_p_7b)
        let H+_sum_7b (H+_re_p_7b )
        let CO2_sum_7b (CO2_re_p_7b + CO2_rs_p_7b)
        let HCO3_sum_7b (HCO3_rs_r_7b)
        let acetate_sum_7b (acetate_re_p_7b)
        let NH4_sum_7b (NH4_rs_r_7b)
        let NH3_sum_7b (NH3_re_p_7b + NH3_rs_p_7b)
        let biomass_sum_7b (biomass_rs_p_7b)
        let serine_sum_7b (serine_re_r_7b + serine_rs_r_7b)

        set Thermotogales_FB7_mass Thermotogales_FB7_mass + ((sum [serines_mass] of prey) / serine_sum_7b * biomass_sum_7b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [serines_mass] of prey)/ serine_sum_7b * H2O_sum_7b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [serines_mass] of prey) / serine_sum_7b * HCO3_sum_7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [serines_mass] of prey) / serine_sum_7b * NH4_sum_7b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H2_sum_7b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [serines_mass] of prey) / serine_sum_7b * H+_sum_7b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [serines_mass] of prey) / serine_sum_7b * CO2_sum_7b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [serines_mass] of prey) / serine_sum_7b * acetate_sum_7b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [serines_mass] of prey) / serine_sum_7b * NH3_sum_7b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB7
  if thermotogales_FB7_mass > 1
  [
  set thermotogales_FB7_mass (thermotogales_FB7_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB7 (1.08 + random-float 3.332)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB7
  set Thermotogales_FB7_mass (Thermotogales_FB7_mass - Thermotogales_FB7_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;THERMOTOGALES FB8;;; For Equation 8

to FB8_t_eat_threonine;; Thermotogal procedure ;; Clostridial's maximum uptake rate is up to 1.08-2.757 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target threonines in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [threonines_mass] of prey) > uptake_t_FB8
      [
        let food_8 min (list uptake_t_FB8 [threonines_mass] of prey)
        set Gr (-6.5252 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8 energy_fs
        let fe_8 energy_fe

        let threonine_re_r ( (1 / 18) * 1000 * fe_8)
        let H2_re_r ( (1 / 18) * 1000 * fe_8)
        let threonine_rs_r ((1 / 18) * 1000 * fs_8)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_8)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_8)
        let H2_rs_r ((1 / 18) * 1000 * fs_8)

        let acetate_re_p ( (1 / 18) * 1000 * fe_8)
        let butyrate_re_p ((1 / 36) * 1000 * fe_8)
        let NH3_re_p ((1 / 18) * 1000 * fe_8)
        let H+_re_p ((1 / 12) * 1000 * fe_8)
        let biomass_rs_p ((1 / 20) * 1000 * fs_8)
        let CO2_rs_p ((1 / 45) * 1000 * fs_8)
        let NH3_rs_p ((1 / 18) * 1000 * fs_8)
        let H2O_rs_p ((31 / 180) * 1000 * fs_8)

        let H2O_sum (H2O_rs_p )
        let H2_sum (H2_re_r + H2_rs_r)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let butyrate_sum (butyrate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let threonine_sum (threonine_re_r + threonine_rs_r)

        set Thermotogales_FB8_mass Thermotogales_FB8_mass + (food_8 / threonine_sum * biomass_sum)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - (food_8 / threonine_sum * H2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_8 / threonine_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_8 / threonine_sum * NH4_sum)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_8 / threonine_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_8 / threonine_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_8 / threonine_sum * acetate_sum) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_8 / threonine_sum * butyrate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_8 / threonine_sum * NH3_sum) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_8 / threonine_sum * H2O_sum)]

        ask prey [set threonines_mass threonines_mass - (food_8 / num_prey)]
      ]
      [
        set Gr (-6.5261 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_threonines ^ (1 / 18)) * (LH2 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((2.436 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_8b energy_fs
        let fe_8b energy_fe

        let threonine_re_r_8b ( (1 / 18) * 1000 * fe_8b)
        let H2_re_r_8b ( (1 / 18) * 1000 * fe_8b)
        let threonine_rs_r_8b ((1 / 18) * 1000 * fs_8b)
        let NH4_rs_r_8b ( (1 / 20) * 1000 * fs_8b)
        let HCO3_rs_r_8b ((1 / 20) * 1000 * fs_8b)
        let H2_rs_r_8b ((1 / 18) * 1000 * fs_8b)

        let acetate_re_p_8b ( (1 / 18) * 1000 * fe_8b)
        let butyrate_re_p_8b ((1 / 36) * 1000 * fe_8b)
        let NH3_re_p_8b ((1 / 18) * 1000 * fe_8b)
        let H+_re_p_8b ((1 / 12) * 1000 * fe_8b)
        let biomass_rs_p_8b ((1 / 20) * 1000 * fs_8b)
        let CO2_rs_p_8b ((1 / 45) * 1000 * fs_8b)
        let NH3_rs_p_8b ((1 / 18) * 1000 * fs_8b)
        let H2O_rs_p_8b ((31 / 180) * 1000 * fs_8b)

        let H2O_sum_8b (H2O_rs_p_8b )
        let H2_sum_8b (H2_re_r_8b + H2_rs_r_8b)
        let H+_sum_8b (H+_re_p_8b )
        let CO2_sum_8b (CO2_rs_p_8b)
        let HCO3_sum_8b (HCO3_rs_r_8b)
        let acetate_sum_8b (acetate_re_p_8b)
        let butyrate_sum_8b (butyrate_re_p_8b)
        let NH4_sum_8b (NH4_rs_r_8b)
        let NH3_sum_8b (NH3_re_p_8b + NH3_rs_p_8b)
        let biomass_sum_8b (biomass_rs_p_8b)
        let threonine_sum_8b (threonine_re_r_8b + threonine_rs_r_8b)

        set Thermotogales_FB8_mass Thermotogales_FB8_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * biomass_sum_8b)
        ask one-of hydrogens [set hydrogens_mass hydrogens_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * H2_sum_8b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * HCO3_sum_8b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [threonines_mass] of prey) / threonine_sum_8b * NH4_sum_8b)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * H+_sum_8b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * CO2_sum_8b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * acetate_sum_8b) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * butyrate_sum_8b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [threonines_mass] of prey) / threonine_sum_8b * NH3_sum_8b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [threonines_mass] of prey) / threonine_sum_8b * H2O_sum_8b)]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB8
  if Thermotogales_FB8_mass > 1
  [
  set Thermotogales_FB8_mass (Thermotogales_FB8_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB8 (1.08 + random-float 1.677)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB8
  set Thermotogales_FB8_mass (Thermotogales_FB8_mass - Thermotogales_FB8_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;THERMOTOGALES FB9;;; For Equation 9

to FB9_t_eat_aspartate;; Thermotogal procedure ;; Clostridial's maximum uptake rate is up to 1.08-3.677 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target aspartates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [aspartates_mass] of prey) > uptake_t_FB9
      [
        let food_9 min (list uptake_t_FB9 [aspartates_mass] of prey)
        set Gr (-2.7612 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (Initial_concentration_CO2s ^ (1 / 6)) * (Initial_concentration_ammonia ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_aspartates ^ (1 / 12)) * (1 ^ (1 / 6)))))
        set energy_fs 1 / (1 + abs((((18.4243 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_9 energy_fs
        let fe_9 energy_fe

        let aspartate_re_r ( (1 / 12) * 1000 * fe_9)
        let H2O_re_r ( (1 / 6) * 1000 * fe_9)
        let aspartate_rs_r ((1 / 12) * 1000 * fs_9)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_9)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_9)

        let acetate_re_p ( (1 / 12) * 1000 * fe_9)
        let CO2s_re_p ((1 / 6) * 1000 * fe_9)
        let NH3_re_p ((1 / 12) * 1000 * fe_9)
        let H2_re_p ((1 / 6) * 1000 * fe_9)
        let H+_re_p ((1 / 12) * 1000 * fe_9)
        let biomass_rs_p ((1 / 20) * 1000 * fs_9)
        let NH3_rs_p ((1 / 12) * 1000 * fs_9)
        let CO2_rs_p ((2 / 15 )* 1000 * fs_9)
        let H2O_rs_p ((7 / 60 )* 1000 * fs_9)

        let H2O_sum (H2O_re_r + H2O_rs_p )
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p )
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let aspartate_sum (aspartate_re_r + aspartate_rs_r)

        set Thermotogales_FB9_mass Thermotogales_FB9_mass + (food_9 / aspartate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_9 / aspartate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_9 / aspartate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_9 / aspartate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_9 / aspartate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_9 / aspartate_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_9 / aspartate_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_9 / aspartate_sum * acetate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_9 / aspartate_sum * NH3_sum) right random 360 fd 3]

        ask prey [set aspartates_mass aspartates_mass - (food_9 / num_prey)]
      ]
      [
        set Gr (-2.7612 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (Initial_concentration_CO2s ^ (1 / 6)) * (Initial_concentration_ammonia ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_aspartates ^ (1 / 12)) * (1 ^ (1 / 6)))))
        set energy_fs 1 / (1 + abs((((18.4243 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_9b energy_fs
        let fe_9b energy_fe

        let aspartate_re_r_9b ( (1 / 12) * 1000 * fe_9b)
        let H2O_re_r_9b ( (1 / 6) * 1000 * fe_9b)
        let aspartate_rs_r_9b ((1 / 12) * 1000 * fs_9b)
        let NH4_rs_r_9b (( 1 / 20) * 1000 * fs_9b)
        let HCO3_rs_r_9b ((1 / 20) * 1000 * fs_9b)

        let acetate_re_p_9b ( (1 / 12) * 1000 * fe_9b)
        let CO2s_re_p_9b ((1 / 6) * 1000 * fe_9b)
        let NH3_re_p_9b ((1 / 12) * 1000 * fe_9b)
        let H2_re_p_9b ((1 / 6) * 1000 * fe_9b)
        let H+_re_p_9b ((1 / 12) * 1000 * fe_9b)
        let biomass_rs_p_9b ((1 / 20) * 1000 * fs_9b)
        let NH3_rs_p_9b ((1 / 12) * 1000 * fs_9b)
        let CO2_rs_p_9b ((2 / 15) * 1000 * fs_9b)
        let H2O_rs_p_9b ((7 / 60) * 1000 * fs_9b)

        let H2O_sum_9b (H2O_re_r_9b + H2O_rs_p_9b )
        let H2_sum_9b (H2_re_p_9b)
        let H+_sum_9b (H+_re_p_9b )
        let CO2_sum_9b (CO2s_re_p_9b + CO2_rs_p_9b)
        let HCO3_sum_9b (HCO3_rs_r_9b)
        let acetate_sum_9b (acetate_re_p_9b)
        let NH4_sum_9b (NH4_rs_r_9b)
        let NH3_sum_9b (NH3_re_p_9b + NH3_rs_p_9b)
        let biomass_sum_9b (biomass_rs_p_9b)
        let aspartate_sum_9b (aspartate_re_r_9b + aspartate_rs_r_9b)

        set Thermotogales_FB9_mass Thermotogales_FB9_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * biomass_sum_9b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [aspartates_mass] of prey) / aspartate_sum_9b * H2O_sum_9b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [aspartates_mass] of prey) / aspartate_sum_9b * HCO3_sum_9b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [aspartates_mass] of prey) / aspartate_sum_9b * NH4_sum_9b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * H2_sum_9b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * H+_sum_9b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * CO2_sum_9b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * acetate_sum_9b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [aspartates_mass] of prey) / aspartate_sum_9b * NH3_sum_9b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB9
  if thermotogales_FB9_mass > 1
  [
  set thermotogales_FB9_mass (thermotogales_FB9_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB9 (1.08 + random-float 2.597)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB9
  set Thermotogales_FB9_mass (Thermotogales_FB9_mass - Thermotogales_FB9_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;;THERMOTOGALES FB10;;; For Equation 10

to FB10_t_eat_glutamic;; Thermotogal procedure ;; Clostridial's maximum uptake rate is up to 1.08-2.451 mmol/mmmol h based on Batstone, 2002 and Ramsay, 1997
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glutamics in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glutamics_mass] of prey) > uptake_t_FB10
      [
        let food_10 min (list uptake_t_FB10 [glutamics_mass] of prey)
        set Gr (-3.1746 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * (Initial_concentration_CO2s ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_glutamics ^ (1 / 18)) * (1 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((5.7870 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_10 energy_fs
        let fe_10 energy_fe

        let glutamic_re_r ( (1 / 18) * 1000 * fe_10)
        let H2O_re_r ( (1 / 18) * 1000 * fe_10)
        let glutamic_rs_r ((18 / 12) * 1000 * fs_10)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_10)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_10)

        let acetate_re_p ( (1 / 18) * 1000 * fe_10)
        let butyrate_re_p ((1 / 36) * 1000 * fe_10)
        let NH3_re_p ((1 / 18) * 1000 * fe_10)
        let CO2s_re_p ((1 / 18) * 1000 * fe_10)
        let H+_re_p ((1 / 12) * 1000 * fe_10)
        let biomass_rs_p ((1 / 20) * 1000 * fs_10)
        let NH3_rs_p ((1 / 18) * 1000 * fs_10)
        let CO2_rs_p ((7 / 90) * 1000 * fs_10)
        let H2O_rs_p ((7 / 60) * 1000 * fs_10)

        let H2O_sum (H2O_re_r + H2O_rs_p )
        let H+_sum (H+_re_p )
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let butyrate_sum (butyrate_re_p)
        let NH4_sum (NH4_rs_r)
        let NH3_sum (NH3_re_p + NH3_rs_p)
        let biomass_sum (biomass_rs_p)
        let glutamic_sum (glutamic_re_r + glutamic_rs_r)

        set Thermotogales_FB10_mass Thermotogales_FB10_mass + (food_10 / glutamic_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_10 / glutamic_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_10 / glutamic_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_10 / glutamic_sum * NH4_sum)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_10 / glutamic_sum * H+_sum) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_10 / glutamic_sum * CO2_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_10 / glutamic_sum * acetate_sum) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + (food_10 / glutamic_sum * butyrate_sum) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + (food_10 / glutamic_sum * NH3_sum) right random 360 fd 3]

        ask prey [set glutamics_mass glutamics_mass - (food_10 / num_prey)]
      ]
      [
        set Gr (-3.1746 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 18)) * (Initial_concentration_butyrates ^ (1 / 36)) * (Initial_concentration_ammonia ^ (1 / 18)) * (Initial_concentration_CO2s ^ (1 / 18)) * ((10 ^ -4) ^ (1 / 12))) / ((Initial_concentration_glutamics ^ (1 / 18)) * (1 ^ (1 / 18)))))
        set energy_fs 1 / (1 + abs((((5.7870 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_10b energy_fs
        let fe_10b energy_fe

        let glutamic_re_r_10b ( (1 / 18) * 1000 * fe_10b)
        let H2O_re_r_10b ( (1 / 18) * 1000 * fe_10b)
        let glutamic_rs_r_10b ((18 / 12) * 1000 * fs_10b)
        let NH4_rs_r_10b ( (1 / 20) * 1000 * fs_10b)
        let HCO3_rs_r_10b ((1 / 20) * 1000 * fs_10b)

        let acetate_re_p_10b ( (1 / 18) * 1000 * fe_10b)
        let butyrate_re_p_10b ((1 / 36) * 1000 * fe_10b)
        let NH3_re_p_10b ((1 / 18) * 1000 * fe_10b)
        let CO2s_re_p_10b ((1 / 18) * 1000 * fe_10b)
        let H+_re_p_10b ((1 / 12) * 1000 * fe_10b)
        let biomass_rs_p_10b ((1 / 20) * 1000 * fs_10b)
        let NH3_rs_p_10b ((1 / 18) * 1000 * fs_10b)
        let CO2_rs_p_10b ((7 / 90) * 1000 * fs_10b)
        let H2O_rs_p_10b ((7 / 60) * 1000 * fs_10b)

        let H2O_sum_10b (H2O_re_r_10b + H2O_rs_p_10b )
        let H+_sum_10b (H+_re_p_10b )
        let CO2_sum_10b (CO2s_re_p_10b + CO2_rs_p_10b)
        let HCO3_sum_10b (HCO3_rs_r_10b)
        let acetate_sum_10b (acetate_re_p_10b)
        let butyrate_sum_10b (butyrate_re_p_10b)
        let NH4_sum_10b (NH4_rs_r_10b)
        let NH3_sum_10b (NH3_re_p_10b + NH3_rs_p_10b)
        let biomass_sum_10b (biomass_rs_p_10b)
        let glutamic_sum_10b (glutamic_re_r_10b + glutamic_rs_r_10b)

        set Thermotogales_FB10_mass Thermotogales_FB10_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * biomass_sum_10b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glutamics_mass] of prey)  / glutamic_sum_10b * H2O_sum_10b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glutamics_mass] of prey) / glutamic_sum_10b * HCO3_sum_10b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glutamics_mass] of prey) / glutamic_sum_10b * NH4_sum_10b)]

        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * H+_sum_10b) right random 360 fd 4]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * CO2_sum_10b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * acetate_sum_10b) rt random 360 fd 1]
        hatch-butyrates 1 [set color turquoise set size 0.5 set butyrates_mass butyrates_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * butyrate_sum_10b) rt random 360 fd 1]
        hatch-ammonia 1 [set color lime set size 0.5 set ammonia_mass ammonia_mass + ((sum [glutamics_mass] of prey) / glutamic_sum_10b * NH3_sum_10b) right random 360 fd 3]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_t_FB10
  if thermotogales_FB10_mass > 1
  [
  set thermotogales_FB10_mass (thermotogales_FB10_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_t_FB10 (1.08 + random-float 1.371)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_t_FB10
  set Thermotogales_FB10_mass (Thermotogales_FB10_mass - Thermotogales_FB10_mass * ((0.02 ) / 24)) ;; Represents decay rate per hour based on Antonopoulou et al., 2012.
end

;;; SYNTROPHOMONAS ;;;

;;;SYNTROPHOMONAS AC11;;; For Equation 11

to AC11_s_eat_myristate;; Syntrophomonas procedure ;; maximum uptake rate is up to 0.0197 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
  if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target myristates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [myristates_mass] of prey) > uptake_s_AC11
      [
        let food_11 min (list uptake_s_AC11 [myristates_mass] of prey)
        set Gr (15.5053 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (7 / 24)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_myristates ^ (1 / 24)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.7300 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_11 energy_fs
        let fe_11 energy_fe

        let myristate_re_r ( (1 / 24) * 1000 * fe_11)
        let H2O_re_r ( (1 / 2) * 1000 * fe_11)
        let CO2_rs_r ((1 / 5) * 1000 * fs_11)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_11)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_11)
        let myristate_rs_r ((1 / 24) * 1000 * fs_11)
        let H2O_rs_r ((1 / 20) * 1000 * fs_11)

        let acetate_re_p ( (7 / 24) * 1000 * fe_11)
        let H+_re_p ((1 / 4) * 1000 * fe_11)
        let H2_re_p ((1 / 2) * 1000 * fe_11)
        let biomass_rs_p ((1 / 20) * 1000 * fs_11)
        let acetate_rs_p ((7 / 24) * 1000 * fs_11)
        let H+_rs_p ((1 / 4) * 1000 * fs_11)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let myristate_sum (myristate_re_r + myristate_rs_r)

        set syntrophomonas_AC11_mass syntrophomonas_AC11_mass + (food_11 / myristate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_11 / myristate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_11 / myristate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_11 / myristate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_11 / myristate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_11 / myristate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_11 / myristate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_11 / myristate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set myristates_mass myristates_mass - (food_11 / num_prey)]
      ]
      [
        set Gr (15.5053 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (7 / 24)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_myristates ^ (1 / 24)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.7300 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_11b energy_fs
        let fe_11b energy_fe

        let myristate_re_r_11b (( 1 / 24) * 1000 * fe_11b)
        let H2O_re_r_11b ( (1 / 2) * 1000 * fe_11b)
        let CO2_rs_r_11b ((1 / 5) * 1000 * fs_11b)
        let NH4_rs_r_11b ( (1 / 20) * 1000 * fs_11b)
        let HCO3_rs_r_11b ((1 / 20) * 1000 * fs_11b)
        let myristate_rs_r_11b ((1 / 24) * 1000 * fs_11b)
        let H2O_rs_r_11b ((1 / 20) * 1000 * fs_11b)

        let acetate_re_p_11b (( 7 / 24) * 1000 * fe_11b)
        let H+_re_p_11b ((1 / 4) * 1000 * fe_11b)
        let H2_re_p_11b ((1 / 2) * 1000 * fe_11b)
        let biomass_rs_p_11b ((1 / 20) * 1000 * fs_11b)
        let acetate_rs_p_11b ((7 / 24) * 1000 * fs_11b)
        let H+_rs_p_11b ((1 / 4) * 1000 * fs_11b)

        let H2O_sum_11b (H2O_re_r_11b + H2O_rs_r_11b)
        let H2_sum_11b (H2_re_p_11b)
        let H+_sum_11b (H+_re_p_11b + H+_rs_p_11b)
        let CO2_sum_11b (CO2_rs_r_11b)
        let HCO3_sum_11b (HCO3_rs_r_11b)
        let acetate_sum_11b (acetate_re_p_11b + acetate_rs_p_11b)
        let NH4_sum_11b (NH4_rs_r_11b)
        let biomass_sum_11b (biomass_rs_p_11b)
        let myristate_sum_11b (myristate_re_r_11b + myristate_rs_r_11b)

        set syntrophomonas_AC11_mass syntrophomonas_AC11_mass + ((sum [myristates_mass] of prey) / myristate_sum_11b * biomass_sum_11b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [myristates_mass] of prey) / myristate_sum_11b * H2O_sum_11b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [myristates_mass] of prey) / myristate_sum_11b * Co2_sum_11b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [myristates_mass] of prey) / myristate_sum_11b * HCO3_sum_11b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [myristates_mass] of prey) / myristate_sum_11b * NH4_sum_11b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [myristates_mass] of prey) / myristate_sum_11b * H2_sum_11b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [myristates_mass] of prey) / myristate_sum_11b * H+_sum_11b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [myristates_mass] of prey) / myristate_sum_11b * acetate_sum_11b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC11
  if syntrophomonas_AC11_mass > 1
  [
  set syntrophomonas_AC11_mass (syntrophomonas_AC11_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC11 (0.0197)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC11
  set Syntrophomonas_AC11_mass (syntrophomonas_AC11_mass - syntrophomonas_AC11_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson,1970 (Batstone, 2002).
end

;;;SYNTROPHOMONAS AC12;;; For Equation 12

to AC12_S_eat_palmitate;; Syntrophomonas procedure ;; maximum uptake rate is up to 0.0184 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target palmitates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [palmitates_mass] of prey) > uptake_s_AC12
      [
        let food_12 min (list uptake_s_AC12 [palmitates_mass] of prey)
        set Gr (14.9508 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (2 / 7)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_palmitates ^ (1 / 28)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.1700 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_12 energy_fs
        let fe_12 energy_fe

        let palmitate_re_r ( (1 / 28) * 1000 * fe_12)
        let H2O_re_r ( (1 / 2) * 1000 * fe_12)
        let CO2_rs_r ((1 / 5) * 1000 * fs_12)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_12)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_12)
        let palmitate_rs_r ((1 / 28) * 1000 * fs_12)
        let H2O_rs_r ((1 / 20) * 1000 * fs_12)

        let acetate_re_p (( 2 / 7) * 1000 * fe_12)
        let H+_re_p ((1 / 4) * 1000 * fe_12)
        let H2_re_p ((1 / 2) * 1000 * fe_12)
        let biomass_rs_p ((1 / 20) * 1000 * fs_12)
        let acetate_rs_p ((2 / 7) * 1000 * fs_12)
        let H+_rs_p ((1 / 4) * 1000 * fs_12)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let palmitate_sum (palmitate_re_r + palmitate_rs_r)

        set syntrophomonas_AC12_mass syntrophomonas_AC12_mass + (food_12 / palmitate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_12 / palmitate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_12 / palmitate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_12 / palmitate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_12 / palmitate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_12 / palmitate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_12 / palmitate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_12 / palmitate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set palmitates_mass palmitates_mass - (food_12 / num_prey)]
      ]
      [
        set Gr (14.9508 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (2 / 7)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_palmitates ^ (1 / 28)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.1700 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_12b energy_fs
        let fe_12b energy_fe

        let palmitate_re_r_12b (( 1 / 28) * 1000 * fe_12b)
        let H2O_re_r_12b (( 1 / 2) * 1000 * fe_12b)
        let CO2_rs_r_12b ((1 / 5) * 1000 * fs_12b)
        let NH4_rs_r_12b ( (1 / 20) * 1000 * fs_12b)
        let HCO3_rs_r_12b ((1 / 20) * 1000 * fs_12b)
        let palmitate_rs_r_12b ((1 / 28) * 1000 * fs_12b)
        let H2O_rs_r_12b ((1 / 20) * 1000 * fs_12b)

        let acetate_re_p_12b ( (2 / 7) * 1000 * fe_12b)
        let H+_re_p_12b ((1 / 4) * 1000 * fe_12b)
        let H2_re_p_12b ((1 / 2) * 1000 * fe_12b)
        let biomass_rs_p_12b ((1 / 20) * 1000 * fs_12b)
        let acetate_rs_p_12b ((2 / 7) * 1000 * fs_12b)
        let H+_rs_p_12b ((1 / 4) * 1000 * fs_12b)

        let H2O_sum_12b (H2O_re_r_12b + H2O_rs_r_12b)
        let H2_sum_12b (H2_re_p_12b)
        let H+_sum_12b (H+_re_p_12b + H+_rs_p_12b)
        let CO2_sum_12b (CO2_rs_r_12b)
        let HCO3_sum_12b (HCO3_rs_r_12b)
        let acetate_sum_12b (acetate_re_p_12b + acetate_rs_p_12b)
        let NH4_sum_12b (NH4_rs_r_12b)
        let biomass_sum_12b (biomass_rs_p_12b)
        let palmitate_sum_12b (palmitate_re_r_12b + palmitate_rs_r_12b)

        set syntrophomonas_AC12_mass syntrophomonas_AC12_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * biomass_sum_12b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H2O_sum_12b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * Co2_sum_12b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * HCO3_sum_12b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * NH4_sum_12b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H2_sum_12b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H+_sum_12b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * acetate_sum_12b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC12
  if syntrophomonas_AC12_mass > 1
  [
  set syntrophomonas_AC12_mass (syntrophomonas_AC12_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC12 (0.0184)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC12
  set syntrophomonas_AC12_mass (syntrophomonas_AC12_mass - syntrophomonas_AC12_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson,1970 (Batstone, 2002).
end

;;;SYNTROPHOMONAS FB13;;; For Equation 13

to AC13_s_eat_stearate;; Syntrophomonas procedure ;; maximum uptake rate is up to 0.0128 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target stearates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [stearates_mass] of prey) > uptake_s_AC13
      [
        let food_13 min (list uptake_s_AC13 [stearates_mass] of prey)
        set Gr (14.6699 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 32)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_stearates ^ (1 / 32)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((9.89 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_13 energy_fs
        let fe_13 energy_fe

        let stearate_re_r ( (1 / 32) * 1000 * fe_13)
        let H2O_re_r ( (1 / 2) * 1000 * fe_13)
        let CO2_rs_r ((1 / 5) * 1000 * fs_13)
        let NH4_rs_r (( 1 / 20) * 1000 * fs_13)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_13)
        let stearate_rs_r ((1 / 32) * 1000 * fs_13)
        let H2O_rs_r ((1 / 20) * 1000 * fs_13)

        let acetate_re_p ( (9 / 32) * 1000 * fe_13)
        let H+_re_p ((1 / 4) * 1000 * fe_13)
        let H2_re_p ((1 / 2) * 1000 * fe_13)
        let biomass_rs_p ((1 / 20) * 1000 * fs_13)
        let acetate_rs_p ((9 / 32) * 1000 * fs_13)
        let H+_rs_p ((1 / 4) * 1000 * fs_13)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let stearate_sum (stearate_re_r + stearate_rs_r)

        set syntrophomonas_AC13_mass syntrophomonas_AC13_mass + (food_13 / stearate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_13 / stearate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_13 / stearate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_13 / stearate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_13 / stearate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_13 / stearate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_13 / stearate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_13 / stearate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set stearates_mass stearates_mass - (food_13 / num_prey)]
      ]
      [
        set Gr (14.6699 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 32)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_stearates ^ (1 / 32)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((9.89 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_13b energy_fs
        let fe_13b energy_fe

        let stearate_re_r_13b ( (1 / 32) * 1000 * fe_13b)
        let H2O_re_r_13b (( 1 / 2) * 1000 * fe_13b)
        let CO2_rs_r_13b ((1 / 5) * 1000 * fs_13b)
        let NH4_rs_r_13b ( (1 / 20) * 1000 * fs_13b)
        let HCO3_rs_r_13b ((1 / 20) * 1000 * fs_13b)
        let stearate_rs_r_13b ((1 / 32) * 1000 * fs_13b)
        let H2O_rs_r_13b ((1 / 20) * 1000 * fs_13b)

        let acetate_re_p_13b ( (9 / 32) * 1000 * fe_13b)
        let H+_re_p_13b ((1 / 4) * 1000 * fe_13b)
        let H2_re_p_13b ((1 / 2) * 1000 * fe_13b)
        let biomass_rs_p_13b ((1 / 20) * 1000 * fs_13b)
        let acetate_rs_p_13b ((9 / 32) * 1000 * fs_13b)
        let H+_rs_p_13b ((1 / 4) * 1000 * fs_13b)

        let H2O_sum_13b (H2O_re_r_13b + H2O_rs_r_13b)
        let H2_sum_13b (H2_re_p_13b)
        let H+_sum_13b (H+_re_p_13b + H+_rs_p_13b)
        let CO2_sum_13b (CO2_rs_r_13b)
        let HCO3_sum_13b (HCO3_rs_r_13b)
        let acetate_sum_13b (acetate_re_p_13b + acetate_rs_p_13b)
        let NH4_sum_13b (NH4_rs_r_13b)
        let biomass_sum_13b (biomass_rs_p_13b)
        let stearate_sum_13b (stearate_re_r_13b + stearate_rs_r_13b)

        set syntrophomonas_AC13_mass syntrophomonas_AC13_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * biomass_sum_13b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [stearates_mass] of prey) / stearate_sum_13b * H2O_sum_13b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [stearates_mass] of prey) / stearate_sum_13b * Co2_sum_13b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [stearates_mass] of prey) / stearate_sum_13b * HCO3_sum_13b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [stearates_mass] of prey) / stearate_sum_13b * NH4_sum_13b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * H2_sum_13b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * H+_sum_13b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * acetate_sum_13b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC13
  if syntrophomonas_AC13_mass > 1
  [
  set syntrophomonas_AC13_mass (syntrophomonas_AC13_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC13 (0.0128)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC13
  set syntrophomonas_AC13_mass (syntrophomonas_AC13_mass - syntrophomonas_AC13_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson,1970 (Batstone, 2002).
end

;;;SYNTROPHOMONAS AC14;;; For Equation 14

to AC14_s_eat_oleate;; Syntrophomonas procedure ;; maximum uptake rate is up to 0.0669 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target oleates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [oleates_mass] of prey) > uptake_s_AC14
      [
        let food_14 min (list uptake_s_AC14 [oleates_mass] of prey)
        set Gr (13.0273 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (3 / 10)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (4 / 15))) / ((Initial_concentration_oleates ^ (1 / 30)) * (1 ^ (8 / 15)))))
        set energy_fs 1 / (1 + abs((((8.25 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_14 energy_fs
        let fe_14 energy_fe

        let oleate_re_r ( (1 / 30) * 1000 * fe_14)
        let H2O_re_r ( (8 / 15) * 1000 * fe_14)
        let CO2_rs_r ((1 / 5) * 1000 * fs_14)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_14)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_14)
        let oleate_rs_r ((1 / 30) * 1000 * fs_14)
        let H2O_rs_r ((1 / 12) * 1000 * fs_14)

        let acetate_re_p (( 3 / 10) * 1000 * fe_14)
        let H+_re_p ((4 / 15) * 1000 * fe_14)
        let H2_re_p ((1 / 2) * 1000 * fe_14)
        let biomass_rs_p ((1 / 20) * 1000 * fs_14)
        let acetate_rs_p ((3 / 10) * 1000 * fs_14)
        let H+_rs_p ((4 / 15) * 1000 * fs_14)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let oleate_sum (oleate_re_r + oleate_rs_r)

        set syntrophomonas_AC14_mass syntrophomonas_AC14_mass + (food_14 / oleate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_14 / oleate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_14 / oleate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_14 / oleate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_14 / oleate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_14 / oleate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_14 / oleate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_14 / oleate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set oleates_mass oleates_mass - (food_14 / num_prey)]
      ]
      [
        set Gr (13.0273 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (3 / 10)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (4 / 15))) / ((Initial_concentration_oleates ^ (1 / 30)) * (1 ^ (8 / 15)))))
        set energy_fs 1 / (1 + abs((((8.25 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_14b energy_fs
        let fe_14b energy_fe

        let oleate_re_r_14b ( (1 / 30) * 1000 * fe_14b)
        let H2O_re_r_14b ( (8 / 15) * 1000 * fe_14b)
        let CO2_rs_r_14b ((1 / 5) * 1000 * fs_14b)
        let NH4_rs_r_14b ( (1 / 20) * 1000 * fs_14b)
        let HCO3_rs_r_14b ((1 / 20) * 1000 * fs_14b)
        let oleate_rs_r_14b ((1 / 30) * 1000 * fs_14b)
        let H2O_rs_r_14b ((1 / 12) * 1000 * fs_14b)

        let acetate_re_p_14b (( 3 / 10) * 1000 * fe_14b)
        let H+_re_p_14b ((4 / 15) * 1000 * fe_14b)
        let H2_re_p_14b ((1 / 2) * 1000 * fe_14b)
        let biomass_rs_p_14b ((1 / 20) * 1000 * fs_14b)
        let acetate_rs_p_14b ((3 / 10) * 1000 * fs_14b)
        let H+_rs_p_14b ((4 / 15) * 1000 * fs_14b)

        let H2O_sum_14b (H2O_re_r_14b + H2O_rs_r_14b)
        let H2_sum_14b (H2_re_p_14b)
        let H+_sum_14b (H+_re_p_14b + H+_rs_p_14b)
        let CO2_sum_14b (CO2_rs_r_14b)
        let HCO3_sum_14b (HCO3_rs_r_14b)
        let acetate_sum_14b (acetate_re_p_14b + acetate_rs_p_14b)
        let NH4_sum_14b (NH4_rs_r_14b)
        let biomass_sum_14b (biomass_rs_p_14b)
        let oleate_sum_14b (oleate_re_r_14b + oleate_rs_r_14b)

        set syntrophomonas_AC14_mass syntrophomonas_AC14_mass + ((sum [oleates_mass] of prey) / oleate_sum_14b * biomass_sum_14b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum  [oleates_mass] of prey) / oleate_sum_14b * H2O_sum_14b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [oleates_mass] of prey) / oleate_sum_14b * Co2_sum_14b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [oleates_mass] of prey) / oleate_sum_14b * HCO3_sum_14b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [oleates_mass] of prey) / oleate_sum_14b * NH4_sum_14b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [oleates_mass] of prey)  / oleate_sum_14b * H2_sum_14b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [oleates_mass] of prey) / oleate_sum_14b * H+_sum_14b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [oleates_mass] of prey) / oleate_sum_14b * acetate_sum_14b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC14
  if syntrophomonas_AC14_mass > 1
  [
  set syntrophomonas_AC14_mass (syntrophomonas_AC14_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC14 (0.0669)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC14
  set syntrophomonas_AC14_mass (syntrophomonas_AC14_mass - syntrophomonas_AC14_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson, 1970 (Batstone, 2002).
end

;;;SYNTROPHOMONAS AC15;;; For Equation 15

to AC15_s_eat_linoleate;; Syntrophomonas procedure ;; maximum uptake rate is up to 0.0842 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target linoleates in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [linoleates_mass] of prey) > uptake_s_AC15
      [
        let food_15 min (list uptake_s_AC15 [linoleates_mass] of prey)
        set Gr (11.1514 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 28)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (2 / 7))) / ((Initial_concentration_oleates ^ (1 / 28)) * (1 ^ (4 / 7)))))
        set energy_fs 1 / (1 + abs((((6.37 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_15 energy_fs
        let fe_15 energy_fe

        let linoleate_re_r ( (1 / 28) * 1000 * fe_15)
        let H2O_re_r ( (4 / 7) * 1000 * fe_15)
        let CO2_rs_r ((1 / 5) * 1000 * fs_15)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_15)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_15)
        let linoleate_rs_r ((1 / 28) * 1000 * fs_15)
        let H2O_rs_r ((17 / 140) * 1000 * fs_15)

        let acetate_re_p ((9 / 28) * 1000 * fe_15)
        let H+_re_p ((2 / 7) * 1000 * fe_15)
        let H2_re_p ((1 / 2 )* 1000 * fe_15)
        let biomass_rs_p ((1 / 20) * 1000 * fs_15)
        let acetate_rs_p ((9 / 28) * 1000 * fs_15)
        let H+_rs_p ((2 / 7) * 1000 * fs_15)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let linoleate_sum (linoleate_re_r + linoleate_rs_r)

        set syntrophomonas_AC15_mass syntrophomonas_AC15_mass + (food_15 / linoleate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_15 / linoleate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_15 / linoleate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_15 / linoleate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_15 / linoleate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_15 / linoleate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_15 / linoleate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_15 / linoleate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set linoleates_mass linoleates_mass - (food_15 / num_prey)]
      ]
      [
        set Gr (11.1514 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 28)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (2 / 7))) / ((Initial_concentration_oleates ^ (1 / 28)) * (1 ^ (4 / 7)))))
        set energy_fs 1 / (1 + abs((((6.37 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_15b energy_fs
        let fe_15b energy_fe

        let linoleate_re_r_15b ( (1 / 28) * 1000 * fe_15b)
        let H2O_re_r_15b ( (4 / 7) * 1000 * fe_15b)
        let CO2_rs_r_15b ((1 / 5) * 1000 * fs_15b)
        let NH4_rs_r_15b ( (1 / 20) * 1000 * fs_15b)
        let HCO3_rs_r_15b ((1 / 20) * 1000 * fs_15b)
        let linoleate_rs_r_15b ((1 / 28) * 1000 * fs_15b)
        let H2O_rs_r_15b ((17 / 140) * 1000 * fs_15b)

        let acetate_re_p_15b ((9 / 28) * 1000 * fe_15b)
        let H+_re_p_15b ((2 / 7) * 1000 * fe_15b)
        let H2_re_p_15b ((1 / 2) * 1000 * fe_15b)
        let biomass_rs_p_15b ((1 / 20) * 1000 * fs_15b)
        let acetate_rs_p_15b ((9 / 28) * 1000 * fs_15b)
        let H+_rs_p_15b ((2 / 7) * 1000 * fs_15b)

        let H2O_sum_15b (H2O_re_r_15b + H2O_rs_r_15b)
        let H2_sum_15b (H2_re_p_15b)
        let H+_sum_15b (H+_re_p_15b + H+_rs_p_15b)
        let CO2_sum_15b (CO2_rs_r_15b)
        let HCO3_sum_15b (HCO3_rs_r_15b)
        let acetate_sum_15b (acetate_re_p_15b + acetate_rs_p_15b)
        let NH4_sum_15b (NH4_rs_r_15b)
        let biomass_sum_15b (biomass_rs_p_15b)
        let linoleate_sum_15b (linoleate_re_r_15b + linoleate_rs_r_15b)

        set syntrophomonas_AC15_mass syntrophomonas_AC15_mass + ((sum [linoleates_mass] of prey) / linoleate_sum_15b * biomass_sum_15b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [linoleates_mass] of prey) / linoleate_sum_15b * H2O_sum_15b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [linoleates_mass] of prey) / linoleate_sum_15b * Co2_sum_15b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [linoleates_mass] of prey) / linoleate_sum_15b * HCO3_sum_15b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [linoleates_mass] of prey) / linoleate_sum_15b * NH4_sum_15b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [linoleates_mass] of prey) / linoleate_sum_15b * H2_sum_15b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [linoleates_mass] of prey) / linoleate_sum_15b * H+_sum_15b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [linoleates_mass] of prey) / linoleate_sum_15b * acetate_sum_15b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC15
  if syntrophomonas_AC15_mass > 1
  [
  set syntrophomonas_AC15_mass (syntrophomonas_AC15_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC15 (0.0842)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC15
  set syntrophomonas_AC15_mass (syntrophomonas_AC15_mass - syntrophomonas_AC15_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson, 1970 (Batstone, 2002).
end


;;;SYNTROPHOMONAS AC16;;; For Equation 16

to AC16_s_eat_butyrate;; Syntrophomonas procedure ;; maximum uptake rate is up to 20.23 mmol/mmmol d so... 0.8433 mmol/mmol h from Lawrence and McCarty 1969 for Syntrophomonas wolfei
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target butyrates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [butyrates_mass] of prey) > uptake_s_AC16
      [
        let food_16 min (list uptake_s_AC16 [butyrates_mass] of prey)
        set Gr (12.0740 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_butyrates ^ (1 / 4) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((7.294 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_16 energy_fs
        let fe_16 energy_fe

        let butyrate_re_r ((1 / 4) * 1000 * fe_16)
        let H2O_re_r ((1 / 2) * 1000 * fe_16)
        let CO2_rs_r ((1 / 5) * 1000 * fs_16)
        let NH4_rs_r ((1 / 20) * 1000 * fs_16)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_16)
        let butyrate_rs_r ((1 / 4) * 1000 * fs_16)
        let H2O_rs_r ((1 / 20) * 1000 * fs_16)

        let acetate_re_p ((1 / 2) * 1000 * fe_16)
        let H2_re_p ((1 / 2) * 1000 * fe_16)
        let H+_re_p ((1 / 4) * 1000 * fe_16)
        let biomass_rs_p ((1 / 20) * 1000 * fs_16)
        let acetate_rs_p ( (1 / 2) * 1000 * fs_16)
        let H+_rs_p ((1 / 4) * 1000 * fs_16)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p + acetate_rs_p)
        let butyrate_sum (butyrate_re_r + butyrate_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set syntrophomonas_AC16_mass syntrophomonas_AC16_mass + (food_16 / butyrate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_16 / butyrate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_16 / butyrate_sum * CO2_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_16 / butyrate_sum * NH4_sum)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_16 / butyrate_sum * HCO3_sum)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_16 / butyrate_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_16 / butyrate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_16 / butyrate_sum * H+_sum) right random 360 fd 4]
        ask prey [set butyrates_mass butyrates_mass - (food_16 / num_prey)]
      ]
      [
        set Gr (12.0740 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_butyrates ^ (1 / 4) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((7.294 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_16b energy_fs
        let fe_16b energy_fe

        let butyrate_re_r_16b ((1 / 4) * 1000 * fe_16b)
        let H2O_re_r_16b ((1 / 2) * 1000 * fe_16b)
        let CO2_rs_r_16b ((1 / 5) * 1000 * fs_16b)
        let NH4_rs_r_16b ((1 / 20) * 1000 * fs_16b)
        let HCO3_rs_r_16b ((1 / 20) * 1000 * fs_16b)
        let butyrate_rs_r_16b ((1 / 4) * 1000 * fs_16b)
        let H2O_rs_r_16b ((1 / 20) * 1000 * fs_16b)

        let acetate_re_p_16b ((1 / 2) * 1000 * fe_16b)
        let H2_re_p_16b ((1 / 2) * 1000 * fe_16b)
        let H+_re_p_16b ((1 / 4) * 1000 * fe_16b)
        let biomass_rs_p_16b ((1 / 20) * 1000 * fs_16b)
        let acetate_rs_p_16b ( (1 / 2) * 1000 * fs_16b)
        let H+_rs_p_16b ((1 / 4) * 1000 * fs_16b)

        let H2O_sum_16b (H2O_re_r_16b + H2O_rs_r_16b)
        let H2_sum_16b (H2_re_p_16b)
        let H+_sum_16b (H+_re_p_16b + H+_rs_p_16b)
        let CO2_sum_16b (CO2_rs_r_16b)
        let HCO3_sum_16b (HCO3_rs_r_16b)
        let acetates_sum_16b (acetate_re_p_16b + acetate_rs_p_16b)
        let butyrate_sum_16b (butyrate_re_r_16b + butyrate_rs_r_16b)
        let NH4_sum_16b (NH4_rs_r_16b)
        let biomass_sum_16b (biomass_rs_p_16b)

        set syntrophomonas_AC16_mass syntrophomonas_AC16_mass + ((sum  [butyrates_mass] of prey) / butyrate_sum_16b * biomass_sum_16b)
        ask n-of 1 patches [set pcolor black set moles moles - (( sum [butyrates_mass] of prey) / butyrate_sum_16b * H2O_sum_16b)]
        if moles = 0 [die]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (( sum [butyrates_mass] of prey) / butyrate_sum_16b * CO2_sum_16b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (( sum [butyrates_mass] of prey) / butyrate_sum_16b * NH4_sum_16b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum  [butyrates_mass] of prey) / butyrate_sum_16b * HCO3_sum_16b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum  [butyrates_mass] of prey) / butyrate_sum_16b * acetates_sum_16b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum  [butyrates_mass] of prey) / butyrate_sum_16b * H2_sum_16b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum  [butyrates_mass] of prey) / butyrate_sum_16b * H+_sum_16b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC16
  if syntrophomonas_AC16_mass > 1
  [
  set syntrophomonas_AC16_mass (syntrophomonas_AC16_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC16 0.8433
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC16
  set syntrophomonas_AC16_mass (syntrophomonas_AC16_mass - syntrophomonas_AC16_mass * (0.0270 / 24)) ;; Represents decay rate per hour based on Batstone, 2002.
end

;;;SYNTROPHUS AC12;;; For Equation 12

to AC12_Su_eat_palmitate;; Syntrophus procedure ;; maximum uptake rate is up to 0.0184 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target palmitates in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [palmitates_mass] of prey) > uptake_su_AC12
      [
        let food_12 min (list uptake_su_AC12 [palmitates_mass] of prey)
        set Gr (14.9508 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (2 / 7)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_palmitates ^ (1 / 28)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.1700 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_12 energy_fs
        let fe_12 energy_fe

        let palmitate_re_r ( (1 / 28) * 1000 * fe_12)
        let H2O_re_r ( (1 / 2) * 1000 * fe_12)
        let CO2_rs_r ((1 / 5) * 1000 * fs_12)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_12)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_12)
        let palmitate_rs_r ((1 / 28) * 1000 * fs_12)
        let H2O_rs_r ((1 / 20) * 1000 * fs_12)

        let acetate_re_p ( (2 / 7) * 1000 * fe_12)
        let H+_re_p ((1 / 4) * 1000 * fe_12)
        let H2_re_p ((1 / 2) * 1000 * fe_12)
        let biomass_rs_p ((1 / 20) * 1000 * fs_12)
        let acetate_rs_p ((2 / 7) * 1000 * fs_12)
        let H+_rs_p ((1 / 4) * 1000 * fs_12)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let palmitate_sum (palmitate_re_r + palmitate_rs_r)

        set syntrophus_AC12_mass syntrophus_AC12_mass + (food_12 / palmitate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_12 / palmitate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_12 / palmitate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_12 / palmitate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_12 / palmitate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_12 / palmitate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_12 / palmitate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_12 / palmitate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set palmitates_mass palmitates_mass - (food_12 / num_prey)]
      ]
      [
        set Gr (14.9508 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (2 / 7)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_palmitates ^ (1 / 28)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((10.1700 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_12b energy_fs
        let fe_12b energy_fe

        let palmitate_re_r_12b ( (1 / 28) * 1000 * fe_12b)
        let H2O_re_r_12b (( 1 / 2) * 1000 * fe_12b)
        let CO2_rs_r_12b ((1 / 5) * 1000 * fs_12b)
        let NH4_rs_r_12b ( (1 / 20) * 1000 * fs_12b)
        let HCO3_rs_r_12b ((1 / 20) * 1000 * fs_12b)
        let palmitate_rs_r_12b ((1 / 28) * 1000 * fs_12b)
        let H2O_rs_r_12b ((1 / 20) * 1000 * fs_12b)

        let acetate_re_p_12b ( (2 / 7) * 1000 * fe_12b)
        let H+_re_p_12b ((1 / 4) * 1000 * fe_12b)
        let H2_re_p_12b ((1 / 2) * 1000 * fe_12b)
        let biomass_rs_p_12b ((1 / 20) * 1000 * fs_12b)
        let acetate_rs_p_12b ((2 / 7) * 1000 * fs_12b)
        let H+_rs_p_12b ((1 / 4) * 1000 * fs_12b)

        let H2O_sum_12b (H2O_re_r_12b + H2O_rs_r_12b)
        let H2_sum_12b (H2_re_p_12b)
        let H+_sum_12b (H+_re_p_12b + H+_rs_p_12b)
        let CO2_sum_12b (CO2_rs_r_12b)
        let HCO3_sum_12b (HCO3_rs_r_12b)
        let acetate_sum_12b (acetate_re_p_12b + acetate_rs_p_12b)
        let NH4_sum_12b (NH4_rs_r_12b)
        let biomass_sum_12b (biomass_rs_p_12b)
        let palmitate_sum_12b (palmitate_re_r_12b + palmitate_rs_r_12b)

        set syntrophus_AC12_mass syntrophus_AC12_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * biomass_sum_12b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H2O_sum_12b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * Co2_sum_12b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * HCO3_sum_12b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [palmitates_mass] of prey) / palmitate_sum_12b * NH4_sum_12b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H2_sum_12b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * H+_sum_12b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [palmitates_mass] of prey) / palmitate_sum_12b * acetate_sum_12b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_su_AC12
  if syntrophus_AC12_mass > 1
  [
  set syntrophus_AC12_mass (syntrophus_AC12_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_su_AC12 (0.0184)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_su_AC12
  set syntrophus_AC12_mass (syntrophus_AC12_mass - syntrophus_AC12_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson, 1970 (Batstone, 2002).
end

;;;SYNTROPHUS FB13;;; For Equation 13

to AC13_su_eat_stearate;; Syntrophus procedure ;; maximum uptake rate is up to 0.0128 mmol/mmmol h based on Novak and Carlson, 1970 (Batstone, 2002).
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target stearates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [stearates_mass] of prey) > uptake_su_AC13
      [
        let food_13 min (list uptake_su_AC13 [stearates_mass] of prey)
        set Gr (14.6699 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 32)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_stearates ^ (1 / 32)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((9.89 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_13 energy_fs
        let fe_13 energy_fe

        let stearate_re_r ( (1 / 32) * 1000 * fe_13)
        let H2O_re_r (( 1 / 2) * 1000 * fe_13)
        let CO2_rs_r ((1 / 5) * 1000 * fs_13)
        let NH4_rs_r ( (1 / 20) * 1000 * fs_13)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_13)
        let stearate_rs_r ((1 / 32) * 1000 * fs_13)
        let H2O_rs_r ((1 / 20) * 1000 * fs_13)

        let acetate_re_p ( (9 / 32) * 1000 * fe_13)
        let H+_re_p ((1 / 4) * 1000 * fe_13)
        let H2_re_p ((1 / 2) * 1000 * fe_13)
        let biomass_rs_p ((1 / 20) * 1000 * fs_13)
        let acetate_rs_p ((9 / 32) * 1000 * fs_13)
        let H+_rs_p ((1 / 4) * 1000 * fs_13)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)
        let stearate_sum (stearate_re_r + stearate_rs_r)

        set syntrophus_AC13_mass syntrophus_AC13_mass + (food_13 / stearate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_13 / stearate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - (food_13 / stearate_sum * Co2_sum)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_13 / stearate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_13 / stearate_sum * NH4_sum)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_13 / stearate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_13 / stearate_sum * H+_sum) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + (food_13 / stearate_sum * acetate_sum) rt random 360 fd 1]

        ask prey [set stearates_mass stearates_mass - (food_13 / num_prey)]
      ]
      [
        set Gr (14.6699 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (9 / 32)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / ((Initial_concentration_stearates ^ (1 / 32)) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((9.89 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_13b energy_fs
        let fe_13b energy_fe

        let stearate_re_r_13b ( (1 / 32) * 1000 * fe_13b)
        let H2O_re_r_13b (( 1 / 2) * 1000 * fe_13b)
        let CO2_rs_r_13b ((1 / 5) * 1000 * fs_13b)
        let NH4_rs_r_13b (( 1 / 20) * 1000 * fs_13b)
        let HCO3_rs_r_13b ((1 / 20) * 1000 * fs_13b)
        let stearate_rs_r_13b ((1 / 32) * 1000 * fs_13b)
        let H2O_rs_r_13b ((1 / 20) * 1000 * fs_13b)

        let acetate_re_p_13b ( (9 / 32) * 1000 * fe_13b)
        let H+_re_p_13b ((1 / 4) * 1000 * fe_13b)
        let H2_re_p_13b ((1 / 2) * 1000 * fe_13b)
        let biomass_rs_p_13b ((1 / 20) * 1000 * fs_13b)
        let acetate_rs_p_13b ((9 / 32) * 1000 * fs_13b)
        let H+_rs_p_13b ((1 / 4) * 1000 * fs_13b)

        let H2O_sum_13b (H2O_re_r_13b + H2O_rs_r_13b)
        let H2_sum_13b (H2_re_p_13b)
        let H+_sum_13b (H+_re_p_13b + H+_rs_p_13b)
        let CO2_sum_13b (CO2_rs_r_13b)
        let HCO3_sum_13b (HCO3_rs_r_13b)
        let acetate_sum_13b (acetate_re_p_13b + acetate_rs_p_13b)
        let NH4_sum_13b (NH4_rs_r_13b)
        let biomass_sum_13b (biomass_rs_p_13b)
        let stearate_sum_13b (stearate_re_r_13b + stearate_rs_r_13b)

        set syntrophus_AC13_mass syntrophus_AC13_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * biomass_sum_13b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [stearates_mass] of prey) / stearate_sum_13b * H2O_sum_13b)]
        if moles = 0 [die]
        ask one-of CO2s [set Co2s_mass CO2s_mass - ((sum [stearates_mass] of prey) / stearate_sum_13b * Co2_sum_13b)]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass -((sum [stearates_mass] of prey) / stearate_sum_13b * HCO3_sum_13b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [stearates_mass] of prey) / stearate_sum_13b * NH4_sum_13b)]

        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * H2_sum_13b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * H+_sum_13b) right random 360 fd 4]
        hatch-acetates 1 [set color turquoise set size 0.5 set acetates_mass acetates_mass + ((sum [stearates_mass] of prey) / stearate_sum_13b * acetate_sum_13b) rt random 360 fd 1]

        ask prey [die]
      ]
    ]
  ]

end

to reproduce_su_AC13
  if syntrophus_AC13_mass > 1
  [
  set syntrophus_AC13_mass (syntrophus_AC13_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_su_AC13 (0.0128)
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_su_AC13
  set syntrophus_AC13_mass (syntrophus_AC13_mass - syntrophus_AC13_mass * ((0.01) / 24)) ;; Represents decay rate per hour based on Novak and Carlson, 1970 (Batstone, 2002).
end

;;; SYNTROPHUS ;;;

;;;SYNTROPHUS AC16;;; For Equation 16

to AC16_su_eat_butyrate;; Syntrophus procedure ;; maximum uptake rate is up to 20.23 mmol/mmmol d so... 0.8433 mmol/mmol h from Lawrence and McCarty 1969 for Syntrophomonas wolfei
if initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target butyrates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [butyrates_mass] of prey) > uptake_su_AC16
      [
        let food_16 min (list uptake_su_AC16 [butyrates_mass] of prey)
        set Gr (12.0740 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_butyrates ^ (1 / 4) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((7.294 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_16 energy_fs
        let fe_16 energy_fe

        let butyrate_re_r ((1 / 4) * 1000 * fe_16)
        let H2O_re_r ((1 / 2) * 1000 * fe_16)
        let CO2_rs_r ((1 / 5) * 1000 * fs_16)
        let NH4_rs_r ((1 / 20) * 1000 * fs_16)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_16)
        let butyrate_rs_r ((1 / 4) * 1000 * fs_16)
        let H2O_rs_r ((1 / 20) * 1000 * fs_16)

        let acetate_re_p ((1 / 2) * 1000 * fe_16)
        let H2_re_p ((1 / 2) * 1000 * fe_16)
        let H+_re_p ((1 / 4) * 1000 * fe_16)
        let biomass_rs_p ((1 / 20) * 1000 * fs_16)
        let acetate_rs_p ( (1 / 2) * 1000 * fs_16)
        let H+_rs_p ((1 / 4) * 1000 * fs_16)

        let H2O_sum (H2O_re_r + H2O_rs_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p + acetate_rs_p)
        let butyrate_sum (butyrate_re_r + butyrate_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set syntrophus_AC16_mass syntrophus_AC16_mass + (food_16 / butyrate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_16 / butyrate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_16 / butyrate_sum * CO2_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_16 / butyrate_sum * NH4_sum)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_16 / butyrate_sum * HCO3_sum)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_16 / butyrate_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_16 / butyrate_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_16 / butyrate_sum * H+_sum) right random 360 fd 4]
        ask prey [set butyrates_mass butyrates_mass - (food_16 / num_prey)]
      ]
      [
        set Gr (12.0740 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 2)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_butyrates ^ (1 / 4) * (1 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((7.294 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_16b energy_fs
        let fe_16b energy_fe

        let butyrate_re_r_16b ((1 / 4) * 1000 * fe_16b)
        let H2O_re_r_16b ((1 / 2) * 1000 * fe_16b)
        let CO2_rs_r_16b ((1 / 5) * 1000 * fs_16b)
        let NH4_rs_r_16b ((1 / 20) * 1000 * fs_16b)
        let HCO3_rs_r_16b ((1 / 20) * 1000 * fs_16b)
        let butyrate_rs_r_16b ((1 / 4) * 1000 * fs_16b)
        let H2O_rs_r_16b ((1 / 20) * 1000 * fs_16b)

        let acetate_re_p_16b ((1 / 2) * 1000 * fe_16b)
        let H2_re_p_16b ((1 / 2) * 1000 * fe_16b)
        let H+_re_p_16b ((1 / 4) * 1000 * fe_16b)
        let biomass_rs_p_16b ((1 / 20) * 1000 * fs_16b)
        let acetate_rs_p_16b ( (1 / 2) * 1000 * fs_16b)
        let H+_rs_p_16b ((1 / 4) * 1000 * fs_16b)

        let H2O_sum_16b (H2O_re_r_16b + H2O_rs_r_16b)
        let H2_sum_16b (H2_re_p_16b)
        let H+_sum_16b (H+_re_p_16b + H+_rs_p_16b)
        let CO2_sum_16b (CO2_rs_r_16b)
        let HCO3_sum_16b (HCO3_rs_r_16b)
        let acetates_sum_16b (acetate_re_p_16b + acetate_rs_p_16b)
        let butyrate_sum_16b (butyrate_re_r_16b + butyrate_rs_r_16b)
        let NH4_sum_16b (NH4_rs_r_16b)
        let biomass_sum_16b (biomass_rs_p_16b)

        set syntrophus_AC16_mass syntrophus_AC16_mass + ((sum [butyrates_mass] of prey) / butyrate_sum_16b * biomass_sum_16b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [butyrates_mass] of prey) / butyrate_sum_16b * H2O_sum_16b)]
        if moles = 0 [die]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [butyrates_mass] of prey) / butyrate_sum_16b * CO2_sum_16b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [butyrates_mass] of prey) / butyrate_sum_16b * NH4_sum_16b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [butyrates_mass] of prey) / butyrate_sum_16b * HCO3_sum_16b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [butyrates_mass] of prey) / butyrate_sum_16b * acetates_sum_16b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [butyrates_mass] of prey)  / butyrate_sum_16b * H2_sum_16b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [butyrates_mass] of prey) / butyrate_sum_16b * H+_sum_16b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_su_AC16
  if syntrophus_AC16_mass > 1
  [
  set syntrophus_AC16_mass (syntrophus_AC16_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_su_AC16 0.8433
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_su_AC16
  set syntrophus_AC16_mass (syntrophus_AC16_mass - syntrophus_AC16_mass * (0.0270 / 24)) ;; Represents decay rate per hour based on Batstone, 2002.
end


;;;SYNTROPHUS AC17;;; For Equation 17

to AC17_s_eat_propionate;; Syntrophus procedure ;; maximum uptake rate is up to 16.9066 mmol/mmmol d so... 0.7044 mmol/mmol h from Batstone et al., 2002
if initial_concentration_hydrogens <= 0.14 and time > 1
  [
  let target propionates in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [propionates_mass] of prey) > uptake_s_AC17
      [
        let food_17 min (list uptake_s_AC17 [propionates_mass] of prey)
        set Gr (13.3343 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 6)) * (LCO2 ^ (1 / 6)) * (LH2 ^ (1 / 2))) / (Initial_concentration_propionates ^ (1 / 6) * (1 ^ (1 / 3)))))
        set energy_fs 1 / (1 + abs((((8.5543 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_17 energy_fs
        let fe_17 energy_fe

        let propionate_re_r ((1 / 6) * 1000 * fe_17)
        let H2O_re_r ((1 / 3) * 1000 * fe_17)
        let CO2_rs_r ((1 / 30) * 1000 * fs_17)
        let NH4_rs_r ((1 / 20) * 1000 * fs_17)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_17)
        let propionate_rs_r ((1 / 6) * 1000 * fs_17)

        let acetate_re_p ((1 / 6) * 1000 * fe_17)
        let CO2s_re_p ((1 / 6) * 1000 * fe_17)
        let H2_re_p ((1 / 2) * 1000 * fe_17)
        let biomass_rs_p ((1 / 20) * 1000 * fs_17)
        let acetate_rs_p ((1 / 6) * 1000 * fs_17)
        let H2O_rs_p ((7 / 60) * 1000 * fs_17)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let CO2_sum (CO2s_re_p - CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p + acetate_rs_p)
        let propionate_sum (propionate_re_r + propionate_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set syntrophobacterales_AC17_mass syntrophobacterales_AC17_mass + (food_17 / propionate_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_17 / propionate_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_17 / propionate_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_17 / propionate_sum * NH4_sum)]
        hatch-CO2s 1 [set color lime  set size 0.5 set CO2s_mass CO2s_mass + (food_17 / propionate_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_17 / propionate_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_17 / propionate_sum * H2_sum) right random 360 fd 3]
        ask prey [set propionates_mass propionates_mass - (food_17 / num_prey)]
      ]
      [
        set Gr (13.3343 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 6)) * (LCO2 ^ (1 / 6)) * (LH2 ^ (1 / 2))) / (Initial_concentration_propionates ^ (1 / 6) * (1 ^ (1 / 3)))))
        set energy_fs 1 / (1 + abs((((8.5543 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_17b energy_fs
        let fe_17b energy_fe

        let propionate_re_r_17b ((1 / 6) * 1000 * fe_17b)
        let H2O_re_r_17b ((1 / 3) * 1000 * fe_17b)
        let CO2_rs_r_17b ((1 / 30) * 1000 * fs_17b)
        let NH4_rs_r_17b ((1 / 20) * 1000 * fs_17b)
        let HCO3_rs_r_17b ((1 / 20) * 1000 * fs_17b)
        let propionate_rs_r_17b ((1 / 6) * 1000 * fs_17b)

        let acetate_re_p_17b ((1 / 6) * 1000 * fe_17b)
        let CO2s_re_p_17b ((1 / 6) * 1000 * fe_17b)
        let H2_re_p_17b ((1 / 2) * 1000 * fe_17b)
        let biomass_rs_p_17b ((1 / 20) * 1000 * fs_17b)
        let acetate_rs_p_17b ( (1 / 6) * 1000 * fs_17b)
        let H2O_rs_p_17b ((7 / 60) * 1000 * fs_17b)

        let H2O_sum_17b (H2O_rs_p_17b - H2O_re_r_17b)
        let H2_sum_17b (H2_re_p_17b)
        let CO2_sum_17b (CO2s_re_p_17b - CO2_rs_r_17b)
        let HCO3_sum_17b (HCO3_rs_r_17b)
        let acetates_sum_17b (acetate_re_p_17b + acetate_rs_p_17b)
        let propionate_sum_17b (propionate_re_r_17b + propionate_rs_r_17b)
        let NH4_sum_17b (NH4_rs_r_17b)
        let biomass_sum_17b (biomass_rs_p_17b)

        set syntrophobacterales_AC17_mass syntrophobacterales_AC17_mass + ((sum [propionates_mass] of prey) / propionate_sum_17b * biomass_sum_17b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [propionates_mass] of prey) / propionate_sum_17b * H2O_sum_17b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [propionates_mass] of prey) / propionate_sum_17b * HCO3_sum_17b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [propionates_mass] of prey) / propionate_sum_17b * NH4_sum_17b)]
        hatch-CO2s 1 [set color lime  set size 0.5 set CO2s_mass CO2s_mass + ((sum [propionates_mass] of prey) / propionate_sum_17b * CO2_sum_17b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [propionates_mass] of prey) / propionate_sum_17b * acetates_sum_17b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [propionates_mass] of prey) / propionate_sum_17b * H2_sum_17b) right random 360 fd 3]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_s_AC17
  if syntrophobacterales_AC17_mass > 1
  [
  set syntrophobacterales_AC17_mass (syntrophobacterales_AC17_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_s_AC17 0.7044
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_s_AC17
  set syntrophobacterales_AC17_mass (syntrophobacterales_AC17_mass - syntrophobacterales_AC17_mass * (0.06 / 24)) ;; Represents decay rate per hour based on Siegrist et al., 2002 (Batstone, 2002).
end


;;; CLOSTRIDIUM;;;

;;; CLOSTRIDIUM AC18;;; For Equation 18

to AC18_eat_ethanol;; Clostridium procedure ;; maximum uptake rate is up to 4.9925 mmol/mmmol d so... 0.2080 mmol/mmol h for Clostridium kluyveri. There is 0.0438 mol/mol*d that accounts for competitive inhibition (Garcia-Gen et al., 2013) for Clostridium kluyveri
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1

  [
  let target ethanols in-radius 2
    if target != nobody
    [
      let prey  up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [ethanols_mass] of prey) > uptake_AC18
      [
        let food_18 min (list uptake_AC18 [ethanols_mass] of prey)
        set Gr (2.4120 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 4)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_ethanols ^ (1 / 4) * (1 ^ (1 / 4)))))
        set energy_fs 1 / (1 + abs((((-2.3680 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_18 energy_fs
        let fe_18 energy_fe

        let ethanol_re_r ((1 / 4) * 1000 * fe_18)
        let H2O_re_r ((1 / 4) * 1000 * fe_18)
        let CO2_rs_r ((1 / 5) * 1000 * fs_18)
        let NH4_rs_r ((1 / 20) * 1000 * fs_18)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_18)
        let ethanol_rs_r ((1 / 4) * 1000 * fs_18)

        let acetate_re_p ((1 / 4) * 1000 * fe_18)
        let H2_re_p ((1 / 2) * 1000 * fe_18)
        let H+_re_p ((1 / 4) * 1000 * fe_18)
        let biomass_rs_p ((1 / 20) * 1000 * fs_18)
        let acetate_rs_p ( (1 / 4) * 1000 * fs_18)
        let H2O_rs_p ((1 / 5) * 1000 * fs_18)
        let H+_rs_p ((1 / 4) * 1000 * fs_18)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p + H+_rs_p)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let ethanols_sum (ethanol_re_r + ethanol_rs_r)
        let acetates_sum (acetate_re_p + acetate_rs_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set C.kluyveri_AC18_mass C.kluyveri_AC18_mass + (food_18 / ethanols_sum * biomass_sum)
        ask n-of 1 patches [set pcolor black set moles moles - (food_18 / ethanols_sum * H2O_sum)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_18 / ethanols_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_18 / ethanols_sum * NH4_sum)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_18 / ethanols_sum * CO2_sum)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_18 / ethanols_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_18 / ethanols_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_18 / ethanols_sum * H+_sum) right random 360 fd 4]
        ask prey [set ethanols_mass ethanols_mass - (food_18 / num_prey)]
      ]
      [
        set Gr (2.4120 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 4)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 4))) / (Initial_concentration_ethanols ^ (1 / 4) * (1 ^ (1 / 4)))))
        set energy_fs 1 / (1 + abs((((-2.3680 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_18b energy_fs
        let fe_18b energy_fe

        let ethanol_re_r_18b ((1 / 4) * 1000 * fe_18b)
        let H2O_re_r_18b ((1 / 4) * 1000 * fe_18b)
        let CO2_rs_r_18b ((1 / 5) * 1000 * fs_18b)
        let NH4_rs_r_18b ((1 / 20) * 1000 * fs_18b)
        let HCO3_rs_r_18b ((1 / 20) * 1000 * fs_18b)
        let ethanol_rs_r_18b ((1 / 4) * 1000 * fs_18b)

        let acetate_re_p_18b ((1 / 4) * 1000 * fe_18b)
        let H2_re_p_18b ((1 / 2) * 1000 * fe_18b)
        let H+_re_p_18b ((1 / 4) * 1000 * fe_18b)
        let biomass_rs_p_18b ((1 / 20) * 1000 * fs_18b)
        let acetate_rs_p_18b ((1 / 4) * 1000 * fs_18b)
        let H2O_rs_p_18b ((1 / 5) * 1000 * fs_18b)
        let H+_rs_p_18b ((1 / 4) * 1000 * fs_18b)

        let H2O_sum_18b (H2O_rs_p_18b - H2O_re_r_18b)
        let H2_sum_18b (H2_re_p_18b)
        let H+_sum_18b (H+_re_p_18b + H+_rs_p_18b)
        let CO2_sum_18b (CO2_rs_r_18b)
        let HCO3_sum_18b (HCO3_rs_r_18b)
        let ethanols_sum_18b (ethanol_re_r_18b + ethanol_rs_r_18b)
        let acetates_sum_18b (acetate_re_p_18b + acetate_rs_p_18b)
        let NH4_sum_18b (NH4_rs_r_18b)
        let biomass_sum_18b (biomass_rs_p_18b)

        set C.kluyveri_AC18_mass C.kluyveri_AC18_mass + ((sum [ethanols_mass] of prey) / ethanols_sum_18b * biomass_sum_18b)
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [ethanols_mass] of prey) / ethanols_sum_18b * H2O_sum_18b)]
        if moles = 0 [die]
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (( sum [ethanols_mass] of prey) / ethanols_sum_18b * HCO3_sum_18b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [ethanols_mass] of prey) / ethanols_sum_18b * NH4_sum_18b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [ethanols_mass] of prey) / ethanols_sum_18b * CO2_sum_18b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [ethanols_mass] of prey) / ethanols_sum_18b * acetates_sum_18b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [ethanols_mass] of prey) / ethanols_sum_18b * H2_sum_18b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [ethanols_mass] of prey) / ethanols_sum_18b * H+_sum_18b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]

end

to reproduce_AC18
  if C.kluyveri_AC18_mass > 1
  [
  set C.kluyveri_AC18_mass (C.kluyveri_AC18_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_AC18 0.2080
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_AC18
  set C.kluyveri_AC18_mass (C.kluyveri_AC18_mass - C.kluyveri_AC18_mass * (0.03 / 24)) ;; Represents decay rate per hour based on Kalyuzhnyi 1997
end

;;; HOMOACETOGENIC BACTERIA;;;

;;;CLOSTRIDIUM HAB19;;; For Equation 19

to HAB19_eat_hydrogen;; Clostridium procedure ;; maximum uptake rate is up to 23.7294 mmol/mmmol d so... 0.9887 mmol/mmol h based on Amani et al., 2010 and Agler et al., 2011
if Initial_concentration_acetates < 0.3 and time > 1
[
    let target hydrogens in-radius 50
    if target != nobody
    [
      let prey up-to-n-of 12 other target
    let num_prey count prey
      ifelse (sum [hydrogens_mass] of prey) > uptake_HAB19
      [
        let food_19 min (list uptake_HAB19 [hydrogens_mass] of prey)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19 energy_fs
        let fe_19 energy_fe

        let CO2_re_r ( (1 / 4) * 1000 * fe_19)
        let H2_re_r ((1 / 2) * 1000 * fe_19)
        let CO2_rs_r ((1 / 5) * 1000 * fs_19)
        let NH4_rs_r ((1 / 20) * 1000 * fs_19)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_19)
        let H2_rs_r ((1 / 2) * 1000 * fs_19)

        let acetate_re_p (( 1 / 8) * 1000 * fe_19)
        let H2O_re_p ((1 / 4) * 1000 * fe_19)
        let H+_re_p ((1 / 8) * 1000 * fe_19)
        let biomass_rs_p ((1 / 20) * 1000 * fs_19)
        let H2O_rs_p ((9 / 20) * 1000 * fs_19)

        let H2O_sum (H2O_re_p + H2O_rs_p)
        let H2_sum (H2_re_r + H2_rs_r)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2_re_r + CO2_rs_r)
        let HCO3_sum (HCO3_rs_r)
        let acetate_sum (acetate_re_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19 / H2_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19 / H2_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19 / H2_sum * NH4_sum)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19 / H2_sum * CO2_sum)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19 / H2_sum * acetate_sum) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19 / H2_sum * H+_sum) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19 / H2_sum * H2O_sum)]
        ask prey [set hydrogens_mass hydrogens_mass - (food_19 / num_prey)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19b energy_fs
        let fe_19b energy_fe

        let CO2_re_r_19b ( (1 / 4) * 1000 * fe_19b)
        let H2_re_r_19b ((1 / 2) * 1000 * fe_19b)
        let CO2_rs_r_19b ((1 / 5) * 1000 * fs_19b)
        let NH4_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let HCO3_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let H2_rs_r_19b ((1 / 2) * 1000 * fs_19b)

        let acetate_re_p_19b (( 1 / 8) * 1000 * fe_19b)
        let H2O_re_p_19b ((1 / 4) * 1000 * fe_19b)
        let H+_re_p_19b ((1 / 8) * 1000 * fe_19b)
        let biomass_rs_p_19b ((1 / 20) * 1000 * fs_19b)
        let H2O_rs_p_19b ((9 / 20) * 1000 * fs_19b)

        let H2O_sum_19b (H2O_re_p_19b + H2O_rs_p_19b)
        let H2_sum_19b (H2_re_r_19b + H2_rs_r_19b)
        let H+_sum_19b (H+_re_p_19b)
        let CO2_sum_19b (CO2_re_r_19b + CO2_rs_r_19b)
        let HCO3_sum_19b (HCO3_rs_r_19b)
        let acetate_sum_19b (acetate_re_p_19b)
        let NH4_sum_19b (NH4_rs_r_19b)
        let biomass_sum_19b (biomass_rs_p_19b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey) / H2_sum_19b * biomass_sum_19b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey) / H2_sum_19b * HCO3_sum_19b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey) / H2_sum_19b * NH4_sum_19b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey) / H2_sum_19b * CO2_sum_19b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey) / H2_sum_19b * acetate_sum_19b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey) / H2_sum_19b * H+_sum_19b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey) / H2_sum_19b * H2O_sum_19b)]
        ask prey [die]
      ]
    ]
]
  if Initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and time > 1
[
    let target2 hydrogens in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 1 other target2
    let num_prey2 count prey2
      ifelse (sum [hydrogens_mass] of prey2) > uptake_HAB19
      [
        let food_19.2 min (list uptake_HAB19 [hydrogens_mass] of prey2)
        set Gr(-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.2 energy_fs
        let fe_19.2 energy_fe

        let CO2_re_r_19.2 ( (1 / 4) * 1000 * fe_19.2)
        let H2_re_r_19.2 ((1 / 2) * 1000 * fe_19.2)
        let CO2_rs_r_19.2 ((1 / 5) * 1000 * fs_19.2)
        let NH4_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let HCO3_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2_rs_r_19.2 ((1 / 2) * 1000 * fs_19.2)

        let acetate_re_p_19.2 (( 1 / 8) * 1000 * fe_19.2)
        let H2O_re_p_19.2 ((1 / 4) * 1000 * fe_19.2)
        let H+_re_p_19.2 ((1 / 8) * 1000 * fe_19.2)
        let biomass_rs_p_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2O_rs_p_19.2 ((9 / 20) * 1000 * fs_19.2)

        let H2O_sum_19.2 (H2O_re_p_19.2 + H2O_rs_p_19.2)
        let H2_sum_19.2 (H2_re_r_19.2 + H2_rs_r_19.2)
        let H+_sum_19.2 (H+_re_p_19.2)
        let CO2_sum_19.2 (CO2_re_r_19.2 + CO2_rs_r_19.2)
        let HCO3_sum_19.2 (HCO3_rs_r_19.2)
        let acetate_sum_19.2 (acetate_re_p_19.2)
        let NH4_sum_19.2 (NH4_rs_r_19.2)
        let biomass_sum_19.2 (biomass_rs_p_19.2)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.2 / H2_sum_19.2 * biomass_sum_19.2)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.2 / H2_sum_19.2 * HCO3_sum_19.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.2 / H2_sum_19.2 * NH4_sum_19.2)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.2 / H2_sum_19.2 * CO2_sum_19.2)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.2 / H2_sum_19.2 * acetate_sum_19.2) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.2 / H2_sum_19.2 * H+_sum_19.2) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.2 / H2_sum_19.2 * H2O_sum_19.2)]
        ask prey2 [set hydrogens_mass hydrogens_mass - (food_19.2 / num_prey2)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.2b energy_fs
        let fe_19.2b energy_fe

        let CO2_re_r_19.2b ( (1 / 4) * 1000 * fe_19.2b)
        let H2_re_r_19.2b ((1 / 2) * 1000 * fe_19.2b)
        let CO2_rs_r_19.2b ((1 / 5) * 1000 * fs_19.2b)
        let NH4_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let HCO3_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2_rs_r_19.2b ((1 / 2) * 1000 * fs_19.2b)

        let acetate_re_p_19.2b (( 1 / 8) * 1000 * fe_19.2b)
        let H2O_re_p_19.2b ((1 / 4) * 1000 * fe_19.2b)
        let H+_re_p_19.2b ((1 / 8) * 1000 * fe_19.2b)
        let biomass_rs_p_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2O_rs_p_19.2b ((9 / 20) * 1000 * fs_19.2b)

        let H2O_sum_19.2b (H2O_re_p_19.2b + H2O_rs_p_19.2b)
        let H2_sum_19.2b (H2_re_r_19.2b + H2_rs_r_19.2b)
        let H+_sum_19.2b (H+_re_p_19.2b)
        let CO2_sum_19.2b (CO2_re_r_19.2b + CO2_rs_r_19.2b)
        let HCO3_sum_19.2b (HCO3_rs_r_19.2b)
        let acetate_sum_19.2b (acetate_re_p_19.2b)
        let NH4_sum_19.2b (NH4_rs_r_19.2b)
        let biomass_sum_19.2b (biomass_rs_p_19.2b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * biomass_sum_19.2b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * HCO3_sum_19.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * NH4_sum_19.2b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * CO2_sum_19.2b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * acetate_sum_19.2b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * H+_sum_19.2b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey2) / H2_sum_19.2b * H2O_sum_19.2b)]
        ask prey2 [die]
      ]
    ]
]
if initial_concentration_hydrogens >= 0.5 and initial_concentration_acetates < 0.6 and time > 1
[
    let target3 hydrogens in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 2 other target3
    let num_prey3 count prey3
      ifelse (sum [hydrogens_mass] of prey3) > uptake_HAB19
      [
        let food_19.3 min (list uptake_HAB19 [hydrogens_mass] of prey3)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.3 energy_fs
        let fe_19.3 energy_fe

        let CO2_re_r_19.3 ( (1 / 4) * 1000 * fe_19.3)
        let H2_re_r_19.3 ((1 / 2) * 1000 * fe_19.3)
        let CO2_rs_r_19.3 ((1 / 5) * 1000 * fs_19.3)
        let NH4_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let HCO3_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2_rs_r_19.3 ((1 / 2) * 1000 * fs_19.3)

        let acetate_re_p_19.3 (( 1 / 8) * 1000 * fe_19.3)
        let H2O_re_p_19.3 ((1 / 4) * 1000 * fe_19.3)
        let H+_re_p_19.3 ((1 / 8) * 1000 * fe_19.3)
        let biomass_rs_p_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2O_rs_p_19.3 ((9 / 20) * 1000 * fs_19.3)

        let H2O_sum_19.3 (H2O_re_p_19.3 + H2O_rs_p_19.3)
        let H2_sum_19.3 (H2_re_r_19.3 + H2_rs_r_19.3)
        let H+_sum_19.3 (H+_re_p_19.3)
        let CO2_sum_19.3 (CO2_re_r_19.3 + CO2_rs_r_19.3)
        let HCO3_sum_19.3 (HCO3_rs_r_19.3)
        let acetate_sum_19.3 (acetate_re_p_19.3)
        let NH4_sum_19.3 (NH4_rs_r_19.3)
        let biomass_sum_19.3 (biomass_rs_p_19.3)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.3 / H2_sum_19.3 * biomass_sum_19.3)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.3 / H2_sum_19.3 * HCO3_sum_19.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.3 / H2_sum_19.3 * NH4_sum_19.3)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.3 / H2_sum_19.3 * CO2_sum_19.3)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.3 / H2_sum_19.3 * acetate_sum_19.3) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.3 / H2_sum_19.3 * H+_sum_19.3) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.3 / H2_sum_19.3 * H2O_sum_19.3)]
        ask prey3 [set hydrogens_mass hydrogens_mass - (food_19.3 / num_prey3)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.3b energy_fs
        let fe_19.3b energy_fe

        let CO2_re_r_19.3b ( (1 / 4) * 1000 * fe_19.3b)
        let H2_re_r_19.3b ((1 / 2) * 1000 * fe_19.3b)
        let CO2_rs_r_19.3b ((1 / 5) * 1000 * fs_19.3b)
        let NH4_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let HCO3_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2_rs_r_19.3b ((1 / 2) * 1000 * fs_19.3b)

        let acetate_re_p_19.3b (( 1 / 8) * 1000 * fe_19.3b)
        let H2O_re_p_19.3b ((1 / 4) * 1000 * fe_19.3b)
        let H+_re_p_19.3b ((1 / 8) * 1000 * fe_19.3b)
        let biomass_rs_p_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2O_rs_p_19.3b ((9 / 20) * 1000 * fs_19.3b)

        let H2O_sum_19.3b (H2O_re_p_19.3b + H2O_rs_p_19.3b)
        let H2_sum_19.3b (H2_re_r_19.3b + H2_rs_r_19.3b)
        let H+_sum_19.3b (H+_re_p_19.3b)
        let CO2_sum_19.3b (CO2_re_r_19.3b + CO2_rs_r_19.3b)
        let HCO3_sum_19.3b (HCO3_rs_r_19.3b)
        let acetate_sum_19.3b (acetate_re_p_19.3b)
        let NH4_sum_19.3b (NH4_rs_r_19.3b)
        let biomass_sum_19.3b (biomass_rs_p_19.3b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * biomass_sum_19.3b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * HCO3_sum_19.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * NH4_sum_19.3b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * CO2_sum_19.3b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * acetate_sum_19.3b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * H+_sum_19.3b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey3) / H2_sum_19.3b * H2O_sum_19.3b)]
        ask prey3 [die]
      ]
    ]
]
if initial_concentration_acetates >= 0.6 and initial_concentration_acetates < 1 and time > 1
[
    let target4 hydrogens in-radius 50
    if target4 != nobody
    [
      let prey4 up-to-n-of 4 other target4
    let num_prey4 count prey4
      ifelse (sum [hydrogens_mass] of prey4) > uptake_HAB19
      [
        let food_19.4 min (list uptake_HAB19 [hydrogens_mass] of prey4)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.4 energy_fs
        let fe_19.4 energy_fe

        let CO2_re_r_19.4 ( (1 / 4) * 1000 * fe_19.4)
        let H2_re_r_19.4 ((1 / 2) * 1000 * fe_19.4)
        let CO2_rs_r_19.4 ((1 / 5) * 1000 * fs_19.4)
        let NH4_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let HCO3_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2_rs_r_19.4 ((1 / 2) * 1000 * fs_19.4)

        let acetate_re_p_19.4 (( 1 / 8) * 1000 * fe_19.4)
        let H2O_re_p_19.4 ((1 / 4) * 1000 * fe_19.4)
        let H+_re_p_19.4 ((1 / 8) * 1000 * fe_19.4)
        let biomass_rs_p_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2O_rs_p_19.4 ((9 / 20) * 1000 * fs_19.4)

        let H2O_sum_19.4 (H2O_re_p_19.4 + H2O_rs_p_19.4)
        let H2_sum_19.4 (H2_re_r_19.4 + H2_rs_r_19.4)
        let H+_sum_19.4 (H+_re_p_19.4)
        let CO2_sum_19.4 (CO2_re_r_19.4 + CO2_rs_r_19.4)
        let HCO3_sum_19.4 (HCO3_rs_r_19.4)
        let acetate_sum_19.4 (acetate_re_p_19.4)
        let NH4_sum_19.4 (NH4_rs_r_19.4)
        let biomass_sum_19.4 (biomass_rs_p_19.4)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.4 / H2_sum_19.4 * biomass_sum_19.4)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.4 / H2_sum_19.4 * HCO3_sum_19.4)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.4 / H2_sum_19.4 * NH4_sum_19.4)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.4 / H2_sum_19.4 * CO2_sum_19.4)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.4 / H2_sum_19.4 * acetate_sum_19.4) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.4 / H2_sum_19.4 * H+_sum_19.4) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.4 / H2_sum_19.4 * H2O_sum_19.4)]
        ask prey4 [set hydrogens_mass hydrogens_mass - (food_19.4 / num_prey4)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.4b energy_fs
        let fe_19.4b energy_fe

        let CO2_re_r_19.4b ( (1 / 4) * 1000 * fe_19.4b)
        let H2_re_r_19.4b ((1 / 2) * 1000 * fe_19.4b)
        let CO2_rs_r_19.4b ((1 / 5) * 1000 * fs_19.4b)
        let NH4_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let HCO3_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2_rs_r_19.4b ((1 / 2) * 1000 * fs_19.4b)

        let acetate_re_p_19.4b (( 1 / 8) * 1000 * fe_19.4b)
        let H2O_re_p_19.4b ((1 / 4) * 1000 * fe_19.4b)
        let H+_re_p_19.4b ((1 / 8) * 1000 * fe_19.4b)
        let biomass_rs_p_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2O_rs_p_19.4b ((9 / 20) * 1000 * fs_19.4b)

        let H2O_sum_19.4b (H2O_re_p_19.4b + H2O_rs_p_19.4b)
        let H2_sum_19.4b (H2_re_r_19.4b + H2_rs_r_19.4b)
        let H+_sum_19.4b (H+_re_p_19.4b)
        let CO2_sum_19.4b (CO2_re_r_19.4b + CO2_rs_r_19.4b)
        let HCO3_sum_19.4b (HCO3_rs_r_19.4b)
        let acetate_sum_19.4b (acetate_re_p_19.4b)
        let NH4_sum_19.4b (NH4_rs_r_19.4b)
        let biomass_sum_19.4b (biomass_rs_p_19.4b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * biomass_sum_19.4b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * HCO3_sum_19.4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * NH4_sum_19.4b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * CO2_sum_19.4b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * acetate_sum_19.4b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * H+_sum_19.4b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey4) / H2_sum_19.4b * H2O_sum_19.4b)]
        ask prey4 [die]
      ]
    ]
]
if initial_concentration_acetates >= 1 and initial_concentration_acetates < 2 and time > 1
[
    let target5 hydrogens in-radius 50
    if target5 != nobody
    [
      let prey5 up-to-n-of 7 other target5
    let num_prey5 count prey5
      ifelse (sum [hydrogens_mass] of prey5) > uptake_HAB19
      [
        let food_19.5 min (list uptake_HAB19 [hydrogens_mass] of prey5)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5 energy_fs
        let fe_19.5 energy_fe

        let CO2_re_r_19.5 ( (1 / 4) * 1000 * fe_19.5)
        let H2_re_r_19.5 ((1 / 2) * 1000 * fe_19.5)
        let CO2_rs_r_19.5 ((1 / 5) * 1000 * fs_19.5)
        let NH4_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let HCO3_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2_rs_r_19.5 ((1 / 2) * 1000 * fs_19.5)

        let acetate_re_p_19.5 (( 1 / 8) * 1000 * fe_19.5)
        let H2O_re_p_19.5 ((1 / 4) * 1000 * fe_19.5)
        let H+_re_p_19.5 ((1 / 8) * 1000 * fe_19.5)
        let biomass_rs_p_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2O_rs_p_19.5 ((9 / 20) * 1000 * fs_19.5)

        let H2O_sum_19.5 (H2O_re_p_19.5 + H2O_rs_p_19.5)
        let H2_sum_19.5 (H2_re_r_19.5 + H2_rs_r_19.5)
        let H+_sum_19.5 (H+_re_p_19.5)
        let CO2_sum_19.5 (CO2_re_r_19.5 + CO2_rs_r_19.5)
        let HCO3_sum_19.5 (HCO3_rs_r_19.5)
        let acetate_sum_19.5 (acetate_re_p_19.5)
        let NH4_sum_19.5 (NH4_rs_r_19.5)
        let biomass_sum_19.5 (biomass_rs_p_19.5)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.5 / H2_sum_19.5 * biomass_sum_19.5)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.5 / H2_sum_19.5 * HCO3_sum_19.5)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.5 / H2_sum_19.5 * NH4_sum_19.5)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.5 / H2_sum_19.5 * CO2_sum_19.5)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.5 / H2_sum_19.5 * acetate_sum_19.5) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.5 / H2_sum_19.5 * H+_sum_19.5) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.5 / H2_sum_19.5 * H2O_sum_19.5)]
        ask prey5 [set hydrogens_mass hydrogens_mass - (food_19.5 / num_prey5)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5b energy_fs
        let fe_19.5b energy_fe

        let CO2_re_r_19.5b ( (1 / 4) * 1000 * fe_19.5b)
        let H2_re_r_19.5b ((1 / 2) * 1000 * fe_19.5b)
        let CO2_rs_r_19.5b ((1 / 5) * 1000 * fs_19.5b)
        let NH4_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let HCO3_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2_rs_r_19.5b ((1 / 2) * 1000 * fs_19.5b)

        let acetate_re_p_19.5b (( 1 / 8) * 1000 * fe_19.5b)
        let H2O_re_p_19.5b ((1 / 4) * 1000 * fe_19.5b)
        let H+_re_p_19.5b ((1 / 8) * 1000 * fe_19.5b)
        let biomass_rs_p_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2O_rs_p_19.5b ((9 / 20) * 1000 * fs_19.5b)

        let H2O_sum_19.5b (H2O_re_p_19.5b + H2O_rs_p_19.5b)
        let H2_sum_19.5b (H2_re_r_19.5b + H2_rs_r_19.5b)
        let H+_sum_19.5b (H+_re_p_19.5b)
        let CO2_sum_19.5b (CO2_re_r_19.5b + CO2_rs_r_19.5b)
        let HCO3_sum_19.5b (HCO3_rs_r_19.5b)
        let acetate_sum_19.5b (acetate_re_p_19.5b)
        let NH4_sum_19.5b (NH4_rs_r_19.5b)
        let biomass_sum_19.5b (biomass_rs_p_19.5b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * biomass_sum_19.5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * HCO3_sum_19.5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * NH4_sum_19.5b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * CO2_sum_19.5b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * acetate_sum_19.5b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * H+_sum_19.5b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey5) / H2_sum_19.5b * H2O_sum_19.5b)]
        ask prey5 [die]
      ]
    ]
]
if initial_concentration_acetates >= 2 and initial_concentration_acetates < 3 and time > 1
[
    let target6 hydrogens in-radius 50
    if target6 != nobody
    [
      let prey6 up-to-n-of 8 other target6
    let num_prey6 count prey6
      ifelse (sum [hydrogens_mass] of prey6) > uptake_HAB19
      [
        let food_19.6 min (list uptake_HAB19 [hydrogens_mass] of prey6)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6 energy_fs
        let fe_19.6 energy_fe

        let CO2_re_r_19.6 ( (1 / 4) * 1000 * fe_19.6)
        let H2_re_r_19.6 ((1 / 2) * 1000 * fe_19.6)
        let CO2_rs_r_19.6 ((1 / 5) * 1000 * fs_19.6)
        let NH4_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let HCO3_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2_rs_r_19.6 ((1 / 2) * 1000 * fs_19.6)

        let acetate_re_p_19.6 (( 1 / 8) * 1000 * fe_19.6)
        let H2O_re_p_19.6 ((1 / 4) * 1000 * fe_19.6)
        let H+_re_p_19.6 ((1 / 8) * 1000 * fe_19.6)
        let biomass_rs_p_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2O_rs_p_19.6 ((9 / 20) * 1000 * fs_19.6)

        let H2O_sum_19.6 (H2O_re_p_19.6 + H2O_rs_p_19.6)
        let H2_sum_19.6 (H2_re_r_19.6 + H2_rs_r_19.6)
        let H+_sum_19.6 (H+_re_p_19.6)
        let CO2_sum_19.6 (CO2_re_r_19.6 + CO2_rs_r_19.6)
        let HCO3_sum_19.6 (HCO3_rs_r_19.6)
        let acetate_sum_19.6 (acetate_re_p_19.6)
        let NH4_sum_19.6 (NH4_rs_r_19.6)
        let biomass_sum_19.6 (biomass_rs_p_19.6)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.6 / H2_sum_19.6 * biomass_sum_19.6)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.6 / H2_sum_19.6 * HCO3_sum_19.6)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.6 / H2_sum_19.6 * NH4_sum_19.6)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.6 / H2_sum_19.6 * CO2_sum_19.6)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.6 / H2_sum_19.6 * acetate_sum_19.6) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.6 / H2_sum_19.6 * H+_sum_19.6) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.6 / H2_sum_19.6 * H2O_sum_19.6)]
        ask prey6 [set hydrogens_mass hydrogens_mass - (food_19.6 / num_prey6)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6b energy_fs
        let fe_19.6b energy_fe

        let CO2_re_r_19.6b ( (1 / 4) * 1000 * fe_19.6b)
        let H2_re_r_19.6b ((1 / 2) * 1000 * fe_19.6b)
        let CO2_rs_r_19.6b ((1 / 5) * 1000 * fs_19.6b)
        let NH4_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let HCO3_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2_rs_r_19.6b ((1 / 2) * 1000 * fs_19.6b)

        let acetate_re_p_19.6b (( 1 / 8) * 1000 * fe_19.6b)
        let H2O_re_p_19.6b ((1 / 4) * 1000 * fe_19.6b)
        let H+_re_p_19.6b ((1 / 8) * 1000 * fe_19.6b)
        let biomass_rs_p_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2O_rs_p_19.6b ((9 / 20) * 1000 * fs_19.6b)

        let H2O_sum_19.6b (H2O_re_p_19.6b + H2O_rs_p_19.6b)
        let H2_sum_19.6b (H2_re_r_19.6b + H2_rs_r_19.6b)
        let H+_sum_19.6b (H+_re_p_19.6b)
        let CO2_sum_19.6b (CO2_re_r_19.6b + CO2_rs_r_19.6b)
        let HCO3_sum_19.6b (HCO3_rs_r_19.6b)
        let acetate_sum_19.6b (acetate_re_p_19.6b)
        let NH4_sum_19.6b (NH4_rs_r_19.6b)
        let biomass_sum_19.6b (biomass_rs_p_19.6b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * biomass_sum_19.6b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * HCO3_sum_19.6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * NH4_sum_19.6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * CO2_sum_19.6b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * acetate_sum_19.6b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * H+_sum_19.6b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey6) / H2_sum_19.6b * H2O_sum_19.6b)]
        ask prey6 [die]
      ]
    ]
]
if initial_concentration_acetates >= 3 and time > 1
[
    let target7 hydrogens in-radius 50
    if target7 != nobody
    [
      let prey7 up-to-n-of 15 other target7
    let num_prey7 count prey7
      ifelse (sum [hydrogens_mass] of prey7) > uptake_HAB19
      [
        let food_19.7 min (list uptake_HAB19 [hydrogens_mass] of prey7)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7 energy_fs
        let fe_19.7 energy_fe

        let CO2_re_r_19.7 ( (1 / 4) * 1000 * fe_19.7)
        let H2_re_r_19.7 ((1 / 2) * 1000 * fe_19.7)
        let CO2_rs_r_19.7 ((1 / 5) * 1000 * fs_19.7)
        let NH4_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let HCO3_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2_rs_r_19.7 ((1 / 2) * 1000 * fs_19.7)

        let acetate_re_p_19.7 (( 1 / 8) * 1000 * fe_19.7)
        let H2O_re_p_19.7 ((1 / 4) * 1000 * fe_19.7)
        let H+_re_p_19.7 ((1 / 8) * 1000 * fe_19.7)
        let biomass_rs_p_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2O_rs_p_19.7 ((9 / 20) * 1000 * fs_19.7)

        let H2O_sum_19.7 (H2O_re_p_19.7 + H2O_rs_p_19.7)
        let H2_sum_19.7 (H2_re_r_19.7 + H2_rs_r_19.7)
        let H+_sum_19.7 (H+_re_p_19.7)
        let CO2_sum_19.7 (CO2_re_r_19.7 + CO2_rs_r_19.7)
        let HCO3_sum_19.7 (HCO3_rs_r_19.7)
        let acetate_sum_19.7 (acetate_re_p_19.7)
        let NH4_sum_19.7 (NH4_rs_r_19.7)
        let biomass_sum_19.7 (biomass_rs_p_19.7)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.7 / H2_sum_19.7 * biomass_sum_19.7)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.7 / H2_sum_19.7 * HCO3_sum_19.7)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.7 / H2_sum_19.7 * NH4_sum_19.7)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.7 / H2_sum_19.7 * CO2_sum_19.7)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.7 / H2_sum_19.7 * acetate_sum_19.7) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.7 / H2_sum_19.7 * H+_sum_19.7) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.7 / H2_sum_19.7 * H2O_sum_19.7)]
        ask prey7 [set hydrogens_mass hydrogens_mass - (food_19.7 / num_prey7)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7b energy_fs
        let fe_19.7b energy_fe

        let CO2_re_r_19.7b ( (1 / 4) * 1000 * fe_19.7b)
        let H2_re_r_19.7b ((1 / 2) * 1000 * fe_19.7b)
        let CO2_rs_r_19.7b ((1 / 5) * 1000 * fs_19.7b)
        let NH4_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let HCO3_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2_rs_r_19.7b ((1 / 2) * 1000 * fs_19.7b)

        let acetate_re_p_19.7b (( 1 / 8) * 1000 * fe_19.7b)
        let H2O_re_p_19.7b ((1 / 4) * 1000 * fe_19.7b)
        let H+_re_p_19.7b ((1 / 8) * 1000 * fe_19.7b)
        let biomass_rs_p_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2O_rs_p_19.7b ((9 / 20) * 1000 * fs_19.7b)

        let H2O_sum_19.7b (H2O_re_p_19.7b + H2O_rs_p_19.7b)
        let H2_sum_19.7b (H2_re_r_19.7b + H2_rs_r_19.7b)
        let H+_sum_19.7b (H+_re_p_19.7b)
        let CO2_sum_19.7b (CO2_re_r_19.7b + CO2_rs_r_19.7b)
        let HCO3_sum_19.7b (HCO3_rs_r_19.7b)
        let acetate_sum_19.7b (acetate_re_p_19.7b)
        let NH4_sum_19.7b (NH4_rs_r_19.7b)
        let biomass_sum_19.7b (biomass_rs_p_19.7b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * biomass_sum_19.7b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * HCO3_sum_19.7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * NH4_sum_19.7b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * CO2_sum_19.7b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * acetate_sum_19.7b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * H+_sum_19.7b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey7) / H2_sum_19.7b * H2O_sum_19.7b)]
        ask prey7 [die]
      ]
    ]
]
  if initial_concentration_hydrogens >= 0.6 and time > 1
[
    let target8 hydrogens in-radius 50
    if target8 != nobody
    [
      let prey8 up-to-n-of 20 other target8
    let num_prey8 count prey8
      ifelse (sum [hydrogens_mass] of prey8) > uptake_HAB19
      [
        let food_19.8 min (list uptake_HAB19 [hydrogens_mass] of prey8)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.8 energy_fs
        let fe_19.8 energy_fe

        let CO2_re_r_19.8 ( (1 / 4) * 1000 * fe_19.8)
        let H2_re_r_19.8 ((1 / 2) * 1000 * fe_19.8)
        let CO2_rs_r_19.8 ((1 / 5) * 1000 * fs_19.8)
        let NH4_rs_r_19.8 ((1 / 20) * 1000 * fs_19.8)
        let HCO3_rs_r_19.8 ((1 / 20) * 1000 * fs_19.8)
        let H2_rs_r_19.8 ((1 / 2) * 1000 * fs_19.8)

        let acetate_re_p_19.8 (( 1 / 8) * 1000 * fe_19.8)
        let H2O_re_p_19.8 ((1 / 4) * 1000 * fe_19.8)
        let H+_re_p_19.8 ((1 / 8) * 1000 * fe_19.8)
        let biomass_rs_p_19.8 ((1 / 20) * 1000 * fs_19.8)
        let H2O_rs_p_19.8 ((9 / 20) * 1000 * fs_19.8)

        let H2O_sum_19.8 (H2O_re_p_19.8 + H2O_rs_p_19.8)
        let H2_sum_19.8 (H2_re_r_19.8 + H2_rs_r_19.8)
        let H+_sum_19.8 (H+_re_p_19.8)
        let CO2_sum_19.8 (CO2_re_r_19.8 + CO2_rs_r_19.8)
        let HCO3_sum_19.8 (HCO3_rs_r_19.8)
        let acetate_sum_19.8 (acetate_re_p_19.8)
        let NH4_sum_19.8 (NH4_rs_r_19.8)
        let biomass_sum_19.8 (biomass_rs_p_19.8)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + (food_19.8 / H2_sum_19.8 * biomass_sum_19.8)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.8 / H2_sum_19.8 * HCO3_sum_19.8)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.8 / H2_sum_19.8 * NH4_sum_19.8)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.8 / H2_sum_19.8 * CO2_sum_19.8)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.8 / H2_sum_19.8 * acetate_sum_19.8) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.8 / H2_sum_19.8 * H+_sum_19.8) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.8 / H2_sum_19.8 * H2O_sum_19.8)]
        ask prey8 [set hydrogens_mass hydrogens_mass - (food_19.8 / num_prey8)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.8b energy_fs
        let fe_19.8b energy_fe

        let CO2_re_r_19.8b ( (1 / 4) * 1000 * fe_19.8b)
        let H2_re_r_19.8b ((1 / 2) * 1000 * fe_19.8b)
        let CO2_rs_r_19.8b ((1 / 5) * 1000 * fs_19.8b)
        let NH4_rs_r_19.8b ((1 / 20) * 1000 * fs_19.8b)
        let HCO3_rs_r_19.8b ((1 / 20) * 1000 * fs_19.8b)
        let H2_rs_r_19.8b ((1 / 2) * 1000 * fs_19.8b)

        let acetate_re_p_19.8b (( 1 / 8) * 1000 * fe_19.8b)
        let H2O_re_p_19.8b ((1 / 4) * 1000 * fe_19.8b)
        let H+_re_p_19.8b ((1 / 8) * 1000 * fe_19.8b)
        let biomass_rs_p_19.8b ((1 / 20) * 1000 * fs_19.8b)
        let H2O_rs_p_19.8b ((9 / 20) * 1000 * fs_19.8b)

        let H2O_sum_19.8b (H2O_re_p_19.8b + H2O_rs_p_19.8b)
        let H2_sum_19.8b (H2_re_r_19.8b + H2_rs_r_19.8b)
        let H+_sum_19.8b (H+_re_p_19.8b)
        let CO2_sum_19.8b (CO2_re_r_19.8b + CO2_rs_r_19.8b)
        let HCO3_sum_19.8b (HCO3_rs_r_19.8b)
        let acetate_sum_19.8b (acetate_re_p_19.8b)
        let NH4_sum_19.8b (NH4_rs_r_19.8b)
        let biomass_sum_19.8b (biomass_rs_p_19.8b)

        set C.aceticum_HAB19_mass C.aceticum_HAB19_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * biomass_sum_19.8b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * HCO3_sum_19.8b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * NH4_sum_19.8b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * CO2_sum_19.8b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * acetate_sum_19.8b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * H+_sum_19.8b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey8) / H2_sum_19.8b * H2O_sum_19.8b)]
        ask prey8 [die]
      ]
    ]
]
end

to reproduce_HAB19
  if C.aceticum_HAB19_mass > 1
  [
  set C.aceticum_HAB19_mass (C.aceticum_HAB19_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_HAB19 0.1876
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_HAB19
  set C.aceticum_HAB19_mass (C.aceticum_HAB19_mass - C.aceticum_HAB19_mass * (0.015 / 24))
end




;;; HYDROGEN-PRODUCING BACTERIA;;;

;;;CLOSTRIDIUM FB5/HPB20;;; For Equation 5 and Equation 20

to FB5/HPB20_eat_glucose_or_acetate;; Clostridium Ultunense procedure ;; maximum uptake rate is up to 0.0207 mmol/mmmol h when consuming glucose for Clostridium aceticum based on Lin et al., 2007 and maximum uptake rate is up to 0.9 mmol/mmmol d so... 0.0375 mmol/mmol h for acetate from Qu et al., 2009.
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
    let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB5
      [
        let food_5 min (list uptake_FB5 [glucose_mass] of prey)
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5 energy_fs
        let fe_5 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_5)
        let H2O_re_r ((1 / 12) * 1000 * fe_5)
        let NH4_rs_r ((1 / 20) * 1000 * fs_5)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_5)
        let glucose_rs_r ((1 / 24) * 1000 * fs_5)

        let acetate_re_p ((1 / 12) * 1000 * fe_5)
        let CO2s_re_p ((1 / 12) * 1000 * fe_5)
        let H2_re_p ((1 / 6) * 1000 * fe_5)
        let H+_re_p ((1 / 12) * 1000 * fe_5)
        let biomass_rs_p ((1 / 20) * 1000 * fs_5)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_5)
        let H2O_rs_p ((1 / 5) * 1000 * fs_5)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set C.ultunense_FB5/HPB20_mass C.ultunense_FB5/HPB20_mass + (food_5 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_5 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_5 / glucose_sum * NH4_sum)]
        ask n-of 1 patches [set pcolor black set moles moles - (food_5 / glucose_sum * H2O_sum)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_5 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_5 / glucose_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_5 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_5 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_5 / num_prey)]
      ]
      [
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5b energy_fs
        let fe_5b energy_fe

        let glucose_re_r_5b ((1 / 24) * 1000 * fe_5b)
        let H2O_re_r_5b ((1 / 12) * 1000 * fe_5b)
        let NH4_rs_r_5b ((1 / 20) * 1000 * fs_5b)
        let HCO3_rs_r_5b ((1 / 20) * 1000 * fs_5b)
        let glucose_rs_r_5b ((1 / 24) * 1000 * fs_5b)

        let acetate_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let CO2s_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let H2_re_p_5b ((1 / 6) * 1000 * fe_5b)
        let H+_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let biomass_rs_p_5b ((1 / 20) * 1000 * fs_5b)
        let CO2_rs_p_5b ( (1 / 20) * 1000 * fs_5b)
        let H2O_rs_p_5b ((1 / 5) * 1000 * fs_5b)

        let H2O_sum_5b (H2O_rs_p_5b - H2O_re_r_5b)
        let H2_sum_5b (H2_re_p_5b)
        let H+_sum_5b (H+_re_p_5b)
        let CO2_sum_5b (CO2s_re_p_5b + CO2_rs_p_5b)
        let HCO3_sum_5b (HCO3_rs_r_5b)
        let acetates_sum_5b (acetate_re_p_5b)
        let glucose_sum_5b (glucose_re_r_5b + glucose_rs_r_5b)
        let NH4_sum_5b (NH4_rs_r_5b)
        let biomass_sum_5b (biomass_rs_p_5b)

        set C.ultunense_FB5/HPB20_mass C.ultunense_FB5/HPB20_mass + (( sum [glucose_mass] of prey) / glucose_sum_5b * biomass_sum_5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * HCO3_sum_5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * NH4_sum_5b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_5b * H2O_sum_5b)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * CO2_sum_5b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * acetates_sum_5b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H2_sum_5b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H+_sum_5b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]
  if Initial_concentration_acetates > 1 and temp > 323.15 and initial_concentration_hydrogens <= 0.4 and time > 1
  [
  let target2 acetates in-radius 2
    if target2 != nobody
    [
      let prey2  up-to-n-of 4 other target2
    let num_prey2 count prey2
      ifelse (sum [acetates_mass] of prey2) > uptake_HPB20
      [
        let food_20 min (list uptake_HPB20 [acetates_mass] of prey2)
        set Gr_2 (13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2))) / (Initial_concentration_acetates ^ (1 / 8) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_20 energy_fs
        let fe_20 energy_fe

        let acetate_re_r_20 ((1 / 8) * 1000 * fe_20)
        let H2O_re_r_20 ((1 / 4) * 1000 * fe_20)
        let H+_re_r_20 ((1 / 8) * 1000 * fe_20)
        let acetate_rs_r_20 ((1 / 8) * 1000 * fs_20)
        let NH4_rs_r_20 ((1 / 20) * 1000 * fs_20)
        let HCO3_rs_r_20 ((1 / 20) * 1000 * fs_20)
        let H+_rs_r_20 ((1 / 8) * 1000 * fs_20)

        let CO2s_re_p_20 ((1 / 4) * 1000 * fe_20)
        let H2_re_p_20 ((1 / 2) * 1000 * fe_20)
        let biomass_rs_p_20 ((1 / 20) * 1000 * fs_20)
        let CO2_rs_p_20 ( (1 / 20) * 1000 * fs_20)
        let H2O_rs_p_20 ((1 / 5) * 1000 * fs_20)

        let H2O_sum_20 (H2O_rs_p_20 - H2O_re_r_20)
        let H2_sum_20 (H2_re_p_20)
        let H+_sum_20 (H+_re_r_20 + H+_rs_r_20)
        let CO2_sum_20 (CO2s_re_p_20 + CO2_rs_p_20)
        let HCO3_sum_20 (HCO3_rs_r_20)
        let acetates_sum_20 (acetate_re_r_20 + acetate_rs_r_20)
        let NH4_sum_20 (NH4_rs_r_20)
        let biomass_sum_20 (biomass_rs_p_20)

        set C.ultunense_FB5/HPB20_mass C.ultunense_FB5/HPB20_mass + (food_20 / acetates_sum_20 * biomass_sum_20)
        ask one-of protons [set protons_mass protons_mass - (food_20 / acetates_sum_20 * H+_sum_20)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_20 / acetates_sum_20 * NH4_sum_20)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_20 / acetates_sum_20 * HCO3_sum_20)]
        ask n-of 1 patches [set pcolor black set moles moles - (food_20 / acetates_sum_20 * H2O_sum_20)]
        if moles = 0 [die]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass Hydrogens_mass + (food_20 / acetates_sum_20 * H2_sum_20) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_20 / acetates_sum_20 * CO2_sum_20) right random 360 fd 3]
        ask prey2 [set acetates_mass acetates_mass - (food_20 / num_prey2)]
      ]
      [
        set Gr_2 (13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2))) / (Initial_concentration_acetates ^ (1 / 8) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8)))))
       set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_20b energy_fs
        let fe_20b energy_fe

        let acetate_re_r_20b ((1 / 8) * 1000 * fe_20b)
        let H2O_re_r_20b ((1 / 4) * 1000 * fe_20b)
        let H+_re_r_20b ((1 / 8) * 1000 * fe_20b)
        let acetate_rs_r_20b ((1 / 8) * 1000 * fs_20b)
        let NH4_rs_r_20b ((1 / 20) * 1000 * fs_20b)
        let HCO3_rs_r_20b ((1 / 20) * 1000 * fs_20b)
        let H+_rs_r_20b ((1 / 8) * 1000 * fs_20b)

        let CO2s_re_p_20b ((1 / 4) * 1000 * fe_20b)
        let H2_re_p_20b ((1 / 2) * 1000 * fe_20b)
        let biomass_rs_p_20b ((1 / 20) * 1000 * fs_20b)
        let CO2_rs_p_20b (( 1 / 20) * 1000 * fs_20b)
        let H2O_rs_p_20b ((1 / 5) * 1000 * fs_20b)

        let H2O_sum_20b (H2O_rs_p_20b - H2O_re_r_20b)
        let H2_sum_20b (H2_re_p_20b)
        let H+_sum_20b (H+_re_r_20b + H+_rs_r_20b)
        let CO2_sum_20b (CO2s_re_p_20b + CO2_rs_p_20b)
        let HCO3_sum_20b (HCO3_rs_r_20b)
        let acetates_sum_20b (acetate_re_r_20b + acetate_rs_r_20b)
        let NH4_sum_20b (NH4_rs_r_20b)
        let biomass_sum_20b (biomass_rs_p_20b)

        set C.ultunense_FB5/HPB20_mass C.ultunense_FB5/HPB20_mass + ((sum [acetates_mass] of prey2) / acetates_sum_20b * biomass_sum_20b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey2) / acetates_sum_20b * H+_sum_20b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey2) / acetates_sum_20b * NH4_sum_20b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey2) / acetates_sum_20b * HCO3_sum_20b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [acetates_mass] of prey2) / acetates_sum_20b * H2O_sum_20b)]
        if moles = 0 [die]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass Hydrogens_mass + ((sum [acetates_mass] of prey2) / acetates_sum_20b * H2_sum_20b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey2) / acetates_sum_20b * CO2_sum_20b) right random 360 fd 3]
        ask prey2 [die]
      ]
    ]
  ]

end

to reproduce_FB5/HPB20
  if C.ultunense_FB5/HPB20_mass > 1
  [
  set C.ultunense_FB5/HPB20_mass (C.ultunense_FB5/HPB20_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB5 0.0207
  set uptake_HPB20 0.0375
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB5/HPB20
  set C.ultunense_FB5/HPB20_mass (C.ultunense_FB5/HPB20_mass - C.ultunense_FB5/HPB20_mass * (0.019 / 24)) ;; Represents decay rate per hour based on Jeyaseelan, 1997 and Muller et al., 2013
end

;;; CLOSTRIDIUM FB5/HAB19;;; For Equation 5 and Equation 19


to CA_FB5/HAB19_eat_glucose_or_hydrogen;; Clostridium procedure ;; maximum uptake rate is up to 0.0207 mmol/mmmol h when consuming glucose and up to 0.9887 mmol/mmol h when consuming hydrogen for Clostridium aceticum based on Lin et al., 2007; Saady, 2013 and Amani et al., 2010
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glucose in-radius 2
    if target != nobody
    [
      let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB5
      [
        let food_5 min (list uptake_FB5 [glucose_mass] of prey)
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5 energy_fs
        let fe_5 energy_fe

        let glucose_re_r ((1 / 24) * 1000 * fe_5)
        let H2O_re_r ((1 / 12) * 1000 * fe_5)
        let NH4_rs_r ((1 / 20) * 1000 * fs_5)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_5)
        let glucose_rs_r ((1 / 24) * 1000 * fs_5)

        let acetate_re_p ((1 / 12) * 1000 * fe_5)
        let CO2s_re_p ((1 / 12) * 1000 * fe_5)
        let H2_re_p ((1 / 6) * 1000 * fe_5)
        let H+_re_p ((1 / 12) * 1000 * fe_5)
        let biomass_rs_p ((1 / 20) * 1000 * fs_5)
        let CO2_rs_p ( (1 / 20) * 1000 * fs_5)
        let H2O_rs_p ((1 / 5) * 1000 * fs_5)

        let H2O_sum (H2O_rs_p - H2O_re_r)
        let H2_sum (H2_re_p)
        let H+_sum (H+_re_p)
        let CO2_sum (CO2s_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let acetates_sum (acetate_re_p)
        let glucose_sum (glucose_re_r + glucose_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_5 / glucose_sum * biomass_sum)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_5 / glucose_sum * HCO3_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_5 / glucose_sum * NH4_sum)]
        ask n-of 1 patches [set pcolor black set moles moles - (food_5 / glucose_sum * H2O_sum)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_5 / glucose_sum * CO2_sum) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_5 / glucose_sum * acetates_sum) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_5 / glucose_sum * H2_sum) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_5 / glucose_sum * H+_sum) right random 360 fd 4]
        ask prey [set glucose_mass glucose_mass - (food_5 / num_prey)]
      ]
      [
        set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
        set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_5b energy_fs
        let fe_5b energy_fe

       let glucose_re_r_5b ((1 / 24) * 1000 * fe_5b)
        let H2O_re_r_5b ((1 / 12) * 1000 * fe_5b)
        let NH4_rs_r_5b ((1 / 20) * 1000 * fs_5b)
        let HCO3_rs_r_5b ((1 / 20 )* 1000 * fs_5b)
        let glucose_rs_r_5b ((1 / 24) * 1000 * fs_5b)

        let acetate_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let CO2s_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let H2_re_p_5b ((1 / 6) * 1000 * fe_5b)
        let H+_re_p_5b ((1 / 12) * 1000 * fe_5b)
        let biomass_rs_p_5b ((1 / 20) * 1000 * fs_5b)
        let CO2_rs_p_5b ( (1 / 20) * 1000 * fs_5b)
        let H2O_rs_p_5b ((1 / 5) * 1000 * fs_5b)

        let H2O_sum_5b (H2O_rs_p_5b - H2O_re_r_5b)
        let H2_sum_5b (H2_re_p_5b)
        let H+_sum_5b (H+_re_p_5b)
        let CO2_sum_5b (CO2s_re_p_5b + CO2_rs_p_5b)
        let HCO3_sum_5b (HCO3_rs_r_5b)
        let acetates_sum_5b (acetate_re_p_5b)
        let glucose_sum_5b (glucose_re_r_5b + glucose_rs_r_5b)
        let NH4_sum_5b (NH4_rs_r_5b)
        let biomass_sum_5b (biomass_rs_p_5b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * biomass_sum_5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * HCO3_sum_5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * NH4_sum_5b)]
        ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_5b * H2O_sum_5b)]
        if moles = 0 [die]
        hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * CO2_sum_5b) right random 360 fd 2]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * acetates_sum_5b) rt random 360 fd 1]
        hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H2_sum_5b) right random 360 fd 3]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H+_sum_5b) right random 360 fd 4]
        ask prey [die]
      ]
    ]
  ]
if initial_concentration_acetates < 0.3 and temp > 293.15 and time > 1
  [
    let target2 hydrogens in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 12 other target2
      let num_prey2 count prey2
      ifelse (sum [hydrogens_mass] of prey2) > uptake_HAB19
      [
        let food_19 min (list uptake_HAB19 [hydrogens_mass] of prey2)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19 energy_fs
        let fe_19 energy_fe

        let CO2_re_r_19 ( (1 / 4) * 1000 * fe_19)
        let H2_re_r_19 ((1 / 2) * 1000 * fe_19)
        let CO2_rs_r_19 ((1 / 5) * 1000 * fs_19)
        let NH4_rs_r_19 ((1 / 20) * 1000 * fs_19)
        let HCO3_rs_r_19 ((1 / 20) * 1000 * fs_19)
        let H2_rs_r_19 ((1 / 2) * 1000 * fs_19)

        let acetate_re_p_19 (( 1 / 8) * 1000 * fe_19)
        let H2O_re_p_19 ((1 / 4) * 1000 * fe_19)
        let H+_re_p_19 ((1 / 8) * 1000 * fe_19)
        let biomass_rs_p_19 ((1 / 20) * 1000 * fs_19)
        let H2O_rs_p_19 ((9 / 20) * 1000 * fs_19)

        let H2O_sum_19 (H2O_re_p_19 + H2O_rs_p_19)
        let H2_sum_19 (H2_re_r_19 + H2_rs_r_19)
        let H+_sum_19 (H+_re_p_19)
        let CO2_sum_19 (CO2_re_r_19 + CO2_rs_r_19)
        let HCO3_sum_19 (HCO3_rs_r_19)
        let acetate_sum_19 (acetate_re_p_19)
        let NH4_sum_19 (NH4_rs_r_19)
        let biomass_sum_19 (biomass_rs_p_19)


        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19 / H2_sum_19 * biomass_sum_19)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19 / H2_sum_19 * HCO3_sum_19)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19 / H2_sum_19 * NH4_sum_19)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19 / H2_sum_19 * CO2_sum_19)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19 / H2_sum_19 * acetate_sum_19) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19 / H2_sum_19 * H+_sum_19) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19 / H2_sum_19 * H2O_sum_19)]
        ask prey2 [set hydrogens_mass hydrogens_mass - (food_19 / num_prey2)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19b energy_fs
        let fe_19b energy_fe

        let CO2_re_r_19b ( (1 / 4) * 1000 * fe_19b)
        let H2_re_r_19b ((1 / 2) * 1000 * fe_19b)
        let CO2_rs_r_19b ((1 / 5) * 1000 * fs_19b)
        let NH4_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let HCO3_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let H2_rs_r_19b ((1 / 2) * 1000 * fs_19b)

        let acetate_re_p_19b (( 1 / 8) * 1000 * fe_19b)
        let H2O_re_p_19b ((1 / 4) * 1000 * fe_19b)
        let H+_re_p_19b ((1 / 8) * 1000 * fe_19b)
        let biomass_rs_p_19b ((1 / 20) * 1000 * fs_19b)
        let H2O_rs_p_19b ((9 / 20) * 1000 * fs_19b)

        let H2O_sum_19b (H2O_re_p_19b + H2O_rs_p_19b)
        let H2_sum_19b (H2_re_r_19b + H2_rs_r_19b)
        let H+_sum_19b (H+_re_p_19b)
        let CO2_sum_19b (CO2_re_r_19b + CO2_rs_r_19b)
        let HCO3_sum_19b (HCO3_rs_r_19b)
        let acetate_sum_19b (acetate_re_p_19b)
        let NH4_sum_19b (NH4_rs_r_19b)
        let biomass_sum_19b (biomass_rs_p_19b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * biomass_sum_19b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * HCO3_sum_19b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * NH4_sum_19b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * CO2_sum_19b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * acetate_sum_19b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * H+_sum_19b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * H2O_sum_19b)]
        ask prey2 [die]
      ]
    ]
]
if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and temp > 293.15 and time > 1
  [
    let target3 hydrogens in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 1 other target3
      let num_prey3 count prey3
      ifelse (sum [hydrogens_mass] of prey3) > uptake_HAB19
      [
        let food_19.2 min (list uptake_HAB19 [hydrogens_mass] of prey3)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.2 energy_fs
        let fe_19.2 energy_fe

        let CO2_re_r_19.2 ( (1 / 4) * 1000 * fe_19.2)
        let H2_re_r_19.2 ((1 / 2) * 1000 * fe_19.2)
        let CO2_rs_r_19.2 ((1 / 5) * 1000 * fs_19.2)
        let NH4_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let HCO3_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2_rs_r_19.2 ((1 / 2) * 1000 * fs_19.2)

        let acetate_re_p_19.2 (( 1 / 8) * 1000 * fe_19.2)
        let H2O_re_p_19.2 ((1 / 4) * 1000 * fe_19.2)
        let H+_re_p_19.2 ((1 / 8) * 1000 * fe_19.2)
        let biomass_rs_p_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2O_rs_p_19.2 ((9 / 20) * 1000 * fs_19.2)

        let H2O_sum_19.2 (H2O_re_p_19.2 + H2O_rs_p_19.2)
        let H2_sum_19.2 (H2_re_r_19.2 + H2_rs_r_19.2)
        let H+_sum_19.2 (H+_re_p_19.2)
        let CO2_sum_19.2 (CO2_re_r_19.2 + CO2_rs_r_19.2)
        let HCO3_sum_19.2 (HCO3_rs_r_19.2)
        let acetate_sum_19.2 (acetate_re_p_19.2)
        let NH4_sum_19.2 (NH4_rs_r_19.2)
        let biomass_sum_19.2 (biomass_rs_p_19.2)


        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.2 / H2_sum_19.2 * biomass_sum_19.2)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.2 / H2_sum_19.2 * HCO3_sum_19.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.2 / H2_sum_19.2 * NH4_sum_19.2)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.2 / H2_sum_19.2 * CO2_sum_19.2)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.2 / H2_sum_19.2 * acetate_sum_19.2) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.2 / H2_sum_19.2 * H+_sum_19.2) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.2 / H2_sum_19.2 * H2O_sum_19.2)]
        ask prey3 [set hydrogens_mass hydrogens_mass - (food_19.2 / num_prey3)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.2b energy_fs
        let fe_19.2b energy_fe

        let CO2_re_r_19.2b ( (1 / 4) * 1000 * fe_19.2b)
        let H2_re_r_19.2b ((1 / 2) * 1000 * fe_19.2b)
        let CO2_rs_r_19.2b ((1 / 5) * 1000 * fs_19.2b)
        let NH4_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let HCO3_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2_rs_r_19.2b ((1 / 2) * 1000 * fs_19.2b)

        let acetate_re_p_19.2b (( 1 / 8) * 1000 * fe_19.2b)
        let H2O_re_p_19.2b ((1 / 4) * 1000 * fe_19.2b)
        let H+_re_p_19.2b ((1 / 8) * 1000 * fe_19.2b)
        let biomass_rs_p_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2O_rs_p_19.2b ((9 / 20) * 1000 * fs_19.2b)

        let H2O_sum_19.2b (H2O_re_p_19.2b + H2O_rs_p_19.2b)
        let H2_sum_19.2b (H2_re_r_19.2b + H2_rs_r_19.2b)
        let H+_sum_19.2b (H+_re_p_19.2b)
        let CO2_sum_19.2b (CO2_re_r_19.2b + CO2_rs_r_19.2b)
        let HCO3_sum_19.2b (HCO3_rs_r_19.2b)
        let acetate_sum_19.2b (acetate_re_p_19.2b)
        let NH4_sum_19.2b (NH4_rs_r_19.2b)
        let biomass_sum_19.2b (biomass_rs_p_19.2b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * biomass_sum_19.2b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * HCO3_sum_19.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * NH4_sum_19.2b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * CO2_sum_19.2b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * acetate_sum_19.2b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * H+_sum_19.2b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * H2O_sum_19.2b)]
        ask prey3 [die]
      ]
    ]
]
if initial_concentration_hydrogens >= 0.5 and initial_concentration_acetates < 0.6 and temp > 293.15 and time > 1
  [
    let target4 hydrogens in-radius 50
    if target4 != nobody
    [
      let prey4 up-to-n-of 2 other target4
      let num_prey4 count prey4
      ifelse (sum [hydrogens_mass] of prey4) > uptake_HAB19
      [
        let food_19.3 min (list uptake_HAB19 [hydrogens_mass] of prey4)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.3 energy_fs
        let fe_19.3 energy_fe

        let CO2_re_r_19.3 ( (1 / 4) * 1000 * fe_19.3)
        let H2_re_r_19.3 ((1 / 2) * 1000 * fe_19.3)
        let CO2_rs_r_19.3 ((1 / 5) * 1000 * fs_19.3)
        let NH4_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let HCO3_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2_rs_r_19.3 ((1 / 2) * 1000 * fs_19.3)

        let acetate_re_p_19.3 (( 1 / 8) * 1000 * fe_19.3)
        let H2O_re_p_19.3 ((1 / 4) * 1000 * fe_19.3)
        let H+_re_p_19.3 ((1 / 8) * 1000 * fe_19.3)
        let biomass_rs_p_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2O_rs_p_19.3 ((9 / 20) * 1000 * fs_19.3)

        let H2O_sum_19.3 (H2O_re_p_19.3 + H2O_rs_p_19.3)
        let H2_sum_19.3 (H2_re_r_19.3 + H2_rs_r_19.3)
        let H+_sum_19.3 (H+_re_p_19.3)
        let CO2_sum_19.3 (CO2_re_r_19.3 + CO2_rs_r_19.3)
        let HCO3_sum_19.3 (HCO3_rs_r_19.3)
        let acetate_sum_19.3 (acetate_re_p_19.3)
        let NH4_sum_19.3 (NH4_rs_r_19.3)
        let biomass_sum_19.3 (biomass_rs_p_19.3)


        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.3 / H2_sum_19.3 * biomass_sum_19.3)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.3 / H2_sum_19.3 * HCO3_sum_19.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.3 / H2_sum_19.3 * NH4_sum_19.3)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.3 / H2_sum_19.3 * CO2_sum_19.3)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.3 / H2_sum_19.3 * acetate_sum_19.3) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.3 / H2_sum_19.3 * H+_sum_19.3) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.3 / H2_sum_19.3 * H2O_sum_19.3)]
        ask prey4 [set hydrogens_mass hydrogens_mass - (food_19.3 / num_prey4)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.3b energy_fs
        let fe_19.3b energy_fe

        let CO2_re_r_19.3b ( (1 / 4) * 1000 * fe_19.3b)
        let H2_re_r_19.3b ((1 / 2) * 1000 * fe_19.3b)
        let CO2_rs_r_19.3b ((1 / 5) * 1000 * fs_19.3b)
        let NH4_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let HCO3_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2_rs_r_19.3b ((1 / 2) * 1000 * fs_19.3b)

        let acetate_re_p_19.3b (( 1 / 8) * 1000 * fe_19.3b)
        let H2O_re_p_19.3b ((1 / 4) * 1000 * fe_19.3b)
        let H+_re_p_19.3b ((1 / 8) * 1000 * fe_19.3b)
        let biomass_rs_p_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2O_rs_p_19.3b ((9 / 20) * 1000 * fs_19.3b)

        let H2O_sum_19.3b (H2O_re_p_19.3b + H2O_rs_p_19.3b)
        let H2_sum_19.3b (H2_re_r_19.3b + H2_rs_r_19.3b)
        let H+_sum_19.3b (H+_re_p_19.3b)
        let CO2_sum_19.3b (CO2_re_r_19.3b + CO2_rs_r_19.3b)
        let HCO3_sum_19.3b (HCO3_rs_r_19.3b)
        let acetate_sum_19.3b (acetate_re_p_19.3b)
        let NH4_sum_19.3b (NH4_rs_r_19.3b)
        let biomass_sum_19.3b (biomass_rs_p_19.3b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * biomass_sum_19.3b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * HCO3_sum_19.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * NH4_sum_19.3b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * CO2_sum_19.3b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * acetate_sum_19.3b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * H+_sum_19.3b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * H2O_sum_19.3b)]
        ask prey4 [die]
      ]
    ]
]
if initial_concentration_acetates >= 0.6 and initial_concentration_acetates < 1 and temp > 293.15 and time > 1
  [
    let target5 hydrogens in-radius 50
    if target5 != nobody
    [
      let prey5 up-to-n-of 4 other target5
      let num_prey5 count prey5
      ifelse (sum [hydrogens_mass] of prey5) > uptake_HAB19
      [
        let food_19.4 min (list uptake_HAB19 [hydrogens_mass] of prey5)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.4 energy_fs
        let fe_19.4 energy_fe

        let CO2_re_r_19.4 ( (1 / 4) * 1000 * fe_19.4)
        let H2_re_r_19.4 ((1 / 2) * 1000 * fe_19.4)
        let CO2_rs_r_19.4 ((1 / 5) * 1000 * fs_19.4)
        let NH4_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let HCO3_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2_rs_r_19.4 ((1 / 2) * 1000 * fs_19.4)

        let acetate_re_p_19.4 (( 1 / 8) * 1000 * fe_19.4)
        let H2O_re_p_19.4 ((1 / 4) * 1000 * fe_19.4)
        let H+_re_p_19.4 ((1 / 8) * 1000 * fe_19.4)
        let biomass_rs_p_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2O_rs_p_19.4 ((9 / 20) * 1000 * fs_19.4)

        let H2O_sum_19.4 (H2O_re_p_19.4 + H2O_rs_p_19.4)
        let H2_sum_19.4 (H2_re_r_19.4 + H2_rs_r_19.4)
        let H+_sum_19.4 (H+_re_p_19.4)
        let CO2_sum_19.4 (CO2_re_r_19.4 + CO2_rs_r_19.4)
        let HCO3_sum_19.4 (HCO3_rs_r_19.4)
        let acetate_sum_19.4 (acetate_re_p_19.4)
        let NH4_sum_19.4 (NH4_rs_r_19.4)
        let biomass_sum_19.4 (biomass_rs_p_19.4)


        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.4 / H2_sum_19.4 * biomass_sum_19.4)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.4 / H2_sum_19.4 * HCO3_sum_19.4)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.4 / H2_sum_19.4 * NH4_sum_19.4)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.4 / H2_sum_19.4 * CO2_sum_19.4)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.4 / H2_sum_19.4 * acetate_sum_19.4) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.4 / H2_sum_19.4 * H+_sum_19.4) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.4 / H2_sum_19.4 * H2O_sum_19.4)]
        ask prey5 [set hydrogens_mass hydrogens_mass - (food_19.4 / num_prey5)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.4b energy_fs
        let fe_19.4b energy_fe

        let CO2_re_r_19.4b ( (1 / 4) * 1000 * fe_19.4b)
        let H2_re_r_19.4b ((1 / 2) * 1000 * fe_19.4b)
        let CO2_rs_r_19.4b ((1 / 5) * 1000 * fs_19.4b)
        let NH4_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let HCO3_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2_rs_r_19.4b ((1 / 2) * 1000 * fs_19.4b)

        let acetate_re_p_19.4b (( 1 / 8) * 1000 * fe_19.4b)
        let H2O_re_p_19.4b ((1 / 4) * 1000 * fe_19.4b)
        let H+_re_p_19.4b ((1 / 8) * 1000 * fe_19.4b)
        let biomass_rs_p_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2O_rs_p_19.4b ((9 / 20) * 1000 * fs_19.4b)

        let H2O_sum_19.4b (H2O_re_p_19.4b + H2O_rs_p_19.4b)
        let H2_sum_19.4b (H2_re_r_19.4b + H2_rs_r_19.4b)
        let H+_sum_19.4b (H+_re_p_19.4b)
        let CO2_sum_19.4b (CO2_re_r_19.4b + CO2_rs_r_19.4b)
        let HCO3_sum_19.4b (HCO3_rs_r_19.4b)
        let acetate_sum_19.4b (acetate_re_p_19.4b)
        let NH4_sum_19.4b (NH4_rs_r_19.4b)
        let biomass_sum_19.4b (biomass_rs_p_19.4b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * biomass_sum_19.4b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * HCO3_sum_19.4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * NH4_sum_19.4b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * CO2_sum_19.4b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * acetate_sum_19.4b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * H+_sum_19.4b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * H2O_sum_19.4b)]
        ask prey5 [die]
      ]
    ]
]
 if initial_concentration_acetates >= 1 and initial_concentration_acetates < 2 and temp > 293.15 and time > 1
[
    let target6 hydrogens in-radius 50
    if target6 != nobody
    [
      let prey6 up-to-n-of 7 other target6
    let num_prey6 count prey6
      ifelse (sum [hydrogens_mass] of prey6) > uptake_HAB19
      [
        let food_19.5 min (list uptake_HAB19 [hydrogens_mass] of prey6)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5 energy_fs
        let fe_19.5 energy_fe

        let CO2_re_r_19.5 ( (1 / 4) * 1000 * fe_19.5)
        let H2_re_r_19.5 ((1 / 2) * 1000 * fe_19.5)
        let CO2_rs_r_19.5 ((1 / 5) * 1000 * fs_19.5)
        let NH4_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let HCO3_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2_rs_r_19.5 ((1 / 2) * 1000 * fs_19.5)

        let acetate_re_p_19.5 (( 1 / 8) * 1000 * fe_19.5)
        let H2O_re_p_19.5 ((1 / 4) * 1000 * fe_19.5)
        let H+_re_p_19.5 ((1 / 8) * 1000 * fe_19.5)
        let biomass_rs_p_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2O_rs_p_19.5 ((9 / 20) * 1000 * fs_19.5)

        let H2O_sum_19.5 (H2O_re_p_19.5 + H2O_rs_p_19.5)
        let H2_sum_19.5 (H2_re_r_19.5 + H2_rs_r_19.5)
        let H+_sum_19.5 (H+_re_p_19.5)
        let CO2_sum_19.5 (CO2_re_r_19.5 + CO2_rs_r_19.5)
        let HCO3_sum_19.5 (HCO3_rs_r_19.5)
        let acetate_sum_19.5 (acetate_re_p_19.5)
        let NH4_sum_19.5 (NH4_rs_r_19.5)
        let biomass_sum_19.5 (biomass_rs_p_19.5)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.5 / H2_sum_19.5 * biomass_sum_19.5)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.5 / H2_sum_19.5 * HCO3_sum_19.5)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.5 / H2_sum_19.5 * NH4_sum_19.5)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.5 / H2_sum_19.5 * CO2_sum_19.5)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.5 / H2_sum_19.5 * acetate_sum_19.5) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.5 / H2_sum_19.5 * H+_sum_19.5) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.5 / H2_sum_19.5 * H2O_sum_19.5)]
        ask prey6 [set hydrogens_mass hydrogens_mass - (food_19.5 / num_prey6)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5b energy_fs
        let fe_19.5b energy_fe

        let CO2_re_r_19.5b ( (1 / 4) * 1000 * fe_19.5b)
        let H2_re_r_19.5b ((1 / 2) * 1000 * fe_19.5b)
        let CO2_rs_r_19.5b ((1 / 5) * 1000 * fs_19.5b)
        let NH4_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let HCO3_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2_rs_r_19.5b ((1 / 2) * 1000 * fs_19.5b)

        let acetate_re_p_19.5b (( 1 / 8) * 1000 * fe_19.5b)
        let H2O_re_p_19.5b ((1 / 4) * 1000 * fe_19.5b)
        let H+_re_p_19.5b ((1 / 8) * 1000 * fe_19.5b)
        let biomass_rs_p_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2O_rs_p_19.5b ((9 / 20) * 1000 * fs_19.5b)

        let H2O_sum_19.5b (H2O_re_p_19.5b + H2O_rs_p_19.5b)
        let H2_sum_19.5b (H2_re_r_19.5b + H2_rs_r_19.5b)
        let H+_sum_19.5b (H+_re_p_19.5b)
        let CO2_sum_19.5b (CO2_re_r_19.5b + CO2_rs_r_19.5b)
        let HCO3_sum_19.5b (HCO3_rs_r_19.5b)
        let acetate_sum_19.5b (acetate_re_p_19.5b)
        let NH4_sum_19.5b (NH4_rs_r_19.5b)
        let biomass_sum_19.5b (biomass_rs_p_19.5b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * biomass_sum_19.5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * HCO3_sum_19.5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * NH4_sum_19.5b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * CO2_sum_19.5b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * acetate_sum_19.5b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * H+_sum_19.5b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * H2O_sum_19.5b)]
        ask prey6 [die]
      ]
    ]
]
if initial_concentration_acetates >= 2 and initial_concentration_acetates < 3 and temp > 293.15 and time > 1
[
    let target7 hydrogens in-radius 50
    if target7 != nobody
    [
      let prey7 up-to-n-of 8 other target7
    let num_prey7 count prey7
      ifelse (sum [hydrogens_mass] of prey7) > uptake_HAB19
      [
        let food_19.6 min (list uptake_HAB19 [hydrogens_mass] of prey7)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6 energy_fs
        let fe_19.6 energy_fe

        let CO2_re_r_19.6 ( (1 / 4) * 1000 * fe_19.6)
        let H2_re_r_19.6 ((1 / 2) * 1000 * fe_19.6)
        let CO2_rs_r_19.6 ((1 / 5) * 1000 * fs_19.6)
        let NH4_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let HCO3_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2_rs_r_19.6 ((1 / 2) * 1000 * fs_19.6)

        let acetate_re_p_19.6 (( 1 / 8) * 1000 * fe_19.6)
        let H2O_re_p_19.6 ((1 / 4) * 1000 * fe_19.6)
        let H+_re_p_19.6 ((1 / 8) * 1000 * fe_19.6)
        let biomass_rs_p_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2O_rs_p_19.6 ((9 / 20) * 1000 * fs_19.6)

        let H2O_sum_19.6 (H2O_re_p_19.6 + H2O_rs_p_19.6)
        let H2_sum_19.6 (H2_re_r_19.6 + H2_rs_r_19.6)
        let H+_sum_19.6 (H+_re_p_19.6)
        let CO2_sum_19.6 (CO2_re_r_19.6 + CO2_rs_r_19.6)
        let HCO3_sum_19.6 (HCO3_rs_r_19.6)
        let acetate_sum_19.6 (acetate_re_p_19.6)
        let NH4_sum_19.6 (NH4_rs_r_19.6)
        let biomass_sum_19.6 (biomass_rs_p_19.6)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.6 / H2_sum_19.6 * biomass_sum_19.6)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.6 / H2_sum_19.6 * HCO3_sum_19.6)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.6 / H2_sum_19.6 * NH4_sum_19.6)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.6 / H2_sum_19.6 * CO2_sum_19.6)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.6 / H2_sum_19.6 * acetate_sum_19.6) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.6 / H2_sum_19.6 * H+_sum_19.6) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.6 / H2_sum_19.6 * H2O_sum_19.6)]
        ask prey7 [set hydrogens_mass hydrogens_mass - (food_19.6 / num_prey7)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6b energy_fs
        let fe_19.6b energy_fe

        let CO2_re_r_19.6b ( (1 / 4) * 1000 * fe_19.6b)
        let H2_re_r_19.6b ((1 / 2) * 1000 * fe_19.6b)
        let CO2_rs_r_19.6b ((1 / 5) * 1000 * fs_19.6b)
        let NH4_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let HCO3_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2_rs_r_19.6b ((1 / 2) * 1000 * fs_19.6b)

        let acetate_re_p_19.6b (( 1 / 8) * 1000 * fe_19.6b)
        let H2O_re_p_19.6b ((1 / 4) * 1000 * fe_19.6b)
        let H+_re_p_19.6b ((1 / 8) * 1000 * fe_19.6b)
        let biomass_rs_p_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2O_rs_p_19.6b ((9 / 20) * 1000 * fs_19.6b)

        let H2O_sum_19.6b (H2O_re_p_19.6b + H2O_rs_p_19.6b)
        let H2_sum_19.6b (H2_re_r_19.6b + H2_rs_r_19.6b)
        let H+_sum_19.6b (H+_re_p_19.6b)
        let CO2_sum_19.6b (CO2_re_r_19.6b + CO2_rs_r_19.6b)
        let HCO3_sum_19.6b (HCO3_rs_r_19.6b)
        let acetate_sum_19.6b (acetate_re_p_19.6b)
        let NH4_sum_19.6b (NH4_rs_r_19.6b)
        let biomass_sum_19.6b (biomass_rs_p_19.6b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * biomass_sum_19.6b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * HCO3_sum_19.6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * NH4_sum_19.6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * CO2_sum_19.6b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * acetate_sum_19.6b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * H+_sum_19.6b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * H2O_sum_19.6b)]
        ask prey7 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 3 and temp > 293.15 and time > 1
[
    let target8 hydrogens in-radius 50
    if target8 != nobody
    [
      let prey8 up-to-n-of 15 other target8
    let num_prey8 count prey8
      ifelse (sum [hydrogens_mass] of prey8) > uptake_HAB19
      [
        let food_19.7 min (list uptake_HAB19 [hydrogens_mass] of prey8)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7 energy_fs
        let fe_19.7 energy_fe

        let CO2_re_r_19.7 ( (1 / 4) * 1000 * fe_19.7)
        let H2_re_r_19.7 ((1 / 2) * 1000 * fe_19.7)
        let CO2_rs_r_19.7 ((1 / 5) * 1000 * fs_19.7)
        let NH4_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let HCO3_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2_rs_r_19.7 ((1 / 2) * 1000 * fs_19.7)

        let acetate_re_p_19.7 (( 1 / 8) * 1000 * fe_19.7)
        let H2O_re_p_19.7 ((1 / 4) * 1000 * fe_19.7)
        let H+_re_p_19.7 ((1 / 8) * 1000 * fe_19.7)
        let biomass_rs_p_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2O_rs_p_19.7 ((9 / 20) * 1000 * fs_19.7)

        let H2O_sum_19.7 (H2O_re_p_19.7 + H2O_rs_p_19.7)
        let H2_sum_19.7 (H2_re_r_19.7 + H2_rs_r_19.7)
        let H+_sum_19.7 (H+_re_p_19.7)
        let CO2_sum_19.7 (CO2_re_r_19.7 + CO2_rs_r_19.7)
        let HCO3_sum_19.7 (HCO3_rs_r_19.7)
        let acetate_sum_19.7 (acetate_re_p_19.7)
        let NH4_sum_19.7 (NH4_rs_r_19.7)
        let biomass_sum_19.7 (biomass_rs_p_19.7)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + (food_19.7 / H2_sum_19.7 * biomass_sum_19.7)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.7 / H2_sum_19.7 * HCO3_sum_19.7)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.7 / H2_sum_19.7 * NH4_sum_19.7)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.7 / H2_sum_19.7 * CO2_sum_19.7)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.7 / H2_sum_19.7 * acetate_sum_19.7) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.7 / H2_sum_19.7 * H+_sum_19.7) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.7 / H2_sum_19.7 * H2O_sum_19.7)]
        ask prey8 [set hydrogens_mass hydrogens_mass - (food_19.7 / num_prey8)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7b energy_fs
        let fe_19.7b energy_fe

        let CO2_re_r_19.7b ( (1 / 4) * 1000 * fe_19.7b)
        let H2_re_r_19.7b ((1 / 2) * 1000 * fe_19.7b)
        let CO2_rs_r_19.7b ((1 / 5) * 1000 * fs_19.7b)
        let NH4_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let HCO3_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2_rs_r_19.7b ((1 / 2) * 1000 * fs_19.7b)

        let acetate_re_p_19.7b (( 1 / 8) * 1000 * fe_19.7b)
        let H2O_re_p_19.7b ((1 / 4) * 1000 * fe_19.7b)
        let H+_re_p_19.7b ((1 / 8) * 1000 * fe_19.7b)
        let biomass_rs_p_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2O_rs_p_19.7b ((9 / 20) * 1000 * fs_19.7b)

        let H2O_sum_19.7b (H2O_re_p_19.7b + H2O_rs_p_19.7b)
        let H2_sum_19.7b (H2_re_r_19.7b + H2_rs_r_19.7b)
        let H+_sum_19.7b (H+_re_p_19.7b)
        let CO2_sum_19.7b (CO2_re_r_19.7b + CO2_rs_r_19.7b)
        let HCO3_sum_19.7b (HCO3_rs_r_19.7b)
        let acetate_sum_19.7b (acetate_re_p_19.7b)
        let NH4_sum_19.7b (NH4_rs_r_19.7b)
        let biomass_sum_19.7b (biomass_rs_p_19.7b)

        set C.aceticum_FB5/HAB19_mass C.aceticum_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * biomass_sum_19.7b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * HCO3_sum_19.7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * NH4_sum_19.7b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * CO2_sum_19.7b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * acetate_sum_19.7b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * H+_sum_19.7b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * H2O_sum_19.7b)]
        ask prey8 [die]
      ]
    ]
]
end

to reproduce_FB5/HAB19_CA
  if C.aceticum_FB5/HAB19_mass > 1
  [
  set C.aceticum_FB5/HAB19_mass (C.aceticum_FB5/HAB19_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB5 0.0207
  set uptake_HAB19 0.1876
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB5/HAB19_CA
  set C.aceticum_FB5/HAB19_mass (C.aceticum_FB5/HAB19_mass - C.aceticum_FB5/HAB19_mass * (0.015 / 24));; Represents decay rate per hour based on Saady, 2013.
end

;;; CLOSTRIDIUM FB5;;; For Equation 5 and Equation 19


to AW_FB5/HAB19_eat_glucose_or_hydrogen;; Clostridium procedure ;; maximum uptake rate is up to 0.0207 mmol/mmmol h when consuming glucose and up to 0.9887 mmol/mmol h when consuming hydrogen for Acetobacterium woodii based on  Munisamy et al., 2017; Amani et al., 2010, Agler et al., 2011 and Saady, 2013
if initial_concentration_hydrogens < ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * 0.9) and time > 1
  [
  let target glucose in-radius 2
  if target != nobody
  [
    let prey up-to-n-of 2 other target
    let num_prey count prey
      ifelse (sum [glucose_mass] of prey) > uptake_FB5
    [
      let food_5 min (list uptake_FB5 [glucose_mass] of prey)
      set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
      set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
      set energy_fe (1 - energy_fs)
      let fs_5 energy_fs
      let fe_5 energy_fe

      let glucose_re_r ((1 / 24) * 1000 * fe_5)
      let H2O_re_r ((1 / 12) * 1000 * fe_5)
      let NH4_rs_r ((1 / 20) * 1000 * fs_5)
      let HCO3_rs_r ((1 / 20) * 1000 * fs_5)
      let glucose_rs_r ((1 / 24) * 1000 * fs_5)

      let acetate_re_p ((1 / 12) * 1000 * fe_5)
      let CO2s_re_p ((1 / 12) * 1000 * fe_5)
      let H2_re_p ((1 / 6) * 1000 * fe_5)
      let H+_re_p ((1 / 12) * 1000 * fe_5)
      let biomass_rs_p ((1 / 20) * 1000 * fs_5)
      let CO2_rs_p ( (1 / 20) * 1000 * fs_5)
      let H2O_rs_p ((1 / 5) * 1000 * fs_5)

      let H2O_sum (H2O_rs_p - H2O_re_r)
      let H2_sum (H2_re_p)
      let H+_sum (H+_re_p)
      let CO2_sum (CO2s_re_p + CO2_rs_p)
      let HCO3_sum (HCO3_rs_r)
      let acetates_sum (acetate_re_p)
      let glucose_sum (glucose_re_r + glucose_rs_r)
      let NH4_sum (NH4_rs_r)
      let biomass_sum (biomass_rs_p)

      set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_5 / glucose_sum * biomass_sum)
      ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_5 / glucose_sum * HCO3_sum)]
      ask one-of ammonium [set ammonium_mass ammonium_mass - (food_5 / glucose_sum * NH4_sum)]
      ask n-of 1 patches [set pcolor black set moles moles - (food_5 / glucose_sum * H2O_sum)]
      if moles = 0 [die]
      hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + (food_5 / glucose_sum * CO2_sum) right random 360 fd 2]
      hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_5 / glucose_sum * acetates_sum) rt random 360 fd 1]
      hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + (food_5 / glucose_sum * H2_sum) right random 360 fd 3]
      hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_5 / glucose_sum * H+_sum) right random 360 fd 4]
      ask prey [set glucose_mass glucose_mass - (food_5 / num_prey)]
    ]
    [
      set Gr (-8.2927 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 12)) * (LCO2 ^ (1 / 12)) * (LH2 ^ (1 / 6)) * ((10 ^ -4) ^ (1 / 12))) / (Initial_concentration_glucose ^ (1 / 24) * (1 ^ (1 / 12)))))
      set energy_fs 1 / (1 + abs((((-3.7730 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
      set energy_fe (1 - energy_fs)
      let fs_5b energy_fs
      let fe_5b energy_fe

      let glucose_re_r_5b ((1 / 24) * 1000 * fe_5b)
      let H2O_re_r_5b ((1 / 12) * 1000 * fe_5b)
      let NH4_rs_r_5b ((1 / 20) * 1000 * fs_5b)
      let HCO3_rs_r_5b ((1 / 20) * 1000 * fs_5b)
      let glucose_rs_r_5b ((1 / 24) * 1000 * fs_5b)

      let acetate_re_p_5b ((1 / 12) * 1000 * fe_5b)
      let CO2s_re_p_5b ((1 / 12) * 1000 * fe_5b)
      let H2_re_p_5b ((1 / 6) * 1000 * fe_5b)
      let H+_re_p_5b ((1 / 12) * 1000 * fe_5b)
      let biomass_rs_p_5b ((1 / 20) * 1000 * fs_5b)
      let CO2_rs_p_5b (( 1 / 20) * 1000 * fs_5b)
      let H2O_rs_p_5b ((1 / 5) * 1000 * fs_5b)

      let H2O_sum_5b (H2O_rs_p_5b - H2O_re_r_5b)
      let H2_sum_5b (H2_re_p_5b)
      let H+_sum_5b (H+_re_p_5b)
      let CO2_sum_5b (CO2s_re_p_5b + CO2_rs_p_5b)
      let HCO3_sum_5b (HCO3_rs_r_5b)
      let acetates_sum_5b (acetate_re_p_5b)
      let glucose_sum_5b (glucose_re_r_5b + glucose_rs_r_5b)
      let NH4_sum_5b (NH4_rs_r_5b)
      let biomass_sum_5b (biomass_rs_p_5b)

      set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * biomass_sum_5b)
      ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * HCO3_sum_5b)]
      ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [glucose_mass] of prey) / glucose_sum_5b * NH4_sum_5b)]
      ask n-of 1 patches [set pcolor black set moles moles - ((sum [glucose_mass] of prey) / glucose_sum_5b * H2O_sum_5b)]
      if moles = 0 [die]
      hatch-CO2s 1 [set color orange  set size 0.5 set CO2s_mass CO2s_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * CO2_sum_5b) right random 360 fd 2]
      hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * acetates_sum_5b) rt random 360 fd 1]
      hatch-hydrogens 1 [set color sky set size 0.5 set hydrogens_mass hydrogens_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H2_sum_5b) right random 360 fd 3]
      hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [glucose_mass] of prey) / glucose_sum_5b * H+_sum_5b) right random 360 fd 4]
      ask prey [die]
    ]
  ]
  ]
if initial_concentration_acetates < 0.3 and temp > 293.15 and time > 1
  [
    let target2 hydrogens in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 12 other target2
      let num_prey2 count prey2
      ifelse (sum [hydrogens_mass] of prey2) > uptake_HAB19
      [
        let food_19 min (list uptake_HAB19 [hydrogens_mass] of prey2)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19 energy_fs
        let fe_19 energy_fe

        let CO2_re_r_19 ( (1 / 4) * 1000 * fe_19)
        let H2_re_r_19 ((1 / 2) * 1000 * fe_19)
        let CO2_rs_r_19 ((1 / 5) * 1000 * fs_19)
        let NH4_rs_r_19 ((1 / 20) * 1000 * fs_19)
        let HCO3_rs_r_19 ((1 / 20) * 1000 * fs_19)
        let H2_rs_r_19 ((1 / 2) * 1000 * fs_19)

        let acetate_re_p_19 (( 1 / 8) * 1000 * fe_19)
        let H2O_re_p_19 ((1 / 4) * 1000 * fe_19)
        let H+_re_p_19 ((1 / 8) * 1000 * fe_19)
        let biomass_rs_p_19 ((1 / 20) * 1000 * fs_19)
        let H2O_rs_p_19 ((9 / 20) * 1000 * fs_19)

        let H2O_sum_19 (H2O_re_p_19 + H2O_rs_p_19)
        let H2_sum_19 (H2_re_r_19 + H2_rs_r_19)
        let H+_sum_19 (H+_re_p_19)
        let CO2_sum_19 (CO2_re_r_19 + CO2_rs_r_19)
        let HCO3_sum_19 (HCO3_rs_r_19)
        let acetate_sum_19 (acetate_re_p_19)
        let NH4_sum_19 (NH4_rs_r_19)
        let biomass_sum_19 (biomass_rs_p_19)


        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19 / H2_sum_19 * biomass_sum_19)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19 / H2_sum_19 * HCO3_sum_19)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19 / H2_sum_19 * NH4_sum_19)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19 / H2_sum_19 * CO2_sum_19)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19 / H2_sum_19 * acetate_sum_19) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19 / H2_sum_19 * H+_sum_19) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19 / H2_sum_19 * H2O_sum_19)]
        ask prey2 [set hydrogens_mass hydrogens_mass - (food_19 / num_prey2)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19b energy_fs
        let fe_19b energy_fe

        let CO2_re_r_19b ( (1 / 4) * 1000 * fe_19b)
        let H2_re_r_19b ((1 / 2) * 1000 * fe_19b)
        let CO2_rs_r_19b ((1 / 5) * 1000 * fs_19b)
        let NH4_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let HCO3_rs_r_19b ((1 / 20) * 1000 * fs_19b)
        let H2_rs_r_19b ((1 / 2) * 1000 * fs_19b)

        let acetate_re_p_19b (( 1 / 8) * 1000 * fe_19b)
        let H2O_re_p_19b ((1 / 4) * 1000 * fe_19b)
        let H+_re_p_19b ((1 / 8) * 1000 * fe_19b)
        let biomass_rs_p_19b ((1 / 20) * 1000 * fs_19b)
        let H2O_rs_p_19b ((9 / 20) * 1000 * fs_19b)

        let H2O_sum_19b (H2O_re_p_19b + H2O_rs_p_19b)
        let H2_sum_19b (H2_re_r_19b + H2_rs_r_19b)
        let H+_sum_19b (H+_re_p_19b)
        let CO2_sum_19b (CO2_re_r_19b + CO2_rs_r_19b)
        let HCO3_sum_19b (HCO3_rs_r_19b)
        let acetate_sum_19b (acetate_re_p_19b)
        let NH4_sum_19b (NH4_rs_r_19b)
        let biomass_sum_19b (biomass_rs_p_19b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * biomass_sum_19b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * HCO3_sum_19b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * NH4_sum_19b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_19b * CO2_sum_19b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * acetate_sum_19b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * H+_sum_19b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey2) / H2_sum_19b * H2O_sum_19b)]
        ask prey2 [die]
      ]
    ]
]
if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and temp > 293.15 and time > 1
  [
    let target3 hydrogens in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 1 other target3
      let num_prey3 count prey3
      ifelse (sum [hydrogens_mass] of prey3) > uptake_HAB19
      [
        let food_19.2 min (list uptake_HAB19 [hydrogens_mass] of prey3)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.2 energy_fs
        let fe_19.2 energy_fe

        let CO2_re_r_19.2 ( (1 / 4) * 1000 * fe_19.2)
        let H2_re_r_19.2 ((1 / 2) * 1000 * fe_19.2)
        let CO2_rs_r_19.2 ((1 / 5) * 1000 * fs_19.2)
        let NH4_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let HCO3_rs_r_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2_rs_r_19.2 ((1 / 2) * 1000 * fs_19.2)

        let acetate_re_p_19.2 (( 1 / 8) * 1000 * fe_19.2)
        let H2O_re_p_19.2 ((1 / 4) * 1000 * fe_19.2)
        let H+_re_p_19.2 ((1 / 8) * 1000 * fe_19.2)
        let biomass_rs_p_19.2 ((1 / 20) * 1000 * fs_19.2)
        let H2O_rs_p_19.2 ((9 / 20) * 1000 * fs_19.2)

        let H2O_sum_19.2 (H2O_re_p_19.2 + H2O_rs_p_19.2)
        let H2_sum_19.2 (H2_re_r_19.2 + H2_rs_r_19.2)
        let H+_sum_19.2 (H+_re_p_19.2)
        let CO2_sum_19.2 (CO2_re_r_19.2 + CO2_rs_r_19.2)
        let HCO3_sum_19.2 (HCO3_rs_r_19.2)
        let acetate_sum_19.2 (acetate_re_p_19.2)
        let NH4_sum_19.2 (NH4_rs_r_19.2)
        let biomass_sum_19.2 (biomass_rs_p_19.2)


        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.2 / H2_sum_19.2 * biomass_sum_19.2)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.2 / H2_sum_19.2 * HCO3_sum_19.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.2 / H2_sum_19.2 * NH4_sum_19.2)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.2 / H2_sum_19.2 * CO2_sum_19.2)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.2 / H2_sum_19.2 * acetate_sum_19.2) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.2 / H2_sum_19.2 * H+_sum_19.2) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.2 / H2_sum_19.2 * H2O_sum_19.2)]
        ask prey3 [set hydrogens_mass hydrogens_mass - (food_19.2 / num_prey3)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.2b energy_fs
        let fe_19.2b energy_fe

        let CO2_re_r_19.2b ( (1 / 4) * 1000 * fe_19.2b)
        let H2_re_r_19.2b ((1 / 2) * 1000 * fe_19.2b)
        let CO2_rs_r_19.2b ((1 / 5) * 1000 * fs_19.2b)
        let NH4_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let HCO3_rs_r_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2_rs_r_19.2b ((1 / 2) * 1000 * fs_19.2b)

        let acetate_re_p_19.2b (( 1 / 8) * 1000 * fe_19.2b)
        let H2O_re_p_19.2b ((1 / 4) * 1000 * fe_19.2b)
        let H+_re_p_19.2b ((1 / 8) * 1000 * fe_19.2b)
        let biomass_rs_p_19.2b ((1 / 20) * 1000 * fs_19.2b)
        let H2O_rs_p_19.2b ((9 / 20) * 1000 * fs_19.2b)

        let H2O_sum_19.2b (H2O_re_p_19.2b + H2O_rs_p_19.2b)
        let H2_sum_19.2b (H2_re_r_19.2b + H2_rs_r_19.2b)
        let H+_sum_19.2b (H+_re_p_19.2b)
        let CO2_sum_19.2b (CO2_re_r_19.2b + CO2_rs_r_19.2b)
        let HCO3_sum_19.2b (HCO3_rs_r_19.2b)
        let acetate_sum_19.2b (acetate_re_p_19.2b)
        let NH4_sum_19.2b (NH4_rs_r_19.2b)
        let biomass_sum_19.2b (biomass_rs_p_19.2b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * biomass_sum_19.2b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * HCO3_sum_19.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * NH4_sum_19.2b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * CO2_sum_19.2b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * acetate_sum_19.2b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * H+_sum_19.2b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey3) / H2_sum_19.2b * H2O_sum_19.2b)]
        ask prey3 [die]
      ]
    ]
]
if initial_concentration_hydrogens >= 0.5 and initial_concentration_acetates < 0.6 and temp > 293.15 and time > 1
  [
    let target4 hydrogens in-radius 50
    if target4 != nobody
    [
      let prey4 up-to-n-of 2 other target4
      let num_prey4 count prey4
      ifelse (sum [hydrogens_mass] of prey4) > uptake_HAB19
      [
        let food_19.3 min (list uptake_HAB19 [hydrogens_mass] of prey4)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.3 energy_fs
        let fe_19.3 energy_fe

        let CO2_re_r_19.3 ( (1 / 4) * 1000 * fe_19.3)
        let H2_re_r_19.3 ((1 / 2) * 1000 * fe_19.3)
        let CO2_rs_r_19.3 ((1 / 5) * 1000 * fs_19.3)
        let NH4_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let HCO3_rs_r_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2_rs_r_19.3 ((1 / 2) * 1000 * fs_19.3)

        let acetate_re_p_19.3 (( 1 / 8) * 1000 * fe_19.3)
        let H2O_re_p_19.3 ((1 / 4) * 1000 * fe_19.3)
        let H+_re_p_19.3 ((1 / 8) * 1000 * fe_19.3)
        let biomass_rs_p_19.3 ((1 / 20) * 1000 * fs_19.3)
        let H2O_rs_p_19.3 ((9 / 20) * 1000 * fs_19.3)

        let H2O_sum_19.3 (H2O_re_p_19.3 + H2O_rs_p_19.3)
        let H2_sum_19.3 (H2_re_r_19.3 + H2_rs_r_19.3)
        let H+_sum_19.3 (H+_re_p_19.3)
        let CO2_sum_19.3 (CO2_re_r_19.3 + CO2_rs_r_19.3)
        let HCO3_sum_19.3 (HCO3_rs_r_19.3)
        let acetate_sum_19.3 (acetate_re_p_19.3)
        let NH4_sum_19.3 (NH4_rs_r_19.3)
        let biomass_sum_19.3 (biomass_rs_p_19.3)


        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.3 / H2_sum_19.3 * biomass_sum_19.3)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.3 / H2_sum_19.3 * HCO3_sum_19.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.3 / H2_sum_19.3 * NH4_sum_19.3)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.3 / H2_sum_19.3 * CO2_sum_19.3)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.3 / H2_sum_19.3 * acetate_sum_19.3) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.3 / H2_sum_19.3 * H+_sum_19.3) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.3 / H2_sum_19.3 * H2O_sum_19.3)]
        ask prey4 [set hydrogens_mass hydrogens_mass - (food_19.3 / num_prey4)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.3b energy_fs
        let fe_19.3b energy_fe

        let CO2_re_r_19.3b ( (1 / 4) * 1000 * fe_19.3b)
        let H2_re_r_19.3b ((1 / 2) * 1000 * fe_19.3b)
        let CO2_rs_r_19.3b ((1 / 5) * 1000 * fs_19.3b)
        let NH4_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let HCO3_rs_r_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2_rs_r_19.3b ((1 / 2) * 1000 * fs_19.3b)

        let acetate_re_p_19.3b (( 1 / 8) * 1000 * fe_19.3b)
        let H2O_re_p_19.3b ((1 / 4) * 1000 * fe_19.3b)
        let H+_re_p_19.3b ((1 / 8) * 1000 * fe_19.3b)
        let biomass_rs_p_19.3b ((1 / 20) * 1000 * fs_19.3b)
        let H2O_rs_p_19.3b ((9 / 20) * 1000 * fs_19.3b)

        let H2O_sum_19.3b (H2O_re_p_19.3b + H2O_rs_p_19.3b)
        let H2_sum_19.3b (H2_re_r_19.3b + H2_rs_r_19.3b)
        let H+_sum_19.3b (H+_re_p_19.3b)
        let CO2_sum_19.3b (CO2_re_r_19.3b + CO2_rs_r_19.3b)
        let HCO3_sum_19.3b (HCO3_rs_r_19.3b)
        let acetate_sum_19.3b (acetate_re_p_19.3b)
        let NH4_sum_19.3b (NH4_rs_r_19.3b)
        let biomass_sum_19.3b (biomass_rs_p_19.3b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * biomass_sum_19.3b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * HCO3_sum_19.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * NH4_sum_19.3b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * CO2_sum_19.3b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * acetate_sum_19.3b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * H+_sum_19.3b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey4) / H2_sum_19.3b * H2O_sum_19.3b)]
        ask prey4 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 0.6 and initial_concentration_acetates < 1 and temp > 293.15 and time > 1
  [
    let target5 hydrogens in-radius 50
    if target5 != nobody
    [
      let prey5 up-to-n-of 4 other target5
      let num_prey5 count prey5
      ifelse (sum [hydrogens_mass] of prey5) > uptake_HAB19
      [
        let food_19.4 min (list uptake_HAB19 [hydrogens_mass] of prey5)
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.4 energy_fs
        let fe_19.4 energy_fe

        let CO2_re_r_19.4 ( (1 / 4) * 1000 * fe_19.4)
        let H2_re_r_19.4 ((1 / 2) * 1000 * fe_19.4)
        let CO2_rs_r_19.4 ((1 / 5) * 1000 * fs_19.4)
        let NH4_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let HCO3_rs_r_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2_rs_r_19.4 ((1 / 2) * 1000 * fs_19.4)

        let acetate_re_p_19.4 (( 1 / 8) * 1000 * fe_19.4)
        let H2O_re_p_19.4 ((1 / 4) * 1000 * fe_19.4)
        let H+_re_p_19.4 ((1 / 8) * 1000 * fe_19.4)
        let biomass_rs_p_19.4 ((1 / 20) * 1000 * fs_19.4)
        let H2O_rs_p_19.4 ((9 / 20) * 1000 * fs_19.4)

        let H2O_sum_19.4 (H2O_re_p_19.4 + H2O_rs_p_19.4)
        let H2_sum_19.4 (H2_re_r_19.4 + H2_rs_r_19.4)
        let H+_sum_19.4 (H+_re_p_19.4)
        let CO2_sum_19.4 (CO2_re_r_19.4 + CO2_rs_r_19.4)
        let HCO3_sum_19.4 (HCO3_rs_r_19.4)
        let acetate_sum_19.4 (acetate_re_p_19.4)
        let NH4_sum_19.4 (NH4_rs_r_19.4)
        let biomass_sum_19.4 (biomass_rs_p_19.4)


        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.4 / H2_sum_19.4 * biomass_sum_19.4)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.4 / H2_sum_19.4 * HCO3_sum_19.4)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.4 / H2_sum_19.4 * NH4_sum_19.4)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.4 / H2_sum_19.4 * CO2_sum_19.4)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.4 / H2_sum_19.4 * acetate_sum_19.4) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.4 / H2_sum_19.4 * H+_sum_19.4) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.4 / H2_sum_19.4 * H2O_sum_19.4)]
        ask prey5 [set hydrogens_mass hydrogens_mass - (food_19.4 / num_prey5)]
      ]
      [
        set Gr_2 (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_19.4b energy_fs
        let fe_19.4b energy_fe

        let CO2_re_r_19.4b ( (1 / 4) * 1000 * fe_19.4b)
        let H2_re_r_19.4b ((1 / 2) * 1000 * fe_19.4b)
        let CO2_rs_r_19.4b ((1 / 5) * 1000 * fs_19.4b)
        let NH4_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let HCO3_rs_r_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2_rs_r_19.4b ((1 / 2) * 1000 * fs_19.4b)

        let acetate_re_p_19.4b (( 1 / 8) * 1000 * fe_19.4b)
        let H2O_re_p_19.4b ((1 / 4) * 1000 * fe_19.4b)
        let H+_re_p_19.4b ((1 / 8) * 1000 * fe_19.4b)
        let biomass_rs_p_19.4b ((1 / 20) * 1000 * fs_19.4b)
        let H2O_rs_p_19.4b ((9 / 20) * 1000 * fs_19.4b)

        let H2O_sum_19.4b (H2O_re_p_19.4b + H2O_rs_p_19.4b)
        let H2_sum_19.4b (H2_re_r_19.4b + H2_rs_r_19.4b)
        let H+_sum_19.4b (H+_re_p_19.4b)
        let CO2_sum_19.4b (CO2_re_r_19.4b + CO2_rs_r_19.4b)
        let HCO3_sum_19.4b (HCO3_rs_r_19.4b)
        let acetate_sum_19.4b (acetate_re_p_19.4b)
        let NH4_sum_19.4b (NH4_rs_r_19.4b)
        let biomass_sum_19.4b (biomass_rs_p_19.4b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * biomass_sum_19.4b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * HCO3_sum_19.4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * NH4_sum_19.4b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * CO2_sum_19.4b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * acetate_sum_19.4b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * H+_sum_19.4b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey5) / H2_sum_19.4b * H2O_sum_19.4b)]
        ask prey5 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 1 and initial_concentration_acetates < 2 and temp > 293.15 and time > 1
[
    let target6 hydrogens in-radius 50
    if target6 != nobody
    [
      let prey6 up-to-n-of 7 other target6
    let num_prey6 count prey6
      ifelse (sum [hydrogens_mass] of prey6) > uptake_HAB19
      [
        let food_19.5 min (list uptake_HAB19 [hydrogens_mass] of prey6)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5 energy_fs
        let fe_19.5 energy_fe

        let CO2_re_r_19.5 ( (1 / 4) * 1000 * fe_19.5)
        let H2_re_r_19.5 ((1 / 2) * 1000 * fe_19.5)
        let CO2_rs_r_19.5 ((1 / 5) * 1000 * fs_19.5)
        let NH4_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let HCO3_rs_r_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2_rs_r_19.5 ((1 / 2) * 1000 * fs_19.5)

        let acetate_re_p_19.5 (( 1 / 8) * 1000 * fe_19.5)
        let H2O_re_p_19.5 ((1 / 4) * 1000 * fe_19.5)
        let H+_re_p_19.5 ((1 / 8) * 1000 * fe_19.5)
        let biomass_rs_p_19.5 ((1 / 20) * 1000 * fs_19.5)
        let H2O_rs_p_19.5 ((9 / 20) * 1000 * fs_19.5)

        let H2O_sum_19.5 (H2O_re_p_19.5 + H2O_rs_p_19.5)
        let H2_sum_19.5 (H2_re_r_19.5 + H2_rs_r_19.5)
        let H+_sum_19.5 (H+_re_p_19.5)
        let CO2_sum_19.5 (CO2_re_r_19.5 + CO2_rs_r_19.5)
        let HCO3_sum_19.5 (HCO3_rs_r_19.5)
        let acetate_sum_19.5 (acetate_re_p_19.5)
        let NH4_sum_19.5 (NH4_rs_r_19.5)
        let biomass_sum_19.5 (biomass_rs_p_19.5)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.5 / H2_sum_19.5 * biomass_sum_19.5)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.5 / H2_sum_19.5 * HCO3_sum_19.5)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.5 / H2_sum_19.5 * NH4_sum_19.5)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.5 / H2_sum_19.5 * CO2_sum_19.5)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.5 / H2_sum_19.5 * acetate_sum_19.5) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.5 / H2_sum_19.5 * H+_sum_19.5) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.5 / H2_sum_19.5 * H2O_sum_19.5)]
        ask prey6 [set hydrogens_mass hydrogens_mass - (food_19.5 / num_prey6)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.5b energy_fs
        let fe_19.5b energy_fe

        let CO2_re_r_19.5b ( (1 / 4) * 1000 * fe_19.5b)
        let H2_re_r_19.5b ((1 / 2) * 1000 * fe_19.5b)
        let CO2_rs_r_19.5b ((1 / 5) * 1000 * fs_19.5b)
        let NH4_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let HCO3_rs_r_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2_rs_r_19.5b ((1 / 2) * 1000 * fs_19.5b)

        let acetate_re_p_19.5b (( 1 / 8) * 1000 * fe_19.5b)
        let H2O_re_p_19.5b ((1 / 4) * 1000 * fe_19.5b)
        let H+_re_p_19.5b ((1 / 8) * 1000 * fe_19.5b)
        let biomass_rs_p_19.5b ((1 / 20) * 1000 * fs_19.5b)
        let H2O_rs_p_19.5b ((9 / 20) * 1000 * fs_19.5b)

        let H2O_sum_19.5b (H2O_re_p_19.5b + H2O_rs_p_19.5b)
        let H2_sum_19.5b (H2_re_r_19.5b + H2_rs_r_19.5b)
        let H+_sum_19.5b (H+_re_p_19.5b)
        let CO2_sum_19.5b (CO2_re_r_19.5b + CO2_rs_r_19.5b)
        let HCO3_sum_19.5b (HCO3_rs_r_19.5b)
        let acetate_sum_19.5b (acetate_re_p_19.5b)
        let NH4_sum_19.5b (NH4_rs_r_19.5b)
        let biomass_sum_19.5b (biomass_rs_p_19.5b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * biomass_sum_19.5b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * HCO3_sum_19.5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * NH4_sum_19.5b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * CO2_sum_19.5b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * acetate_sum_19.5b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * H+_sum_19.5b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey6) / H2_sum_19.5b * H2O_sum_19.5b)]
        ask prey6 [die]
      ]
    ]
]
if initial_concentration_acetates >= 2 and initial_concentration_acetates < 3 and temp > 293.15 and time > 1
[
    let target7 hydrogens in-radius 50
    if target7 != nobody
    [
      let prey7 up-to-n-of 8 other target7
    let num_prey7 count prey7
      ifelse (sum [hydrogens_mass] of prey7) > uptake_HAB19
      [
        let food_19.6 min (list uptake_HAB19 [hydrogens_mass] of prey7)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6 energy_fs
        let fe_19.6 energy_fe

        let CO2_re_r_19.6 ( (1 / 4) * 1000 * fe_19.6)
        let H2_re_r_19.6 ((1 / 2) * 1000 * fe_19.6)
        let CO2_rs_r_19.6 ((1 / 5) * 1000 * fs_19.6)
        let NH4_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let HCO3_rs_r_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2_rs_r_19.6 ((1 / 2) * 1000 * fs_19.6)

        let acetate_re_p_19.6 (( 1 / 8) * 1000 * fe_19.6)
        let H2O_re_p_19.6 ((1 / 4) * 1000 * fe_19.6)
        let H+_re_p_19.6 ((1 / 8) * 1000 * fe_19.6)
        let biomass_rs_p_19.6 ((1 / 20) * 1000 * fs_19.6)
        let H2O_rs_p_19.6 ((9 / 20) * 1000 * fs_19.6)

        let H2O_sum_19.6 (H2O_re_p_19.6 + H2O_rs_p_19.6)
        let H2_sum_19.6 (H2_re_r_19.6 + H2_rs_r_19.6)
        let H+_sum_19.6 (H+_re_p_19.6)
        let CO2_sum_19.6 (CO2_re_r_19.6 + CO2_rs_r_19.6)
        let HCO3_sum_19.6 (HCO3_rs_r_19.6)
        let acetate_sum_19.6 (acetate_re_p_19.6)
        let NH4_sum_19.6 (NH4_rs_r_19.6)
        let biomass_sum_19.6 (biomass_rs_p_19.6)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.6 / H2_sum_19.6 * biomass_sum_19.6)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.6 / H2_sum_19.6 * HCO3_sum_19.6)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.6 / H2_sum_19.6 * NH4_sum_19.6)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.6 / H2_sum_19.6 * CO2_sum_19.6)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.6 / H2_sum_19.6 * acetate_sum_19.6) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.6 / H2_sum_19.6 * H+_sum_19.6) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.6 / H2_sum_19.6 * H2O_sum_19.6)]
        ask prey7 [set hydrogens_mass hydrogens_mass - (food_19.6 / num_prey7)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.6b energy_fs
        let fe_19.6b energy_fe

        let CO2_re_r_19.6b ( (1 / 4) * 1000 * fe_19.6b)
        let H2_re_r_19.6b ((1 / 2) * 1000 * fe_19.6b)
        let CO2_rs_r_19.6b ((1 / 5) * 1000 * fs_19.6b)
        let NH4_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let HCO3_rs_r_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2_rs_r_19.6b ((1 / 2) * 1000 * fs_19.6b)

        let acetate_re_p_19.6b (( 1 / 8) * 1000 * fe_19.6b)
        let H2O_re_p_19.6b ((1 / 4) * 1000 * fe_19.6b)
        let H+_re_p_19.6b ((1 / 8) * 1000 * fe_19.6b)
        let biomass_rs_p_19.6b ((1 / 20) * 1000 * fs_19.6b)
        let H2O_rs_p_19.6b ((9 / 20) * 1000 * fs_19.6b)

        let H2O_sum_19.6b (H2O_re_p_19.6b + H2O_rs_p_19.6b)
        let H2_sum_19.6b (H2_re_r_19.6b + H2_rs_r_19.6b)
        let H+_sum_19.6b (H+_re_p_19.6b)
        let CO2_sum_19.6b (CO2_re_r_19.6b + CO2_rs_r_19.6b)
        let HCO3_sum_19.6b (HCO3_rs_r_19.6b)
        let acetate_sum_19.6b (acetate_re_p_19.6b)
        let NH4_sum_19.6b (NH4_rs_r_19.6b)
        let biomass_sum_19.6b (biomass_rs_p_19.6b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * biomass_sum_19.6b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * HCO3_sum_19.6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * NH4_sum_19.6b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * CO2_sum_19.6b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * acetate_sum_19.6b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * H+_sum_19.6b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey7) / H2_sum_19.6b * H2O_sum_19.6b)]
        ask prey7 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 3 and temp > 293.15 and time > 1
[
    let target8 hydrogens in-radius 50
    if target8 != nobody
    [
      let prey8 up-to-n-of 15 other target8
    let num_prey8 count prey8
      ifelse (sum [hydrogens_mass] of prey8) > uptake_HAB19
      [
        let food_19.7 min (list uptake_HAB19 [hydrogens_mass] of prey8)
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7 energy_fs
        let fe_19.7 energy_fe

        let CO2_re_r_19.7 ( (1 / 4) * 1000 * fe_19.7)
        let H2_re_r_19.7 ((1 / 2) * 1000 * fe_19.7)
        let CO2_rs_r_19.7 ((1 / 5) * 1000 * fs_19.7)
        let NH4_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let HCO3_rs_r_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2_rs_r_19.7 ((1 / 2) * 1000 * fs_19.7)

        let acetate_re_p_19.7 (( 1 / 8) * 1000 * fe_19.7)
        let H2O_re_p_19.7 ((1 / 4) * 1000 * fe_19.7)
        let H+_re_p_19.7 ((1 / 8) * 1000 * fe_19.7)
        let biomass_rs_p_19.7 ((1 / 20) * 1000 * fs_19.7)
        let H2O_rs_p_19.7 ((9 / 20) * 1000 * fs_19.7)

        let H2O_sum_19.7 (H2O_re_p_19.7 + H2O_rs_p_19.7)
        let H2_sum_19.7 (H2_re_r_19.7 + H2_rs_r_19.7)
        let H+_sum_19.7 (H+_re_p_19.7)
        let CO2_sum_19.7 (CO2_re_r_19.7 + CO2_rs_r_19.7)
        let HCO3_sum_19.7 (HCO3_rs_r_19.7)
        let acetate_sum_19.7 (acetate_re_p_19.7)
        let NH4_sum_19.7 (NH4_rs_r_19.7)
        let biomass_sum_19.7 (biomass_rs_p_19.7)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + (food_19.7 / H2_sum_19.7 * biomass_sum_19.7)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_19.7 / H2_sum_19.7 * HCO3_sum_19.7)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_19.7 / H2_sum_19.7 * NH4_sum_19.7)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_19.7 / H2_sum_19.7 * CO2_sum_19.7)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + (food_19.7 / H2_sum_19.7 * acetate_sum_19.7) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + (food_19.7 / H2_sum_19.7 * H+_sum_19.7) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + (food_19.7 / H2_sum_19.7 * H2O_sum_19.7)]
        ask prey8 [set hydrogens_mass hydrogens_mass - (food_19.7 / num_prey8)]
      ]
      [
        set Gr (-13.9495 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((Initial_concentration_acetates ^ (1 / 8)) * (1 ^ (1 / 4)) * ((10 ^ -4) ^ (1 / 8))) / ((LCO2 ^ (1 / 4)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((4.7800 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_19.7b energy_fs
        let fe_19.7b energy_fe

        let CO2_re_r_19.7b ( (1 / 4) * 1000 * fe_19.7b)
        let H2_re_r_19.7b ((1 / 2) * 1000 * fe_19.7b)
        let CO2_rs_r_19.7b ((1 / 5) * 1000 * fs_19.7b)
        let NH4_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let HCO3_rs_r_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2_rs_r_19.7b ((1 / 2) * 1000 * fs_19.7b)

        let acetate_re_p_19.7b (( 1 / 8) * 1000 * fe_19.7b)
        let H2O_re_p_19.7b ((1 / 4) * 1000 * fe_19.7b)
        let H+_re_p_19.7b ((1 / 8) * 1000 * fe_19.7b)
        let biomass_rs_p_19.7b ((1 / 20) * 1000 * fs_19.7b)
        let H2O_rs_p_19.7b ((9 / 20) * 1000 * fs_19.7b)

        let H2O_sum_19.7b (H2O_re_p_19.7b + H2O_rs_p_19.7b)
        let H2_sum_19.7b (H2_re_r_19.7b + H2_rs_r_19.7b)
        let H+_sum_19.7b (H+_re_p_19.7b)
        let CO2_sum_19.7b (CO2_re_r_19.7b + CO2_rs_r_19.7b)
        let HCO3_sum_19.7b (HCO3_rs_r_19.7b)
        let acetate_sum_19.7b (acetate_re_p_19.7b)
        let NH4_sum_19.7b (NH4_rs_r_19.7b)
        let biomass_sum_19.7b (biomass_rs_p_19.7b)

        set Acetobacterium.woodii_FB5/HAB19_mass Acetobacterium.woodii_FB5/HAB19_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * biomass_sum_19.7b)
        ask one-of bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * HCO3_sum_19.7b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * NH4_sum_19.7b)]
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * CO2_sum_19.7b)]
        hatch-acetates 1 [set color yellow set size 0.5 set acetates_mass acetates_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * acetate_sum_19.7b) rt random 360 fd 1]
        hatch-protons 1 [set color cyan set size 0.5 set protons_mass protons_mass + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * H+_sum_19.7b) right random 360 fd 4]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey8) / H2_sum_19.7b * H2O_sum_19.7b)]
        ask prey8 [die]
      ]
    ]
]
end

to reproduce_FB5/HAB19_AW
  if Acetobacterium.woodii_FB5/HAB19_mass > 1
  [
  set Acetobacterium.woodii_FB5/HAB19_mass (Acetobacterium.woodii_FB5/HAB19_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_FB5 0.0207
  set uptake_HAB19 0.1876
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_FB5/HAB19_AW
  set Acetobacterium.woodii_FB5/HAB19_mass (Acetobacterium.woodii_FB5/HAB19_mass - Acetobacterium.woodii_FB5/HAB19_mass * (0.015 / 24)) ;; Represents decay rate per hour based on Saady, 2013.
end


;;;; METHANOSARCINALES ;;; Qu et al., 2009 states that Methanosarcinales would also consume H2

;;;METHANOSARCINALES AM21/HM22;;;; For Equation 21 and Equation 22

to AM21/HM22_eat_acetate_or_hydrogen;; Methanosarcinal barkeri procedure ;; maximum uptake rate is up to 14.57 mmol/mmmol d so... 0.6 mmol/mmol h from Ling et al., 2018 based on Wandrey and Aivasidis 1983 for Metanosarcina barkeri.

if initial_concentration_acetates >= 1 and initial_concentration_acetates < 1.5 and temp > 293.15 and temp < 317 and time > 1
  [
    let target acetates in-radius 50
    if target != nobody
    [
      let prey up-to-n-of 4 target
      let num_prey count prey
      ifelse (sum [acetates_mass] of prey) > uptake_AM21
      [
        let food_21 min (list uptake_AM21 [acetates_mass] of prey)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21 energy_fs_acetate
        let fe_21 energy_fe

        let acetate_re_r_21 ( (1 / 8) * 1000 * fe_21)
        let H+_re_r_21 ( (1 / 8) * 1000 * fe_21)
        let NH4_rs_r_21 ((1 / 20) * 1000 * fs_21)
        let HCO3_rs_r_21 ((1 / 20) * 1000 * fs_21)
        let H+_rs_r_21 ((1 / 8) * 1000 * fs_21)
        let acetate_rs_r_21 ((1 / 8) * 1000 * fs_21)

        let CH4_re_p_21 (( 1 / 8) * 1000 * fe_21)
        let CO2_re_p_21 ((1 / 8) * 1000 * fe_21)
        let biomass_rs_p_21 ((1 / 20) * 1000 * fs_21)
        let CO2_rs_p_21 ((1 / 20) * 1000 * fs_21)
        let H2O_rs_p_21 ((1 / 5) * 1000 * fs_21)

        let H2O_sum_21 (H2O_rs_p_21)
        let H+_sum_21 (H+_re_r_21 + H+_rs_r_21)
        let CO2_sum_21 (CO2_re_p_21 + CO2_rs_p_21)
        let HCO3_sum_21 (HCO3_rs_r_21)
        let CH4_sum_21 (CH4_re_p_21)
        let acetate_sum_21 (acetate_re_r_21 + acetate_rs_r_21)
        let NH4_sum_21 (NH4_rs_r_21)
        let biomass_sum_21 (biomass_rs_p_21)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21 / acetate_sum_21 * biomass_sum_21)
        ask one-of protons [set protons_mass protons_mass - (food_21 / acetate_sum_21 * H+_sum_21)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21 / acetate_sum_21 * NH4_sum_21)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21 / acetate_sum_21 * HCO3_sum_21)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21 / acetate_sum_21 * CH4_sum_21) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21 / acetate_sum_21 * CO2_sum_21) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21 / acetate_sum_21 * H2O_sum_21)]
        ask prey [set acetates_mass acetates_mass - (food_21 / num_prey)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21b energy_fs_acetate
        let fe_21b energy_fe

        let acetate_re_r_21b (( 1 / 8) * 1000 * fe_21b)
        let H+_re_r_21b (( 1 / 8) * 1000 * fe_21b)
        let NH4_rs_r_21b ((1 / 20) * 1000 * fs_21b)
        let HCO3_rs_r_21b ((1 / 20) * 1000 * fs_21b)
        let H+_rs_r_21b ((1 / 8) * 1000 * fs_21b)
        let acetate_rs_r_21b ((1 / 8) * 1000 * fs_21b)

        let CH4_re_p_21b (( 1 / 8) * 1000 * fe_21b)
        let CO2_re_p_21b ((1 / 8) * 1000 * fe_21b)
        let biomass_rs_p_21b ((1 / 20) * 1000 * fs_21b)
        let CO2_rs_p_21b ((1 / 20) * 1000 * fs_21b)
        let H2O_rs_p_21b ((1 / 5) * 1000 * fs_21b)

        let H2O_sum_21b (H2O_rs_p_21b)
        let H+_sum_21b (H+_re_r_21b + H+_rs_r_21b)
        let CO2_sum_21b (CO2_re_p_21b + CO2_rs_p_21b)
        let HCO3_sum_21b (HCO3_rs_r_21b)
        let CH4_sum_21b (CH4_re_p_21b)
        let acetate_sum_21b (acetate_re_r_21b + acetate_rs_r_21b)
        let NH4_sum_21b (NH4_rs_r_21b)
        let biomass_sum_21b (biomass_rs_p_21b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * biomass_sum_21b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * H+_sum_21b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * NH4_sum_21b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * HCO3_sum_21b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * CH4_sum_21b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * CO2_sum_21b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey) / acetate_sum_21b * H2O_sum_21b)]
        ask prey [die]
      ]
    ]
]
if initial_concentration_acetates >= 1.5 and initial_concentration_acetates < 2 and temp > 293.15 and temp < 317 and time > 1
  [
    let target2 acetates in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 6 target2
      let num_prey2 count prey2
      ifelse (sum [acetates_mass] of prey2) > uptake_AM21
      [
        let food_21.2 min (list uptake_AM21 [acetates_mass] of prey2)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21.2 energy_fs_acetate
        let fe_21.2 energy_fe

        let acetate_re_r_21.2 ( (1 / 8) * 1000 * fe_21.2)
        let H+_re_r_21.2 ( (1 / 8) * 1000 * fe_21.2)
        let NH4_rs_r_21.2 ((1 / 20) * 1000 * fs_21.2)
        let HCO3_rs_r_21.2 ((1 / 20) * 1000 * fs_21.2)
        let H+_rs_r_21.2 ((1 / 8) * 1000 * fs_21.2)
        let acetate_rs_r_21.2 ((1 / 8) * 1000 * fs_21.2)

        let CH4_re_p_21.2 (( 1 / 8) * 1000 * fe_21.2)
        let CO2_re_p_21.2 ((1 / 8) * 1000 * fe_21.2)
        let biomass_rs_p_21.2 ((1 / 20) * 1000 * fs_21.2)
        let CO2_rs_p_21.2 ((1 / 20) * 1000 * fs_21.2)
        let H2O_rs_p_21.2 ((1 / 5) * 1000 * fs_21.2)

        let H2O_sum_21.2 (H2O_rs_p_21.2)
        let H+_sum_21.2 (H+_re_r_21.2 + H+_rs_r_21.2)
        let CO2_sum_21.2 (CO2_re_p_21.2 + CO2_rs_p_21.2)
        let HCO3_sum_21.2 (HCO3_rs_r_21.2)
        let CH4_sum_21.2 (CH4_re_p_21.2)
        let acetate_sum_21.2 (acetate_re_r_21.2 + acetate_rs_r_21.2)
        let NH4_sum_21.2 (NH4_rs_r_21.2)
        let biomass_sum_21.2 (biomass_rs_p_21.2)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21.2 / acetate_sum_21.2 * biomass_sum_21.2)
        ask one-of protons [set protons_mass protons_mass - (food_21.2 / acetate_sum_21.2 * H+_sum_21.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.2 / acetate_sum_21.2 * NH4_sum_21.2)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.2 / acetate_sum_21.2 * HCO3_sum_21.2)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.2 / acetate_sum_21.2 * CH4_sum_21.2) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.2 / acetate_sum_21.2 * CO2_sum_21.2) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.2 / acetate_sum_21.2 * H2O_sum_21.2)]
        ask prey2 [set acetates_mass acetates_mass - (food_21.2 / num_prey2)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.2b energy_fs_acetate
        let fe_21.2b energy_fe

        let acetate_re_r_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let H+_re_r_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let NH4_rs_r_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let HCO3_rs_r_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let H+_rs_r_21.2b ((1 / 8) * 1000 * fs_21.2b)
        let acetate_rs_r_21.2b ((1 / 8) * 1000 * fs_21.2b)

        let CH4_re_p_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let CO2_re_p_21.2b ((1 / 8) * 1000 * fe_21.2b)
        let biomass_rs_p_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let CO2_rs_p_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let H2O_rs_p_21.2b ((1 / 5) * 1000 * fs_21.2b)

        let H2O_sum_21.2b (H2O_rs_p_21.2b)
        let H+_sum_21.2b (H+_re_r_21.2b + H+_rs_r_21.2b)
        let CO2_sum_21.2b (CO2_re_p_21.2b + CO2_rs_p_21.2b)
        let HCO3_sum_21.2b (HCO3_rs_r_21.2b)
        let CH4_sum_21.2b (CH4_re_p_21.2b)
        let acetate_sum_21.2b (acetate_re_r_21.2b + acetate_rs_r_21.2b)
        let NH4_sum_21.2b (NH4_rs_r_21.2b)
        let biomass_sum_21.2b (biomass_rs_p_21.2b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * biomass_sum_21.2b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * H+_sum_21.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * NH4_sum_21.2b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * HCO3_sum_21.2b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * CH4_sum_21.2b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * CO2_sum_21.2b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * H2O_sum_21.2b)]
        ask prey2 [die]
      ]
    ]
]
  if initial_concentration_acetates >=  2 and initial_concentration_acetates < 2.5 and temp > 293.15 and temp < 317 and time > 1
  [
    let target3 acetates in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 5 target3
      let num_prey3 count prey3
      ifelse (sum [acetates_mass] of prey3) > uptake_AM21
      [
        let food_21.3 min (list uptake_AM21 [acetates_mass] of prey3)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21.3 energy_fs_acetate
        let fe_21.3 energy_fe

        let acetate_re_r_21.3 ( (1 / 8) * 1000 * fe_21.3)
        let H+_re_r_21.3 ( (1 / 8) * 1000 * fe_21.3)
        let NH4_rs_r_21.3 ((1 / 20) * 1000 * fs_21.3)
        let HCO3_rs_r_21.3 ((1 / 20) * 1000 * fs_21.3)
        let H+_rs_r_21.3 ((1 / 8) * 1000 * fs_21.3)
        let acetate_rs_r_21.3 ((1 / 8) * 1000 * fs_21.3)

        let CH4_re_p_21.3 (( 1 / 8) * 1000 * fe_21.3)
        let CO2_re_p_21.3 ((1 / 8) * 1000 * fe_21.3)
        let biomass_rs_p_21.3 ((1 / 20) * 1000 * fs_21.3)
        let CO2_rs_p_21.3 ((1 / 20) * 1000 * fs_21.3)
        let H2O_rs_p_21.3 ((1 / 5) * 1000 * fs_21.3)

        let H2O_sum_21.3 (H2O_rs_p_21.3)
        let H+_sum_21.3 (H+_re_r_21.3 + H+_rs_r_21.3)
        let CO2_sum_21.3 (CO2_re_p_21.3 + CO2_rs_p_21.3)
        let HCO3_sum_21.3 (HCO3_rs_r_21.3)
        let CH4_sum_21.3 (CH4_re_p_21.3)
        let acetate_sum_21.3 (acetate_re_r_21.3 + acetate_rs_r_21.3)
        let NH4_sum_21.3 (NH4_rs_r_21.3)
        let biomass_sum_21.3 (biomass_rs_p_21.3)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21.3 / acetate_sum_21.3 * biomass_sum_21.3)
        ask one-of protons [set protons_mass protons_mass - (food_21.3 / acetate_sum_21.3 * H+_sum_21.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.3 / acetate_sum_21.3 * NH4_sum_21.3)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.3 / acetate_sum_21.3 * HCO3_sum_21.3)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.3 / acetate_sum_21.3 * CH4_sum_21.3) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.3 / acetate_sum_21.3 * CO2_sum_21.3) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.3 / acetate_sum_21.3 * H2O_sum_21.3)]
        ask prey3 [set acetates_mass acetates_mass - (food_21.3 / num_prey3)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.3b energy_fs_acetate
        let fe_21.3b energy_fe

        let acetate_re_r_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let H+_re_r_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let NH4_rs_r_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let HCO3_rs_r_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let H+_rs_r_21.3b ((1 / 8) * 1000 * fs_21.3b)
        let acetate_rs_r_21.3b ((1 / 8) * 1000 * fs_21.3b)

        let CH4_re_p_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let CO2_re_p_21.3b ((1 / 8) * 1000 * fe_21.3b)
        let biomass_rs_p_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let CO2_rs_p_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let H2O_rs_p_21.3b ((1 / 5) * 1000 * fs_21.3b)

        let H2O_sum_21.3b (H2O_rs_p_21.3b)
        let H+_sum_21.3b (H+_re_r_21.3b + H+_rs_r_21.3b)
        let CO2_sum_21.3b (CO2_re_p_21.3b + CO2_rs_p_21.3b)
        let HCO3_sum_21.3b (HCO3_rs_r_21.3b)
        let CH4_sum_21.3b (CH4_re_p_21.3b)
        let acetate_sum_21.3b (acetate_re_r_21.3b + acetate_rs_r_21.3b)
        let NH4_sum_21.3b (NH4_rs_r_21.3b)
        let biomass_sum_21.3b (biomass_rs_p_21.3b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * biomass_sum_21.3b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * H+_sum_21.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * NH4_sum_21.3b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * HCO3_sum_21.3b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * CH4_sum_21.3b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * CO2_sum_21.3b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * H2O_sum_21.3b)]
        ask prey3 [die]
      ]
    ]
]
 if initial_concentration_acetates >=  2.5 and initial_concentration_acetates < 4 and temp > 293.15 and temp < 317 and time > 1
  [
    let target7 acetates in-radius 50
    if target7 != nobody
    [
      let prey7 up-to-n-of 15 target7
      let num_prey7 count prey7
      ifelse (sum [acetates_mass] of prey7) > uptake_AM21
      [
        let food_21.4 min (list uptake_AM21 [acetates_mass] of prey7)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21.4 energy_fs_acetate
        let fe_21.4 energy_fe

        let acetate_re_r_21.4 ( (1 / 8) * 1000 * fe_21.4)
        let H+_re_r_21.4 ( (41 / 8) * 1000 * fe_21.4)
        let NH4_rs_r_21.4 ((1 / 20) * 1000 * fs_21.4)
        let HCO3_rs_r_21.4 ((1 / 20) * 1000 * fs_21.4)
        let H+_rs_r_21.4 ((1 / 8) * 1000 * fs_21.4)
        let acetate_rs_r_21.4 ((1 / 8) * 1000 * fs_21.4)

        let CH4_re_p_21.4 (( 1 / 8) * 1000 * fe_21.4)
        let CO2_re_p_21.4 ((1 / 8) * 1000 * fe_21.4)
        let biomass_rs_p_21.4 ((1 / 20) * 1000 * fs_21.4)
        let CO2_rs_p_21.4 ((1 / 20) * 1000 * fs_21.4)
        let H2O_rs_p_21.4 ((1 / 5) * 1000 * fs_21.4)

        let H2O_sum_21.4 (H2O_rs_p_21.4)
        let H+_sum_21.4 (H+_re_r_21.4 + H+_rs_r_21.4)
        let CO2_sum_21.4 (CO2_re_p_21.4 + CO2_rs_p_21.4)
        let HCO3_sum_21.4 (HCO3_rs_r_21.4)
        let CH4_sum_21.4 (CH4_re_p_21.4)
        let acetate_sum_21.4 (acetate_re_r_21.4 + acetate_rs_r_21.4)
        let NH4_sum_21.4 (NH4_rs_r_21.4)
        let biomass_sum_21.4 (biomass_rs_p_21.4)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21.4 / acetate_sum_21.4 * biomass_sum_21.4)
        ask one-of protons [set protons_mass protons_mass - (food_21.4 / acetate_sum_21.4 * H+_sum_21.4)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.4 / acetate_sum_21.4 * NH4_sum_21.4)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.4 / acetate_sum_21.4 * HCO3_sum_21.4)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.4 / acetate_sum_21.4 * CH4_sum_21.4) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.4 / acetate_sum_21.4 * CO2_sum_21.4) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.4 / acetate_sum_21.4 * H2O_sum_21.4)]
        ask prey7 [set acetates_mass acetates_mass - (food_21.4 / num_prey7)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.4b energy_fs_acetate
        let fe_21.4b energy_fe

        let acetate_re_r_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let H+_re_r_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let NH4_rs_r_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let HCO3_rs_r_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let H+_rs_r_21.4b ((1 / 8) * 1000 * fs_21.4b)
        let acetate_rs_r_21.4b ((1 / 8) * 1000 * fs_21.4b)

        let CH4_re_p_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let CO2_re_p_21.4b ((1 / 8) * 1000 * fe_21.4b)
        let biomass_rs_p_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let CO2_rs_p_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let H2O_rs_p_21.4b ((1 / 5) * 1000 * fs_21.4b)

        let H2O_sum_21.4b (H2O_rs_p_21.4b)
        let H+_sum_21.4b (H+_re_r_21.4b + H+_rs_r_21.4b)
        let CO2_sum_21.4b (CO2_re_p_21.4b + CO2_rs_p_21.4b)
        let HCO3_sum_21.4b (HCO3_rs_r_21.4b)
        let CH4_sum_21.4b (CH4_re_p_21.4b)
        let acetate_sum_21.4b (acetate_re_r_21.4b + acetate_rs_r_21.4b)
        let NH4_sum_21.4b (NH4_rs_r_21.4b)
        let biomass_sum_21.4b (biomass_rs_p_21.4b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * biomass_sum_21.4b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * H+_sum_21.4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * NH4_sum_21.4b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * HCO3_sum_21.4b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * CH4_sum_21.4b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * CO2_sum_21.4b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey7) / acetate_sum_21.4b * H2O_sum_21.4b)]
        ask prey7 [die]
      ]
    ]
]
 if initial_concentration_acetates >= 4 and initial_concentration_acetates < 4.5 and temp > 293.15 and temp < 317 and time > 1
  [
    let target8 acetates in-radius 50
    if target8 != nobody
    [
      let prey8 up-to-n-of 25 target8
      let num_prey8 count prey8
      ifelse (sum [acetates_mass] of prey8) > uptake_AM21
      [
        let food_21.5 min (list uptake_AM21 [acetates_mass] of prey8)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21.5 energy_fs_acetate
        let fe_21.5 energy_fe

        let acetate_re_r_21.5 ( (1 / 8) * 1000 * fe_21.5)
        let H+_re_r_21.5 ( (41 / 8) * 1000 * fe_21.5)
        let NH4_rs_r_21.5 ((1 / 20) * 1000 * fs_21.5)
        let HCO3_rs_r_21.5 ((1 / 20) * 1000 * fs_21.5)
        let H+_rs_r_21.5 ((1 / 8) * 1000 * fs_21.5)
        let acetate_rs_r_21.5 ((1 / 8) * 1000 * fs_21.5)

        let CH4_re_p_21.5 (( 1 / 8) * 1000 * fe_21.5)
        let CO2_re_p_21.5 ((1 / 8) * 1000 * fe_21.5)
        let biomass_rs_p_21.5 ((1 / 20) * 1000 * fs_21.5)
        let CO2_rs_p_21.5 ((1 / 20) * 1000 * fs_21.5)
        let H2O_rs_p_21.5 ((1 / 5) * 1000 * fs_21.5)

        let H2O_sum_21.5 (H2O_rs_p_21.5)
        let H+_sum_21.5 (H+_re_r_21.5 + H+_rs_r_21.5)
        let CO2_sum_21.5 (CO2_re_p_21.5 + CO2_rs_p_21.5)
        let HCO3_sum_21.5 (HCO3_rs_r_21.5)
        let CH4_sum_21.5 (CH4_re_p_21.5)
        let acetate_sum_21.5 (acetate_re_r_21.5 + acetate_rs_r_21.5)
        let NH4_sum_21.5 (NH4_rs_r_21.5)
        let biomass_sum_21.5 (biomass_rs_p_21.5)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21.5 / acetate_sum_21.5 * biomass_sum_21.5)
        ask one-of protons [set protons_mass protons_mass - (food_21.5 / acetate_sum_21.5 * H+_sum_21.5)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.5 / acetate_sum_21.5 * NH4_sum_21.5)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.5 / acetate_sum_21.5 * HCO3_sum_21.5)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.5 / acetate_sum_21.5 * CH4_sum_21.5) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.5 / acetate_sum_21.5 * CO2_sum_21.5) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.5 / acetate_sum_21.5 * H2O_sum_21.5)]
        ask prey8 [set acetates_mass acetates_mass - (food_21.5 / num_prey8)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.5b energy_fs_acetate
        let fe_21.5b energy_fe

        let acetate_re_r_21.5b (( 1 / 8) * 1000 * fe_21.5b)
        let H+_re_r_21.5b (( 1 / 8) * 1000 * fe_21.5b)
        let NH4_rs_r_21.5b ((1 / 20) * 1000 * fs_21.5b)
        let HCO3_rs_r_21.5b ((1 / 20) * 1000 * fs_21.5b)
        let H+_rs_r_21.5b ((1 / 8) * 1000 * fs_21.5b)
        let acetate_rs_r_21.5b ((1 / 8) * 1000 * fs_21.5b)

        let CH4_re_p_21.5b (( 1 / 8) * 1000 * fe_21.5b)
        let CO2_re_p_21.5b ((1 / 8) * 1000 * fe_21.5b)
        let biomass_rs_p_21.5b ((1 / 20) * 1000 * fs_21.5b)
        let CO2_rs_p_21.5b ((1 / 20) * 1000 * fs_21.5b)
        let H2O_rs_p_21.5b ((1 / 5) * 1000 * fs_21.5b)

        let H2O_sum_21.5b (H2O_rs_p_21.5b)
        let H+_sum_21.5b (H+_re_r_21.5b + H+_rs_r_21.5b)
        let CO2_sum_21.5b (CO2_re_p_21.5b + CO2_rs_p_21.5b)
        let HCO3_sum_21.5b (HCO3_rs_r_21.5b)
        let CH4_sum_21.5b (CH4_re_p_21.5b)
        let acetate_sum_21.5b (acetate_re_r_21.5b + acetate_rs_r_21.5b)
        let NH4_sum_21.5b (NH4_rs_r_21.5b)
        let biomass_sum_21.5b (biomass_rs_p_21.5b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * biomass_sum_21.5b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * H+_sum_21.5b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * NH4_sum_21.5b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * HCO3_sum_21.5b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * CH4_sum_21.5b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * CO2_sum_21.5b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey8) / acetate_sum_21.5b * H2O_sum_21.5b)]
        ask prey8 [die]
      ]
    ]
]
 if initial_concentration_acetates >= 4.5 and temp > 293.15 and temp < 317 and time > 1
  [
    let target9 acetates in-radius 50
    if target9 != nobody
    [
      let prey9 up-to-n-of 30 target9
      let num_prey9 count prey9
      ifelse (sum [acetates_mass] of prey9) > uptake_AM21
      [
        let food_21.6 min (list uptake_AM21 [acetates_mass] of prey9)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs_acetate)
        let fs_21.6 energy_fs_acetate
        let fe_21.6 energy_fe

        let acetate_re_r_21.6 ( (1 / 8) * 1000 * fe_21.6)
        let H+_re_r_21.6 ( (41 / 8) * 1000 * fe_21.6)
        let NH4_rs_r_21.6 ((1 / 20) * 1000 * fs_21.6)
        let HCO3_rs_r_21.6 ((1 / 20) * 1000 * fs_21.6)
        let H+_rs_r_21.6 ((1 / 8) * 1000 * fs_21.6)
        let acetate_rs_r_21.6 ((1 / 8) * 1000 * fs_21.6)

        let CH4_re_p_21.6 (( 1 / 8) * 1000 * fe_21.6)
        let CO2_re_p_21.6 ((1 / 8) * 1000 * fe_21.6)
        let biomass_rs_p_21.6 ((1 / 20) * 1000 * fs_21.6)
        let CO2_rs_p_21.6 ((1 / 20) * 1000 * fs_21.6)
        let H2O_rs_p_21.6 ((1 / 5) * 1000 * fs_21.6)

        let H2O_sum_21.6 (H2O_rs_p_21.6)
        let H+_sum_21.6 (H+_re_r_21.6 + H+_rs_r_21.6)
        let CO2_sum_21.6 (CO2_re_p_21.6 + CO2_rs_p_21.6)
        let HCO3_sum_21.6 (HCO3_rs_r_21.6)
        let CH4_sum_21.6 (CH4_re_p_21.6)
        let acetate_sum_21.6 (acetate_re_r_21.6 + acetate_rs_r_21.6)
        let NH4_sum_21.6 (NH4_rs_r_21.6)
        let biomass_sum_21.6 (biomass_rs_p_21.6)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_21.6 / acetate_sum_21.6 * biomass_sum_21.6)
        ask one-of protons [set protons_mass protons_mass - (food_21.6 / acetate_sum_21.6 * H+_sum_21.6)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.6 / acetate_sum_21.6 * NH4_sum_21.6)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.6 / acetate_sum_21.6 * HCO3_sum_21.6)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.6 / acetate_sum_21.6 * CH4_sum_21.6) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.6 / acetate_sum_21.6 * CO2_sum_21.6) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.6 / acetate_sum_21.6 * H2O_sum_21.6)]
        ask prey9 [set acetates_mass acetates_mass - (food_21.6 / num_prey9)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs_acetate 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.6b energy_fs_acetate
        let fe_21.6b energy_fe

        let acetate_re_r_21.6b (( 1 / 8) * 1000 * fe_21.6b)
        let H+_re_r_21.6b (( 1 / 8) * 1000 * fe_21.6b)
        let NH4_rs_r_21.6b ((1 / 20) * 1000 * fs_21.6b)
        let HCO3_rs_r_21.6b ((1 / 20) * 1000 * fs_21.6b)
        let H+_rs_r_21.6b ((1 / 8) * 1000 * fs_21.6b)
        let acetate_rs_r_21.6b ((1 / 8) * 1000 * fs_21.6b)

        let CH4_re_p_21.6b (( 1 / 8) * 1000 * fe_21.6b)
        let CO2_re_p_21.6b ((1 / 8) * 1000 * fe_21.6b)
        let biomass_rs_p_21.6b ((1 / 20) * 1000 * fs_21.6b)
        let CO2_rs_p_21.6b ((1 / 20) * 1000 * fs_21.6b)
        let H2O_rs_p_21.6b ((1 / 5) * 1000 * fs_21.6b)

        let H2O_sum_21.6b (H2O_rs_p_21.6b)
        let H+_sum_21.6b (H+_re_r_21.6b + H+_rs_r_21.6b)
        let CO2_sum_21.6b (CO2_re_p_21.6b + CO2_rs_p_21.6b)
        let HCO3_sum_21.6b (HCO3_rs_r_21.6b)
        let CH4_sum_21.6b (CH4_re_p_21.6b)
        let acetate_sum_21.6b (acetate_re_r_21.6b + acetate_rs_r_21.6b)
        let NH4_sum_21.6b (NH4_rs_r_21.6b)
        let biomass_sum_21.6b (biomass_rs_p_21.6b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * biomass_sum_21.6b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * H+_sum_21.6b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * NH4_sum_21.6b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * HCO3_sum_21.6b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * CH4_sum_21.6b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * CO2_sum_21.6b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey9) / acetate_sum_21.6b * H2O_sum_21.6b)]
        ask prey9 [die]
      ]
    ]
]

  if initial_concentration_acetates < 0.3 and temp > 293.15 and time > 1
  [
    let target4 hydrogens in-radius 50
    if target4 != nobody
    [
      let prey4 up-to-n-of 25 target4
      let num_prey4 count prey4
      ifelse (sum [hydrogens_mass] of prey4) > uptake_HM22
      [
        let food_22 min (list uptake_HM22 [hydrogens_mass] of prey4)
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22 energy_fs
        let fe_22 energy_fe

        let CO2_re_r_22 ( (1 / 8) * 1000 * fe_22)
        let H2_re_r_22 ((1 / 2) * 1000 * fe_22)
        let CO2_rs_r_22 ((1 / 5) * 1000 * fs_22)
        let NH4_rs_r_22 ((1 / 20) * 1000 * fs_22)
        let HCO3_rs_r_22 ((1 / 20) * 1000 * fs_22)
        let H2_rs_r_22 ((1 / 2) * 1000 * fs_22)

        let CH4_re_p_22 (( 1 / 8) * 1000 * fe_22)
        let H2O_re_p_22 ((1 / 4) * 1000 * fe_22)
        let biomass_rs_p_22 ((1 / 20) * 1000 * fs_22)
        let H2O_rs_p_22 ((9 / 20) * 1000 * fs_22)

        let H2O_sum_22 (H2O_re_p_22 + H2O_rs_p_22)
        let H2_sum_22 (H2_re_r_22 + H2_rs_r_22)
        let CO2_sum_22 (CO2_re_r_22 + CO2_rs_r_22)
        let HCO3_sum_22 (HCO3_rs_r_22)
        let CH4_sum_22 (CH4_re_p_22)
        let NH4_sum_22 (NH4_rs_r_22)
        let biomass_sum_22 (biomass_rs_p_22)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_22 / H2_sum_22 * biomass_sum_22)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22 / H2_sum_22 * CO2_sum_22)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22 / H2_sum_22 * NH4_sum_22)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22 / H2_sum_22 * HCO3_sum_22)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22 / H2_sum_22 * CH4_sum_22) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22 / H2_sum_22 * H2O_sum_22)]
        ask prey4 [set hydrogens_mass hydrogens_mass - (food_22 / num_prey4)]
      ]
      [
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22b energy_fs
        let fe_22b energy_fe

        let CO2_re_r_22b (( 1 / 8) * 1000 * fe_22b)
        let H2_re_r_22b ((1 / 2) * 1000 * fe_22b)
        let CO2_rs_r_22b ((1 / 5) * 1000 * fs_22b)
        let NH4_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let HCO3_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let H2_rs_r_22b ((1 / 2) * 1000 * fs_22b)

        let CH4_re_p_22b ( (1 / 8) * 1000 * fe_22b)
        let H2O_re_p_22b ((1 / 4) * 1000 * fe_22b)
        let biomass_rs_p_22b ((1 / 20) * 1000 * fs_22b)
        let H2O_rs_p_22b ((9 / 20) * 1000 * fs_22b)

        let H2O_sum_22b (H2O_re_p_22b + H2O_rs_p_22b)
        let H2_sum_22b (H2_re_r_22b + H2_rs_r_22b)
        let CO2_sum_22b (CO2_re_r_22b + CO2_rs_r_22b)
        let HCO3_sum_22b (HCO3_rs_r_22b)
        let CH4_sum_22b (CH4_re_p_22b)
        let NH4_sum_22b (NH4_rs_r_22b)
        let biomass_sum_22b (biomass_rs_p_22b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_22b * biomass_sum_22b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_22b * CO2_sum_22b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_22b * NH4_sum_22b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey4) / H2_sum_22b * HCO3_sum_22b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey4) / H2_sum_22b * CH4_sum_22b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey4) / H2_sum_22b * H2O_sum_22b)]
        ask prey4 [die]
      ]
    ]
  ]
if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and temp > 293.15 and time > 1
  [
    let target5 hydrogens in-radius 50
    if target5 != nobody
    [
      let prey5 up-to-n-of 2 target5
      let num_prey5 count prey5
      ifelse (sum [hydrogens_mass] of prey5) > uptake_HM22
      [
        let food_22.2 min (list uptake_HM22 [hydrogens_mass] of prey5)
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22.2 energy_fs
        let fe_22.2 energy_fe

        let CO2_re_r_22.2 ( (1 / 8) * 1000 * fe_22.2)
        let H2_re_r_22.2 ((1 / 2) * 1000 * fe_22.2)
        let CO2_rs_r_22.2 ((1 / 5) * 1000 * fs_22.2)
        let NH4_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let HCO3_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2_rs_r_22.2 ((1 / 2) * 1000 * fs_22.2)

        let CH4_re_p_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H2O_re_p_22.2 ((1 / 4) * 1000 * fe_22.2)
        let biomass_rs_p_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2O_rs_p_22.2 ((9 / 20) * 1000 * fs_22.2)

        let H2O_sum_22.2 (H2O_re_p_22.2 + H2O_rs_p_22.2)
        let H2_sum_22.2 (H2_re_r_22.2 + H2_rs_r_22.2)
        let CO2_sum_22.2 (CO2_re_r_22.2 + CO2_rs_r_22.2)
        let HCO3_sum_22.2 (HCO3_rs_r_22.2)
        let CH4_sum_22.2 (CH4_re_p_22.2)
        let NH4_sum_22.2 (NH4_rs_r_22.2)
        let biomass_sum_22.2 (biomass_rs_p_22.2)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_22.2 / H2_sum_22.2 * biomass_sum_22.2)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.2 / H2_sum_22.2 * CO2_sum_22.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.2 / H2_sum_22.2 * NH4_sum_22.2)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.2 / H2_sum_22.2 * HCO3_sum_22.2)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.2 / H2_sum_22.2 * CH4_sum_22.2) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.2 / H2_sum_22.2 * H2O_sum_22.2)]
        ask prey5 [set hydrogens_mass hydrogens_mass - (food_22.2 / num_prey5)]
      ]
      [
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22.2b energy_fs
        let fe_22.2b energy_fe

        let CO2_re_r_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H2_re_r_22.2b ((1 / 2) * 1000 * fe_22.2b)
        let CO2_rs_r_22.2b ((1 / 5) * 1000 * fs_22.2b)
        let NH4_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let HCO3_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2_rs_r_22.2b ((1 / 2) * 1000 * fs_22.2b)

        let CH4_re_p_22.2b ( (1 / 8) * 1000 * fe_22.2b)
        let H2O_re_p_22.2b ((1 / 4) * 1000 * fe_22.2b)
        let biomass_rs_p_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2O_rs_p_22.2b ((9 / 20) * 1000 * fs_22.2b)

        let H2O_sum_22.2b (H2O_re_p_22.2b + H2O_rs_p_22.2b)
        let H2_sum_22.2b (H2_re_r_22.2b + H2_rs_r_22.2b)
        let CO2_sum_22.2b (CO2_re_r_22.2b + CO2_rs_r_22.2b)
        let HCO3_sum_22.2b (HCO3_rs_r_22.2b)
        let CH4_sum_22.2b (CH4_re_p_22.2b)
        let NH4_sum_22.2b (NH4_rs_r_22.2b)
        let biomass_sum_22.2b (biomass_rs_p_22.2b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * biomass_sum_22.2b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * CO2_sum_22.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * NH4_sum_22.2b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * HCO3_sum_22.2b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * CH4_sum_22.2b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey5) / H2_sum_22.2b * H2O_sum_22.2b)]
        ask prey5 [die]
      ]
    ]
  ]
   if initial_concentration_acetates >= 0.5 and initial_concentration_acetates < 1 and temp > 293.15 and time > 1
  [
    let target6 hydrogens in-radius 50
    if target6 != nobody
    [
      let prey6 up-to-n-of 30 target6
      let num_prey6 count prey6
      ifelse (sum [hydrogens_mass] of prey6) > uptake_HM22
      [
        let food_22.3 min (list uptake_HM22 [hydrogens_mass] of prey6)
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22.3 energy_fs
        let fe_22.3 energy_fe

        let CO2_re_r_22.3 ( (1 / 8) * 1000 * fe_22.3)
        let H2_re_r_22.3 ((1 / 2) * 1000 * fe_22.3)
        let CO2_rs_r_22.3 ((1 / 5) * 1000 * fs_22.3)
        let NH4_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let HCO3_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2_rs_r_22.3 ((1 / 2) * 1000 * fs_22.3)

        let CH4_re_p_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H2O_re_p_22.3 ((1 / 4) * 1000 * fe_22.3)
        let biomass_rs_p_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2O_rs_p_22.3 ((9 / 20) * 1000 * fs_22.3)

        let H2O_sum_22.3 (H2O_re_p_22.3 + H2O_rs_p_22.3)
        let H2_sum_22.3 (H2_re_r_22.3 + H2_rs_r_22.3)
        let CO2_sum_22.3 (CO2_re_r_22.3 + CO2_rs_r_22.3)
        let HCO3_sum_22.3 (HCO3_rs_r_22.3)
        let CH4_sum_22.3 (CH4_re_p_22.3)
        let NH4_sum_22.3 (NH4_rs_r_22.3)
        let biomass_sum_22.3 (biomass_rs_p_22.3)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + (food_22.3 / H2_sum_22.3 * biomass_sum_22.3)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.3 / H2_sum_22.3 * CO2_sum_22.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.3 / H2_sum_22.3 * NH4_sum_22.3)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.3 / H2_sum_22.3 * HCO3_sum_22.3)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.3 / H2_sum_22.3 * CH4_sum_22.3) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.3 / H2_sum_22.3 * H2O_sum_22.3)]
        ask prey6 [set hydrogens_mass hydrogens_mass - (food_22.3 / num_prey6)]
      ]
      [
        set Gr_2 (-15.3845 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (1 / 4))) / ((LCO2 ^ (1 / 8)) * (LH2 ^ (1 / 2)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr_2)))
        set energy_fe (1 - energy_fs)
        let fs_22.3b energy_fs
        let fe_22.3b energy_fe

        let CO2_re_r_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H2_re_r_22.3b ((1 / 2) * 1000 * fe_22.3b)
        let CO2_rs_r_22.3b ((1 / 5) * 1000 * fs_22.3b)
        let NH4_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let HCO3_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2_rs_r_22.3b ((1 / 2) * 1000 * fs_22.3b)

        let CH4_re_p_22.3b ( (1 / 8) * 1000 * fe_22.3b)
        let H2O_re_p_22.3b ((1 / 4) * 1000 * fe_22.3b)
        let biomass_rs_p_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2O_rs_p_22.3b ((9 / 20) * 1000 * fs_22.3b)

        let H2O_sum_22.3b (H2O_re_p_22.3b + H2O_rs_p_22.3b)
        let H2_sum_22.3b (H2_re_r_22.3b + H2_rs_r_22.3b)
        let CO2_sum_22.3b (CO2_re_r_22.3b + CO2_rs_r_22.3b)
        let HCO3_sum_22.3b (HCO3_rs_r_22.3b)
        let CH4_sum_22.3b (CH4_re_p_22.3b)
        let NH4_sum_22.3b (NH4_rs_r_22.3b)
        let biomass_sum_22.3b (biomass_rs_p_22.3b)

        set M.sarcinales_AM21/HM22_mass M.sarcinales_AM21/HM22_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * biomass_sum_22.3b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * CO2_sum_22.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * NH4_sum_22.3b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * HCO3_sum_22.3b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * CH4_sum_22.3b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey6) / H2_sum_22.3b * H2O_sum_22.3b)]
        ask prey6 [die]
      ]
    ]
  ]

end

to reproduce_AM21/HM22
  if M.sarcinales_AM21/HM22_mass > 1
  [
  set M.sarcinales_AM21/HM22_mass (M.sarcinales_AM21/HM22_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_AM21 0.6074
  set uptake_HM22 0.2897
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_AM21/HM22
  set M.sarcinales_AM21/HM22_mass (M.sarcinales_AM21/HM22_mass - M.sarcinales_AM21/HM22_mass * (0.004 / 24)) ;; Represents decay rate per hour based on Leng et al., 2018
end

;;;;; METHANOSAETA ;;;

;;; Methanosaeta concilii AM21;;; Eq 21

to AM21_eat_acetate;; Methanosaeta concilli procedure ;; maximum uptake rate is up to 0.6074 mmol/mmol h based on Leng et al., 2018
if initial_concentration_acetates < 0.3 and temp > 293.15 and temp < 317 and time > 1
  [
    let target acetates in-radius 50
    if target != nobody
    [
      let prey up-to-n-of 2 target
      let num_prey count prey
      ifelse (sum [acetates_mass] of prey) > uptake_AM21
      [
        let food_21 min (list uptake_AM21 [acetates_mass] of prey)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21 energy_fs
        let fe_21 energy_fe

        let acetate_re_r ( (1 / 8) * 1000 * fe_21)
        let H+_re_r (( 1 / 8) * 1000 * fe_21)
        let NH4_rs_r ((1 / 20) * 1000 * fs_21)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_21)
        let H+_rs_r ((1 / 8) * 1000 * fs_21)
        let acetate_rs_r ((1 / 8) * 1000 * fs_21)

        let CH4_re_p (( 1 / 8) * 1000 * fe_21)
        let CO2_re_p ((1 / 8) * 1000 * fe_21)
        let biomass_rs_p ((1 / 20) * 1000 * fs_21)
        let CO2_rs_p ((1 / 20) * 1000 * fs_21)
        let H2O_rs_p ((1 / 5) * 1000 * fs_21)

        let H2O_sum (H2O_rs_p)
        let H+_sum (H+_re_r + H+_rs_r)
        let CO2_sum (CO2_re_p + CO2_rs_p)
        let HCO3_sum (HCO3_rs_r)
        let CH4_sum (CH4_re_p)
        let acetate_sum (acetate_re_r + acetate_rs_r)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set M.concilii_AM21_mass M.concilii_AM21_mass + (food_21 / acetate_sum * biomass_sum)
        ask one-of protons [set protons_mass protons_mass - (food_21 / acetate_sum * H+_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21 / acetate_sum * NH4_sum)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21 / acetate_sum * HCO3_sum)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21 / acetate_sum * CH4_sum) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21 / acetate_sum * CO2_sum) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21 / acetate_sum * H2O_sum)]
        ask prey [set acetates_mass acetates_mass - (food_21 / num_prey)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21b energy_fs
        let fe_21b energy_fe

        let acetate_re_r_21b (( 1 / 8) * 1000 * fe_21b)
        let H+_re_r_21b (( 1 / 8) * 1000 * fe_21b)
        let NH4_rs_r_21b ((1 / 20) * 1000 * fs_21b)
        let HCO3_rs_r_21b ((1 / 20) * 1000 * fs_21b)
        let H+_rs_r_21b ((1 / 8) * 1000 * fs_21b)
        let acetate_rs_r_21b ((1 / 8) * 1000 * fs_21b)

        let CH4_re_p_21b (( 1 / 8) * 1000 * fe_21b)
        let CO2_re_p_21b ((1 / 8) * 1000 * fe_21b)
        let biomass_rs_p_21b ((1 / 20) * 1000 * fs_21b)
        let CO2_rs_p_21b ((1 / 20) * 1000 * fs_21b)
        let H2O_rs_p_21b ((1 / 5) * 1000 * fs_21b)

        let H2O_sum_21b (H2O_rs_p_21b)
        let H+_sum_21b (H+_re_r_21b + H+_rs_r_21b)
        let CO2_sum_21b (CO2_re_p_21b + CO2_rs_p_21b)
        let HCO3_sum_21b (HCO3_rs_r_21b)
        let CH4_sum_21b (CH4_re_p_21b)
        let acetate_sum_21b (acetate_re_r_21b + acetate_rs_r_21b)
        let NH4_sum_21b (NH4_rs_r_21b)
        let biomass_sum_21b (biomass_rs_p_21b)

        set M.concilii_AM21_mass M.concilii_AM21_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * biomass_sum_21b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * H+_sum_21b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * NH4_sum_21b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey) / acetate_sum_21b * HCO3_sum_21b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * CH4_sum_21b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey) / acetate_sum_21b * CO2_sum_21b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey) / acetate_sum_21b * H2O_sum_21b)]
        ask prey [die]
      ]
    ]
]
 if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.6 and temp > 293.15 and temp < 317 and time > 1
  [
    let target2 acetates in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 5 target2
      let num_prey2 count prey2
      ifelse (sum [acetates_mass] of prey2) > uptake_AM21
      [
        let food_21.2 min (list uptake_AM21 [acetates_mass] of prey2)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.2 energy_fs
        let fe_21.2 energy_fe

        let acetate_re_r_21.2 ( (1 / 8) * 1000 * fe_21.2)
        let H+_re_r_21.2 (( 1 / 8) * 1000 * fe_21.2)
        let NH4_rs_r_21.2 ((1 / 20) * 1000 * fs_21.2)
        let HCO3_rs_r_21.2 ((1 / 20) * 1000 * fs_21.2)
        let H+_rs_r_21.2 ((1 / 8) * 1000 * fs_21.2)
        let acetate_rs_r_21.2 ((1 / 8) * 1000 * fs_21.2)

        let CH4_re_p_21.2 (( 1 / 8) * 1000 * fe_21.2)
        let CO2_re_p_21.2 ((1 / 8) * 1000 * fe_21.2)
        let biomass_rs_p_21.2 ((1 / 20) * 1000 * fs_21.2)
        let CO2_rs_p_21.2 ((1 / 20) * 1000 * fs_21.2)
        let H2O_rs_p_21.2 ((1 / 5) * 1000 * fs_21.2)

        let H2O_sum_21.2 (H2O_rs_p_21.2)
        let H+_sum_21.2 (H+_re_r_21.2 + H+_rs_r_21.2)
        let CO2_sum_21.2 (CO2_re_p_21.2 + CO2_rs_p_21.2)
        let HCO3_sum_21.2 (HCO3_rs_r_21.2)
        let CH4_sum_21.2 (CH4_re_p_21.2)
        let acetate_sum_21.2 (acetate_re_r_21.2 + acetate_rs_r_21.2)
        let NH4_sum_21.2 (NH4_rs_r_21.2)
        let biomass_sum_21.2 (biomass_rs_p_21.2)

        set M.concilii_AM21_mass M.concilii_AM21_mass + (food_21.2 / acetate_sum_21.2 * biomass_sum_21.2)
        ask one-of protons [set protons_mass protons_mass - (food_21.2 / acetate_sum_21.2 * H+_sum_21.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.2 / acetate_sum_21.2 * NH4_sum_21.2)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.2 / acetate_sum_21.2 * HCO3_sum_21.2)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.2 / acetate_sum_21.2 * CH4_sum_21.2) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.2 / acetate_sum_21.2 * CO2_sum_21.2) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.2 / acetate_sum_21.2 * H2O_sum_21.2)]
        ask prey2 [set acetates_mass acetates_mass - (food_21.2 / num_prey2)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.2b energy_fs
        let fe_21.2b energy_fe

        let acetate_re_r_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let H+_re_r_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let NH4_rs_r_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let HCO3_rs_r_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let H+_rs_r_21.2b ((1 / 8) * 1000 * fs_21.2b)
        let acetate_rs_r_21.2b ((1 / 8) * 1000 * fs_21.2b)

        let CH4_re_p_21.2b (( 1 / 8) * 1000 * fe_21.2b)
        let CO2_re_p_21.2b ((1 / 8) * 1000 * fe_21.2b)
        let biomass_rs_p_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let CO2_rs_p_21.2b ((1 / 20) * 1000 * fs_21.2b)
        let H2O_rs_p_21.2b ((1 / 5) * 1000 * fs_21.2b)

        let H2O_sum_21.2b (H2O_rs_p_21.2b)
        let H+_sum_21.2b (H+_re_r_21.2b + H+_rs_r_21.2b)
        let CO2_sum_21.2b (CO2_re_p_21.2b + CO2_rs_p_21.2b)
        let HCO3_sum_21.2b (HCO3_rs_r_21.2b)
        let CH4_sum_21.2b (CH4_re_p_21.2b)
        let acetate_sum_21.2b (acetate_re_r_21.2b + acetate_rs_r_21.2b)
        let NH4_sum_21.2b (NH4_rs_r_21.2b)
        let biomass_sum_21.2b (biomass_rs_p_21.2b)

        set M.concilii_AM21_mass M.concilii_AM21_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * biomass_sum_21.2b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * H+_sum_21.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * NH4_sum_21.2b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * HCO3_sum_21.2b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * CH4_sum_21.2b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * CO2_sum_21.2b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey2) / acetate_sum_21.2b * H2O_sum_21.2b)]
        ask prey2 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 0.6 and initial_concentration_acetates < 0.8 and temp > 293.15 and temp < 317 and time > 1
  [
    let target3 acetates in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 4 target3
      let num_prey3 count prey3
      ifelse (sum [acetates_mass] of prey3) > uptake_AM21
      [
        let food_21.3 min (list uptake_AM21 [acetates_mass] of prey3)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.3 energy_fs
        let fe_21.3 energy_fe

        let acetate_re_r_21.3 ( (1 / 8) * 1000 * fe_21.3)
        let H+_re_r_21.3 (( 1 / 8) * 1000 * fe_21.3)
        let NH4_rs_r_21.3 ((1 / 20) * 1000 * fs_21.3)
        let HCO3_rs_r_21.3 ((1 / 20) * 1000 * fs_21.3)
        let H+_rs_r_21.3 ((1 / 8) * 1000 * fs_21.3)
        let acetate_rs_r_21.3 ((1 / 8) * 1000 * fs_21.3)

        let CH4_re_p_21.3 (( 1 / 8) * 1000 * fe_21.3)
        let CO2_re_p_21.3 ((1 / 8) * 1000 * fe_21.3)
        let biomass_rs_p_21.3 ((1 / 20) * 1000 * fs_21.3)
        let CO2_rs_p_21.3 ((1 / 20) * 1000 * fs_21.3)
        let H2O_rs_p_21.3 ((1 / 5) * 1000 * fs_21.3)

        let H2O_sum_21.3 (H2O_rs_p_21.3)
        let H+_sum_21.3 (H+_re_r_21.3 + H+_rs_r_21.3)
        let CO2_sum_21.3 (CO2_re_p_21.3 + CO2_rs_p_21.3)
        let HCO3_sum_21.3 (HCO3_rs_r_21.3)
        let CH4_sum_21.3 (CH4_re_p_21.3)
        let acetate_sum_21.3 (acetate_re_r_21.3 + acetate_rs_r_21.3)
        let NH4_sum_21.3 (NH4_rs_r_21.3)
        let biomass_sum_21.3 (biomass_rs_p_21.3)

        set M.concilii_AM21_mass M.concilii_AM21_mass + (food_21.3 / acetate_sum_21.3 * biomass_sum_21.3)
        ask one-of protons [set protons_mass protons_mass - (food_21.3 / acetate_sum_21.3 * H+_sum_21.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.3 / acetate_sum_21.3 * NH4_sum_21.3)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.3 / acetate_sum_21.3 * HCO3_sum_21.3)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.3 / acetate_sum_21.3 * CH4_sum_21.3) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.3 / acetate_sum_21.3 * CO2_sum_21.3) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.3 / acetate_sum_21.3 * H2O_sum_21.3)]
        ask prey3 [set acetates_mass acetates_mass - (food_21.3 / num_prey3)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.3b energy_fs
        let fe_21.3b energy_fe

        let acetate_re_r_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let H+_re_r_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let NH4_rs_r_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let HCO3_rs_r_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let H+_rs_r_21.3b ((1 / 8) * 1000 * fs_21.3b)
        let acetate_rs_r_21.3b ((1 / 8) * 1000 * fs_21.3b)

        let CH4_re_p_21.3b (( 1 / 8) * 1000 * fe_21.3b)
        let CO2_re_p_21.3b ((1 / 8) * 1000 * fe_21.3b)
        let biomass_rs_p_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let CO2_rs_p_21.3b ((1 / 20) * 1000 * fs_21.3b)
        let H2O_rs_p_21.3b ((1 / 5) * 1000 * fs_21.3b)

        let H2O_sum_21.3b (H2O_rs_p_21.3b)
        let H+_sum_21.3b (H+_re_r_21.3b + H+_rs_r_21.3b)
        let CO2_sum_21.3b (CO2_re_p_21.3b + CO2_rs_p_21.3b)
        let HCO3_sum_21.3b (HCO3_rs_r_21.3b)
        let CH4_sum_21.3b (CH4_re_p_21.3b)
        let acetate_sum_21.3b (acetate_re_r_21.3b + acetate_rs_r_21.3b)
        let NH4_sum_21.3b (NH4_rs_r_21.3b)
        let biomass_sum_21.3b (biomass_rs_p_21.3b)

        set M.concilii_AM21_mass M.concilii_AM21_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * biomass_sum_21.3b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * H+_sum_21.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * NH4_sum_21.3b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * HCO3_sum_21.3b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * CH4_sum_21.3b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * CO2_sum_21.3b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey3) / acetate_sum_21.3b * H2O_sum_21.3b)]
        ask prey3 [die]
      ]
    ]
]
  if initial_concentration_acetates >= 0.8 and initial_concentration_acetates < 1 and temp > 293.15 and temp < 317 and time > 1
  [
    let target4 acetates in-radius 50
    if target4 != nobody
    [
      let prey4 up-to-n-of 3 target4
      let num_prey4 count prey4
      ifelse (sum [acetates_mass] of prey4) > uptake_AM21
      [
        let food_21.4 min (list uptake_AM21 [acetates_mass] of prey4)
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.4 energy_fs
        let fe_21.4 energy_fe

        let acetate_re_r_21.4 ( (1 / 8) * 1000 * fe_21.4)
        let H+_re_r_21.4 (( 1 / 8) * 1000 * fe_21.4)
        let NH4_rs_r_21.4 ((1 / 20) * 1000 * fs_21.4)
        let HCO3_rs_r_21.4 ((1 / 20) * 1000 * fs_21.4)
        let H+_rs_r_21.4 ((1 / 8) * 1000 * fs_21.4)
        let acetate_rs_r_21.4 ((1 / 8) * 1000 * fs_21.4)

        let CH4_re_p_21.4 (( 1 / 8) * 1000 * fe_21.4)
        let CO2_re_p_21.4 ((1 / 8) * 1000 * fe_21.4)
        let biomass_rs_p_21.4 ((1 / 20) * 1000 * fs_21.4)
        let CO2_rs_p_21.4 ((1 / 20) * 1000 * fs_21.4)
        let H2O_rs_p_21.4 ((1 / 5) * 1000 * fs_21.4)

        let H2O_sum_21.4 (H2O_rs_p_21.4)
        let H+_sum_21.4 (H+_re_r_21.4 + H+_rs_r_21.4)
        let CO2_sum_21.4 (CO2_re_p_21.4 + CO2_rs_p_21.4)
        let HCO3_sum_21.4 (HCO3_rs_r_21.4)
        let CH4_sum_21.4 (CH4_re_p_21.4)
        let acetate_sum_21.4 (acetate_re_r_21.4 + acetate_rs_r_21.4)
        let NH4_sum_21.4 (NH4_rs_r_21.4)
        let biomass_sum_21.4 (biomass_rs_p_21.4)

        set M.concilii_AM21_mass M.concilii_AM21_mass + (food_21.4 / acetate_sum_21.4 * biomass_sum_21.4)
        ask one-of protons [set protons_mass protons_mass - (food_21.4 / acetate_sum_21.4 * H+_sum_21.4)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_21.4 / acetate_sum_21.4 * NH4_sum_21.4)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_21.4 / acetate_sum_21.4 * HCO3_sum_21.4)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_21.4 / acetate_sum_21.4 * CH4_sum_21.4) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + (food_21.4 / acetate_sum_21.4 * CO2_sum_21.4) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + (food_21.4 / acetate_sum_21.4 * H2O_sum_21.4)]
        ask prey4 [set acetates_mass acetates_mass - (food_21.4 / num_prey4)]
      ]
      [
        set Gr (-1.4350 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (LCO2 ^ (1 / 8))) / ((Initial_concentration_acetates ^ (1 / 8)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((9.1695 / 1000) / 0.6 ^ 1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_21.4b energy_fs
        let fe_21.4b energy_fe

        let acetate_re_r_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let H+_re_r_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let NH4_rs_r_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let HCO3_rs_r_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let H+_rs_r_21.4b ((1 / 8) * 1000 * fs_21.4b)
        let acetate_rs_r_21.4b ((1 / 8) * 1000 * fs_21.4b)

        let CH4_re_p_21.4b (( 1 / 8) * 1000 * fe_21.4b)
        let CO2_re_p_21.4b ((1 / 8) * 1000 * fe_21.4b)
        let biomass_rs_p_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let CO2_rs_p_21.4b ((1 / 20) * 1000 * fs_21.4b)
        let H2O_rs_p_21.4b ((1 / 5) * 1000 * fs_21.4b)

        let H2O_sum_21.4b (H2O_rs_p_21.4b)
        let H+_sum_21.4b (H+_re_r_21.4b + H+_rs_r_21.4b)
        let CO2_sum_21.4b (CO2_re_p_21.4b + CO2_rs_p_21.4b)
        let HCO3_sum_21.4b (HCO3_rs_r_21.4b)
        let CH4_sum_21.4b (CH4_re_p_21.4b)
        let acetate_sum_21.4b (acetate_re_r_21.4b + acetate_rs_r_21.4b)
        let NH4_sum_21.4b (NH4_rs_r_21.4b)
        let biomass_sum_21.4b (biomass_rs_p_21.4b)

        set M.concilii_AM21_mass M.concilii_AM21_mass + ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * biomass_sum_21.4b)
        ask one-of protons [set protons_mass protons_mass - ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * H+_sum_21.4b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * NH4_sum_21.4b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * HCO3_sum_21.4b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * CH4_sum_21.4b) rt random 360 fd 1]
        hatch-CO2s 1 [set color orange set size 0.5 set CO2s_mass CO2s_mass + ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * CO2_sum_21.4b) right random 360 fd 3]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [acetates_mass] of prey4) / acetate_sum_21.4b * H2O_sum_21.4b)]
        ask prey4 [die]
      ]
    ]
]
end

to reproduce_AM21
  if M.concilii_AM21_mass > 1
  [
  set M.concilii_AM21_mass (M.concilii_AM21_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_AM21 0.6074
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_AM21
  set M.concilii_AM21_mass (M.concilii_AM21_mass - M.concilii_AM21_mass * ((0.004) / 24)) ;; Represents decay rate per hour based on Leng et al., 2018
end





;;; METHANOMICROBIALES ;;;;

;;; METHANOMICROBIALES HM22;;  Eq. 22 M. bourgensis and M. Hungatei

to Mm_HM22_eat_hydrogen;; Methanoculleus bourgensis and M. Hungatei procedure ;; maximum uptake rate is 0.0012 mmol/mmol h based on Vavilin et al., 2000
if initial_concentration_acetates < 0.3 and temp > 293.15 and time > 1
[
    let target hydrogens in-radius 50
    if target != nobody
    [
      let prey up-to-n-of 25 target
      let num_prey count prey
      ifelse (sum [hydrogens_mass] of prey) > uptake_HM22
      [
        let food_22 min (list uptake_HM22 [hydrogens_mass] of prey)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22 energy_fs
        let fe_22 energy_fe

        let HCO3_re_r (( 1 / 8) * 1000 * fe_22)
        let H+_re_r (( 1 / 8) * 1000 * fe_22)
        let H2_re_r ((1 / 2) * 1000 * fe_22)
        let CO2_rs_r ((1 / 5) * 1000 * fs_22)
        let NH4_rs_r ((1 / 20) * 1000 * fs_22)
        let HCO3_rs_r ((1 / 20) * 1000 * fs_22)
        let H2_rs_r ((1 / 2) * 1000 * fs_22)

        let CH4_re_p (( 1 / 8) * 1000 * fe_22)
        let H2O_re_p ((3 / 8) * 1000 * fe_22)
        let biomass_rs_p ((1 / 20) * 1000 * fs_22)
        let H2O_rs_p ((9 / 20) * 1000 * fs_22)

        let H2O_sum (H2O_re_p + H2O_rs_p)
        let H2_sum (H2_re_r + H2_rs_r)
        let H+_sum (H+_re_r)
        let CO2_sum (CO2_rs_r)
        let HCO3_sum (HCO3_re_r + HCO3_rs_r)
        let CH4_sum (CH4_re_p)
        let NH4_sum (NH4_rs_r)
        let biomass_sum (biomass_rs_p)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + (food_22 / H2_sum * biomass_sum)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22 / H2_sum * CO2_sum)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22 / H2_sum * NH4_sum)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22 / H2_sum * HCO3_sum)]
        ask one-of protons [set protons_mass protons_mass - (food_22 / H2_sum * H+_sum)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22 / H2_sum * CH4_sum) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22 / H2_sum * H2O_sum)]
        ask prey [set hydrogens_mass hydrogens_mass - (food_22 / num_prey)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22b energy_fs
        let fe_22b energy_fe

        let HCO3_re_r_22b (( 1 / 8) * 1000 * fe_22b)
        let H+_re_r_22b (( 1 / 8) * 1000 * fe_22b)
        let H2_re_r_22b ((1 / 2) * 1000 * fe_22b)
        let CO2_rs_r_22b ((1 / 5) * 1000 * fs_22b)
        let NH4_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let HCO3_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let H2_rs_r_22b ((1 / 2) * 1000 * fs_22b)

        let CH4_re_p_22b (( 1 / 8) * 1000 * fe_22b)
        let H2O_re_p_22b ((3 / 8) * 1000 * fe_22b)
        let biomass_rs_p_22b ((1 / 20) * 1000 * fs_22b)
        let H2O_rs_p_22b ((9 / 20) * 1000 * fs_22b)

        let H2O_sum_22b (H2O_re_p_22b + H2O_rs_p_22b)
        let H2_sum_22b (H2_re_r_22b + H2_rs_r_22b)
        let H+_sum_22b (H+_re_r_22b)
        let CO2_sum_22b (CO2_rs_r_22b)
        let HCO3_sum_22b (HCO3_re_r_22b + HCO3_rs_r_22b)
        let CH4_sum_22b (CH4_re_p_22b)
        let NH4_sum_22b (NH4_rs_r_22b)
        let biomass_sum_22b (biomass_rs_p_22b)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + ((sum [hydrogens_mass] of prey) / H2_sum_22b * biomass_sum_22b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * CO2_sum_22b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * NH4_sum_22b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * HCO3_sum_22b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * H+_sum_22b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey) / H2_sum_22b * CH4_sum_22b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey) / H2_sum_22b * H2O_sum_22b)]
        ask prey [die]
      ]
    ]
]
  if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and temp > 293.15 and time > 1
[
    let target2 hydrogens in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 2 target2
      let num_prey2 count prey2
      ifelse (sum [hydrogens_mass] of prey2) > uptake_HM22
      [
        let food_22.2 min (list uptake_HM22 [hydrogens_mass] of prey2)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.2 energy_fs
        let fe_22.2 energy_fe

        let HCO3_re_r_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H+_re_r_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H2_re_r_22.2 ((1 / 2) * 1000 * fe_22.2)
        let CO2_rs_r_22.2 ((1 / 5) * 1000 * fs_22.2)
        let NH4_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let HCO3_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2_rs_r_22.2 ((1 / 2) * 1000 * fs_22.2)

        let CH4_re_p_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H2O_re_p_22.2 ((3 / 8) * 1000 * fe_22.2)
        let biomass_rs_p_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2O_rs_p_22.2 ((9 / 20) * 1000 * fs_22.2)

        let H2O_sum_22.2 (H2O_re_p_22.2 + H2O_rs_p_22.2)
        let H2_sum_22.2 (H2_re_r_22.2 + H2_rs_r_22.2)
        let H+_sum_22.2 (H+_re_r_22.2)
        let CO2_sum_22.2 (CO2_rs_r_22.2)
        let HCO3_sum_22.2 (HCO3_re_r_22.2 + HCO3_rs_r_22.2)
        let CH4_sum_22.2 (CH4_re_p_22.2)
        let NH4_sum_22.2 (NH4_rs_r_22.2)
        let biomass_sum_22.2 (biomass_rs_p_22.2)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + (food_22.2 / H2_sum_22.2 * biomass_sum_22.2)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.2 / H2_sum_22.2 * CO2_sum_22.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.2 / H2_sum_22.2 * NH4_sum_22.2)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.2 / H2_sum_22.2 * HCO3_sum_22.2)]
        ask one-of protons [set protons_mass protons_mass - (food_22.2 / H2_sum_22.2 * H+_sum_22.2)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.2 / H2_sum_22.2 * CH4_sum_22.2) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.2 / H2_sum_22.2 * H2O_sum_22.2)]
        ask prey2 [set hydrogens_mass hydrogens_mass - (food_22.2 / num_prey2)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.2b energy_fs
        let fe_22.2b energy_fe

        let HCO3_re_r_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H+_re_r_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H2_re_r_22.2b ((1 / 2) * 1000 * fe_22.2b)
        let CO2_rs_r_22.2b ((1 / 5) * 1000 * fs_22.2b)
        let NH4_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let HCO3_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2_rs_r_22.2b ((1 / 2) * 1000 * fs_22.2b)

        let CH4_re_p_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H2O_re_p_22.2b ((3 / 8) * 1000 * fe_22.2b)
        let biomass_rs_p_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2O_rs_p_22.2b ((9 / 20) * 1000 * fs_22.2b)

        let H2O_sum_22.2b (H2O_re_p_22.2b + H2O_rs_p_22.2b)
        let H2_sum_22.2b (H2_re_r_22.2b + H2_rs_r_22.2b)
        let H+_sum_22.2b (H+_re_r_22.2b)
        let CO2_sum_22.2b(CO2_rs_r_22.2b)
        let HCO3_sum_22.2b (HCO3_re_r_22.2b + HCO3_rs_r_22.2b)
        let CH4_sum_22.2b (CH4_re_p_22.2b)
        let NH4_sum_22.2b (NH4_rs_r_22.2b)
        let biomass_sum_22.2b (biomass_rs_p_22.2b)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * biomass_sum_22.2b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * CO2_sum_22.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * NH4_sum_22.2b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * HCO3_sum_22.2b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * H+_sum_22.2b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * CH4_sum_22.2b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * H2O_sum_22.2b)]
        ask prey2 [die]
      ]
    ]
]
if initial_concentration_acetates >= 0.5 and temp > 293.15 and time > 1
[
    let target3 hydrogens in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 30 target3
      let num_prey3 count prey3
      ifelse (sum [hydrogens_mass] of prey3) > uptake_HM22
      [
        let food_22.3 min (list uptake_HM22 [hydrogens_mass] of prey3)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.3 energy_fs
        let fe_22.3 energy_fe

        let HCO3_re_r_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H+_re_r_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H2_re_r_22.3 ((1 / 2) * 1000 * fe_22.3)
        let CO2_rs_r_22.3 ((1 / 5) * 1000 * fs_22.3)
        let NH4_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let HCO3_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2_rs_r_22.3 ((1 / 2) * 1000 * fs_22.3)

        let CH4_re_p_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H2O_re_p_22.3 ((3 / 8) * 1000 * fe_22.3)
        let biomass_rs_p_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2O_rs_p_22.3 ((9 / 20) * 1000 * fs_22.3)

        let H2O_sum_22.3 (H2O_re_p_22.3 + H2O_rs_p_22.3)
        let H2_sum_22.3 (H2_re_r_22.3 + H2_rs_r_22.3)
        let H+_sum_22.3 (H+_re_r_22.3)
        let CO2_sum_22.3 (CO2_rs_r_22.3)
        let HCO3_sum_22.3 (HCO3_re_r_22.3 + HCO3_rs_r_22.3)
        let CH4_sum_22.3 (CH4_re_p_22.3)
        let NH4_sum_22.3 (NH4_rs_r_22.3)
        let biomass_sum_22.3 (biomass_rs_p_22.3)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + (food_22.3 / H2_sum_22.3 * biomass_sum_22.3)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.3 / H2_sum_22.3 * CO2_sum_22.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.3 / H2_sum_22.3 * NH4_sum_22.3)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.3 / H2_sum_22.3 * HCO3_sum_22.3)]
        ask one-of protons [set protons_mass protons_mass - (food_22.3 / H2_sum_22.3 * H+_sum_22.3)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.3 / H2_sum_22.3 * CH4_sum_22.3) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.3 / H2_sum_22.3 * H2O_sum_22.3)]
        ask prey3 [set hydrogens_mass hydrogens_mass - (food_22.3 / num_prey3)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.3b energy_fs
        let fe_22.3b energy_fe

        let HCO3_re_r_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H+_re_r_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H2_re_r_22.3b ((1 / 2) * 1000 * fe_22.3b)
        let CO2_rs_r_22.3b ((1 / 5) * 1000 * fs_22.3b)
        let NH4_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let HCO3_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2_rs_r_22.3b ((1 / 2) * 1000 * fs_22.3b)

        let CH4_re_p_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H2O_re_p_22.3b ((3 / 8) * 1000 * fe_22.3b)
        let biomass_rs_p_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2O_rs_p_22.3b ((9 / 20) * 1000 * fs_22.3b)

        let H2O_sum_22.3b (H2O_re_p_22.3b + H2O_rs_p_22.3b)
        let H2_sum_22.3b (H2_re_r_22.3b + H2_rs_r_22.3b)
        let H+_sum_22.3b (H+_re_r_22.3b)
        let CO2_sum_22.3b (CO2_rs_r_22.3b)
        let HCO3_sum_22.3b (HCO3_re_r_22.3b + HCO3_rs_r_22.3b)
        let CH4_sum_22.3b (CH4_re_p_22.3b)
        let NH4_sum_22.3b (NH4_rs_r_22.3b)
        let biomass_sum_22.3b (biomass_rs_p_22.3b)

        set  M.microbiales_HM22_mass  M.microbiales_HM22_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * biomass_sum_22.3b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * CO2_sum_22.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * NH4_sum_22.3b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * HCO3_sum_22.3b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * H+_sum_22.3b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * CH4_sum_22.3b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * H2O_sum_22.3b)]
        ask prey3 [die]
      ]
    ]
]

end

to reproduce_Mm_HM22
  if M.microbiales_HM22_mass > 1
  [
  set  M.microbiales_HM22_mass ( M.microbiales_HM22_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_HM22 0.2897
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_Mm_HM22
  set  M.microbiales_HM22_mass ( M.microbiales_HM22_mass -  M.microbiales_HM22_mass * (0.01 / 24)) ;; Represents decay rate per hour based on Vavilin et al., 2000
end


;;; METHANOBACTERIALES ;;;


;;;METHANOBACTERIALES HM22;;; Eq. 22

to Mb_HM22_eat_hydrogen;; Methanobacterium bryantii and M. formicicum procedure ;; maximum uptake rate is 0.0012 mmol/mmol h based on Vavilin et al., 2000
if initial_concentration_acetates < 0.3 and temp > 293.15 and time > 1
  [
    let target hydrogens in-radius 50
    if target != nobody
    [
      let prey up-to-n-of 25 target
      let num_prey count prey
      ifelse (sum [hydrogens_mass] of prey) > uptake_HM22
      [
        let food_22 min (list uptake_HM22 [hydrogens_mass] of prey)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22 energy_fs
        let fe_22 energy_fe

        let HCO3_re_r_22 (( 1 / 8) * 1000 * fe_22)
        let H+_re_r_22 ( (1 / 8) * 1000 * fe_22)
        let H2_re_r_22 ((1 / 2) * 1000 * fe_22)
        let CO2_rs_r_22 ((1 / 5) * 1000 * fs_22)
        let NH4_rs_r_22 ((1 / 20) * 1000 * fs_22)
        let HCO3_rs_r_22 ((1 / 20) * 1000 * fs_22)
        let H2_rs_r_22 ((1 / 2) * 1000 * fs_22)

        let CH4_re_p_22 (( 1 / 8) * 1000 * fe_22)
        let H2O_re_p_22 ((3 / 8) * 1000 * fe_22)
        let biomass_rs_p_22 ((1 / 20) * 1000 * fs_22)
        let H2O_rs_p_22 ((9 / 20) * 1000 * fs_22)

        let H2O_sum_22 (H2O_re_p_22 + H2O_rs_p_22)
        let H2_sum_22 (H2_re_r_22 + H2_rs_r_22)
        let H+_sum_22 (H+_re_r_22)
        let CO2_sum_22 (CO2_rs_r_22)
        let HCO3_sum_22 (HCO3_re_r_22 + HCO3_rs_r_22)
        let CH4_sum_22 (CH4_re_p_22)
        let NH4_sum_22 (NH4_rs_r_22)
        let biomass_sum_22 (biomass_rs_p_22)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + (food_22 / H2_sum_22 * biomass_sum_22)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22 / H2_sum_22 * CO2_sum_22)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22 / H2_sum_22 * NH4_sum_22)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22 / H2_sum_22 * HCO3_sum_22)]
        ask one-of protons [set protons_mass protons_mass - (food_22 / H2_sum_22 * H+_sum_22)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22 / H2_sum_22 * CH4_sum_22) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22 / H2_sum_22 * H2O_sum_22)]
        ask prey [set hydrogens_mass hydrogens_mass - (food_22 / num_prey)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22b energy_fs
        let fe_22b energy_fe

        let HCO3_re_r_22b (( 1 / 8) * 1000 * fe_22b)
        let H+_re_r_22b(( 1 / 8) * 1000 * fe_22b)
        let H2_re_r_22b ((1 / 2) * 1000 * fe_22b)
        let CO2_rs_r_22b ((1 / 5) * 1000 * fs_22b)
        let NH4_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let HCO3_rs_r_22b ((1 / 20) * 1000 * fs_22b)
        let H2_rs_r_22b ((1 / 2) * 1000 * fs_22b)

        let CH4_re_p_22b (( 1 / 8) * 1000 * fe_22b)
        let H2O_re_p_22b ((3 / 8) * 1000 * fe_22b)
        let biomass_rs_p_22b ((1 / 20) * 1000 * fs_22b)
        let H2O_rs_p_22b ((9 / 20) * 1000 * fs_22b)

        let H2O_sum_22b (H2O_re_p_22b + H2O_rs_p_22b)
        let H2_sum_22b (H2_re_r_22b + H2_rs_r_22b)
        let H+_sum_22b (H+_re_r_22b)
        let CO2_sum_22b (CO2_rs_r_22b)
        let HCO3_sum_22b (HCO3_re_r_22b + HCO3_rs_r_22b)
        let CH4_sum_22b (CH4_re_p_22b)
        let NH4_sum_22b (NH4_rs_r_22b)
        let biomass_sum_22b (biomass_rs_p_22b)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + ((sum [hydrogens_mass] of prey) / H2_sum_22b * biomass_sum_22b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * CO2_sum_22b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * NH4_sum_22b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * HCO3_sum_22b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey) / H2_sum_22b * H+_sum_22b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey) / H2_sum_22b * CH4_sum_22b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey) / H2_sum_22b * H2O_sum_22b)]
        ask prey [die]
      ]
    ]
  ]
if initial_concentration_acetates >= 0.3 and initial_concentration_acetates < 0.5 and temp > 293.15 and time > 1
  [
    let target2 hydrogens in-radius 50
    if target2 != nobody
    [
      let prey2 up-to-n-of 2 target2
      let num_prey2 count prey2
      ifelse (sum [hydrogens_mass] of prey2) > uptake_HM22
      [
        let food_22.2 min (list uptake_HM22 [hydrogens_mass] of prey2)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.2 energy_fs
        let fe_22.2 energy_fe

        let HCO3_re_r_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H+_re_r_22.2 ( (1 / 8) * 1000 * fe_22.2)
        let H2_re_r_22.2 ((1 / 2) * 1000 * fe_22.2)
        let CO2_rs_r_22.2 ((1 / 5) * 1000 * fs_22.2)
        let NH4_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let HCO3_rs_r_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2_rs_r_22.2 ((1 / 2) * 1000 * fs_22.2)

        let CH4_re_p_22.2 (( 1 / 8) * 1000 * fe_22.2)
        let H2O_re_p_22.2 ((3 / 8) * 1000 * fe_22.2)
        let biomass_rs_p_22.2 ((1 / 20) * 1000 * fs_22.2)
        let H2O_rs_p_22.2 ((9 / 20) * 1000 * fs_22.2)

        let H2O_sum_22.2 (H2O_re_p_22.2 + H2O_rs_p_22.2)
        let H2_sum_22.2 (H2_re_r_22.2 + H2_rs_r_22.2)
        let H+_sum_22.2 (H+_re_r_22.2)
        let CO2_sum_22.2 (CO2_rs_r_22.2)
        let HCO3_sum_22.2 (HCO3_re_r_22.2 + HCO3_rs_r_22.2)
        let CH4_sum_22.2 (CH4_re_p_22.2)
        let NH4_sum_22.2 (NH4_rs_r_22.2)
        let biomass_sum_22.2 (biomass_rs_p_22.2)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + (food_22.2 / H2_sum_22.2 * biomass_sum_22.2)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.2 / H2_sum_22.2 * CO2_sum_22.2)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.2 / H2_sum_22.2 * NH4_sum_22.2)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.2 / H2_sum_22.2 * HCO3_sum_22.2)]
        ask one-of protons [set protons_mass protons_mass - (food_22.2 / H2_sum_22.2 * H+_sum_22.2)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.2 / H2_sum_22.2 * CH4_sum_22.2) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.2 / H2_sum_22.2 * H2O_sum_22.2)]
        ask prey2 [set hydrogens_mass hydrogens_mass - (food_22.2 / num_prey2)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.2b energy_fs
        let fe_22.2b energy_fe

        let HCO3_re_r_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H+_re_r_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H2_re_r_22.2b ((1 / 2) * 1000 * fe_22.2b)
        let CO2_rs_r_22.2b ((1 / 5) * 1000 * fs_22.2b)
        let NH4_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let HCO3_rs_r_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2_rs_r_22.2b ((1 / 2) * 1000 * fs_22.2b)

        let CH4_re_p_22.2b (( 1 / 8) * 1000 * fe_22.2b)
        let H2O_re_p_22.2b ((3 / 8) * 1000 * fe_22.2b)
        let biomass_rs_p_22.2b ((1 / 20) * 1000 * fs_22.2b)
        let H2O_rs_p_22.2b ((9 / 20) * 1000 * fs_22.2b)

        let H2O_sum_22.2b (H2O_re_p_22.2b + H2O_rs_p_22.2b)
        let H2_sum_22.2b (H2_re_r_22.2b + H2_rs_r_22.2b)
        let H+_sum_22.2b (H+_re_r_22.2b)
        let CO2_sum_22.2b (CO2_rs_r_22.2b)
        let HCO3_sum_22.2b (HCO3_re_r_22.2b + HCO3_rs_r_22.2b)
        let CH4_sum_22.2b (CH4_re_p_22.2b)
        let NH4_sum_22.2b(NH4_rs_r_22.2b)
        let biomass_sum_22.2b (biomass_rs_p_22.2b)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * biomass_sum_22.2b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * CO2_sum_22.2b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * NH4_sum_22.2b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * HCO3_sum_22.2b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * H+_sum_22.2b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * CH4_sum_22.2b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey2) / H2_sum_22.2b * H2O_sum_22.2b)]
        ask prey2 [die]
      ]
    ]
  ]
if initial_concentration_acetates >= 0.5 and temp > 293.15 and time > 1
  [
    let target3 hydrogens in-radius 50
    if target3 != nobody
    [
      let prey3 up-to-n-of 30 target3
      let num_prey3 count prey3
      ifelse (sum [hydrogens_mass] of prey3) > uptake_HM22
      [
        let food_22.3 min (list uptake_HM22 [hydrogens_mass] of prey3)
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.3 energy_fs
        let fe_22.3 energy_fe

        let HCO3_re_r_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H+_re_r_22.3 ( (1 / 8) * 1000 * fe_22.3)
        let H2_re_r_22.3 ((1 / 2) * 1000 * fe_22.3)
        let CO2_rs_r_22.3 ((1 / 5) * 1000 * fs_22.3)
        let NH4_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let HCO3_rs_r_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2_rs_r_22.3 ((1 / 2) * 1000 * fs_22.3)

        let CH4_re_p_22.3 (( 1 / 8) * 1000 * fe_22.3)
        let H2O_re_p_22.3 ((3 / 8) * 1000 * fe_22.3)
        let biomass_rs_p_22.3 ((1 / 20) * 1000 * fs_22.3)
        let H2O_rs_p_22.3 ((9 / 20) * 1000 * fs_22.3)

        let H2O_sum_22.3 (H2O_re_p_22.3 + H2O_rs_p_22.3)
        let H2_sum_22.3 (H2_re_r_22.3 + H2_rs_r_22.3)
        let H+_sum_22.3 (H+_re_r_22.3)
        let CO2_sum_22.3 (CO2_rs_r_22.3)
        let HCO3_sum_22.3 (HCO3_re_r_22.3 + HCO3_rs_r_22.3)
        let CH4_sum_22.3 (CH4_re_p_22.3)
        let NH4_sum_22.3 (NH4_rs_r_22.3)
        let biomass_sum_22.3 (biomass_rs_p_22.3)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + (food_22.3 / H2_sum_22.3 * biomass_sum_22.3)
        ask one-of CO2s [set CO2s_mass CO2s_mass - (food_22.3 / H2_sum_22.3 * CO2_sum_22.3)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - (food_22.3 / H2_sum_22.3 * NH4_sum_22.3)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - (food_22.3 / H2_sum_22.3 * HCO3_sum_22.3)]
        ask one-of protons [set protons_mass protons_mass - (food_22.3 / H2_sum_22.3 * H+_sum_22.3)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + (food_22.3 / H2_sum_22.3 * CH4_sum_22.3) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + (food_22.3 / H2_sum_22.3 * H2O_sum_22.3)]
        ask prey3 [set hydrogens_mass hydrogens_mass - (food_22.3 / num_prey3)]
      ]
      [
        set Gr (-14.9443 / 1000) + ((8.314 / 1000 / 1000) * Temp * ln (((LCH4 ^ (1 / 8)) * (1 ^ (3 / 8))) / ((Initial_concentration_bicarbonates ^ (1 / 8)) * (LH2 ^ (1 / 2)) * ((10 ^ -4) ^ (1 / 8)))))
        set energy_fs 1 / (1 + abs((((-4.78 / 1000) / 0.6 ^ -1) + ((18.8 / 1000) / 0.6)) / (0.6 * Gr)))
        set energy_fe (1 - energy_fs)
        let fs_22.3b energy_fs
        let fe_22.3b energy_fe

        let HCO3_re_r_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H+_re_r_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H2_re_r_22.3b ((1 / 2) * 1000 * fe_22.3b)
        let CO2_rs_r_22.3b ((1 / 5) * 1000 * fs_22.3b)
        let NH4_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let HCO3_rs_r_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2_rs_r_22.3b ((1 / 2) * 1000 * fs_22.3b)

        let CH4_re_p_22.3b (( 1 / 8) * 1000 * fe_22.3b)
        let H2O_re_p_22.3b ((3 / 8) * 1000 * fe_22.3b)
        let biomass_rs_p_22.3b ((1 / 20) * 1000 * fs_22.3b)
        let H2O_rs_p_22.3b ((9 / 20) * 1000 * fs_22.3b)

        let H2O_sum_22.3b (H2O_re_p_22.3b + H2O_rs_p_22.3b)
        let H2_sum_22.3b (H2_re_r_22.3b + H2_rs_r_22.3b)
        let H+_sum_22.3b (H+_re_r_22.3b)
        let CO2_sum_22.3b (CO2_rs_r_22.3b)
        let HCO3_sum_22.3b (HCO3_re_r_22.3b + HCO3_rs_r_22.3b)
        let CH4_sum_22.3b (CH4_re_p_22.3b)
        let NH4_sum_22.3b (NH4_rs_r_22.3b)
        let biomass_sum_22.3b (biomass_rs_p_22.3b)

        set  M.bacteriales_HM22_mass  M.bacteriales_HM22_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * biomass_sum_22.3b)
        ask one-of CO2s [set CO2s_mass CO2s_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * CO2_sum_22.3b)]
        ask one-of ammonium [set ammonium_mass ammonium_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * NH4_sum_22.3b)]
        ask one-of Bicarbonates [set bicarbonates_mass bicarbonates_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * HCO3_sum_22.3b)]
        ask one-of protons [set protons_mass protons_mass - ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * H+_sum_22.3b)]
        hatch-CH4s 1 [set color violet set size 0.5 set CH4s_mass CH4s_mass + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * CH4_sum_22.3b) rt random 360 fd 1]
        if pcolor = black
        [set pcolor blue set moles moles + ((sum [hydrogens_mass] of prey3) / H2_sum_22.3b * H2O_sum_22.3b)]
        ask prey3 [die]
      ]
    ]
  ]

end

to reproduce_Mb_HM22
  if M.bacteriales_HM22_mass > 1
  [
  set M.bacteriales_HM22_mass (M.bacteriales_HM22_mass / 2)
  hatch 1 [set energy_fs 0 set energy_fe 0 right random 360 fd 3]
  set uptake_HM22 0.2897
  set energy_fs 0
  set energy_fe 0
  ]
end

to death_Mb_HM22
  set  M.bacteriales_HM22_mass ( M.bacteriales_HM22_mass -  M.bacteriales_HM22_mass * (0.01 / 24)) ;; Represents decay rate per hour based on Vavilin et al., 2000
end


;;; CO2s;;;
to move_CO2s
  set heading 90
  forward 1
end

to combine_CO2s
  let target one-of other CO2s with
  [CO2s_mass <= 1]
  if target != nobody
  [set CO2s_mass CO2s_mass + [CO2s_mass] of target
   ask target [die]
  ]
end

to death_CO2s
  if CO2s_mass = 0 [die]
end

;;; WATER;;

to death_water
  if moles = 0 [die]
end

;;; BICARBONATES;;;

to move_bicarbonates
  set heading 90
  forward 1
end

to combine_bicarbonates
  let target one-of other bicarbonates with
  [bicarbonates_mass <= 0.001]
  if target != nobody
  [set bicarbonates_mass bicarbonates_mass + [bicarbonates_mass] of target
   ask target [die]
  ]
end

to death_bicarbonates
  if bicarbonates_mass <= 0 [die]
end

;;; CH4s ;;;

to move_CH4s
  set heading 90
  forward 1
end

to combine_CH4s
  if CH4s_mass < 0.001
  [
  let target one-of other CH4s with
  [CH4s_mass <= 1]
  if target != nobody
  [set CH4s_mass CH4s_mass + [CH4s_mass] of target
   ask target [die]
  ]]
end

;;; HYDROGENS ;;;

to move_hydrogens
    set heading 90
  forward 1
end

to combine_hydrogens
  let target one-of other hydrogens with
  [hydrogens_mass <= 0.0001]
  if target != nobody
  [set hydrogens_mass hydrogens_mass + [hydrogens_mass] of target
   ask target [die]
  ]
end

to divide_hydrogens
  if hydrogens_mass > 0.0024
  [
  set hydrogens_mass (hydrogens_mass / 2)
  hatch 1 [right random 360 fd 3]
  ]
end

to death_hydrogens
  if hydrogens_mass <= 0 [die]
end

;;; PROTONS ;;;

to move_protons
    set heading 90
  forward 1
end

to combine_protons
  let target one-of other protons with
  [protons_mass <= 0.000001]
  if target != nobody
  [set protons_mass protons_mass + [protons_mass] of target
   ask target [die]
  ]
end

to death_protons
  if protons_mass <= 0 [die]
end

;;; BUTYRATES ;;;

to move_butyrates
    set heading 90
  forward 1
end

to combine_butyrates
  if butyrates_mass < 0.8433
  [
  let target one-of other butyrates with
  [butyrates_mass <= 0.8433]
  if target != nobody
  [set butyrates_mass butyrates_mass + [butyrates_mass] of target
   ask target [die]
  ]]
end

to death_butyrates
  if butyrates_mass <= 0 [die]
end

;;; PROPIONATES ;;;

to move_propionates
    set heading 90
  forward 1
end

to combine_propionates
  if propionates_mass < 0.01
  [
  let target one-of other propionates with
  [propionates_mass <= 1.4729]
  if target != nobody
  [set propionates_mass propionates_mass + [propionates_mass] of target
   ask target [die]
  ]]
end

to death_propionates
  if propionates_mass <= 0 [die]
end


;;; ETHANOLS ;;;

to move_ethanols
    set heading 90
  forward 1
end

to combine_ethanols
  if ethanols_mass < 0.2080
  [
  let target one-of other ethanols with
  [ethanols_mass <= 0.2080]
  if target != nobody
  [set ethanols_mass ethanols_mass + [ethanols_mass] of target
   ask target [die]
  ]]
end

to death_ethanols
  if ethanols_mass <= 0 [die]
end


;;; ACETATES ;;;;

to move_acetates
    set heading 90
  forward 1
end

to combine_acetates
  if time > 0 and time < 264
  [
    if acetates_mass < 0.7
    [
      let target one-of other acetates with
      [acetates_mass <= 0.7]
      if target != nobody
      [set acetates_mass acetates_mass + [acetates_mass] of target
        ask target [die]
    ]]
  ]
  if time >= 264
 [
    if acetates_mass < 0.7
    [
      let target2 up-to-n-of 3 acetates with
      [acetates_mass <= 0.7]
      if target2 != nobody
      [set acetates_mass acetates_mass + (sum [acetates_mass] of target2)
        ask target2 [die]
    ]]
  ]
end

to death_acetates
  if acetates_mass <= 0 [die]
end


;;;;GLOBALS;;;

to continuous-feed-df0.25
  setup-feed
end

to continuous-feed-df0.70
  setup-feed-df0.70
end

to output-2
  file-open "TestOutput-AD.csv"
   file-type ticks file-type ","

   file-type Initial_concentration_glucose file-type ","

   file-type Initial_concentration_glycines file-type ","
   file-type Initial_concentration_serines file-type ","
   file-type Initial_concentration_threonines file-type ","
   file-type Initial_concentration_aspartates file-type ","
   file-type Initial_concentration_glutamics file-type ","

   file-type Initial_concentration_myristates file-type ","
   file-type Initial_concentration_palmitates file-type ","
   file-type Initial_concentration_stearates file-type ","
   file-type Initial_concentration_oleates file-type ","
   file-type Initial_concentration_linoleates file-type ","

   file-type Initial_concentration_ammonium file-type ","
   file-type Initial_concentration_ammonia file-type ","

   file-type Initial_concentration_bicarbonates file-type ","
   file-type Initial_concentration_CO2s file-type ","
   file-type Initial_concentration_CH4s file-type ","
   file-type Initial_concentration_hydrogens file-type ","

   file-type Initial_concentration_butyrates file-type ","
   file-type Initial_concentration_propionates file-type ","
   file-type Initial_concentration_ethanols file-type ","
   file-type Initial_concentration_acetates file-type ","

   file-type total_CH4s_mol file-type ","
   file-type effluent_CH4s_mol file-type ","
   file-type LCH4 file-type ","

   file-type methane_daily file-type ","
   file-type CO2_daily file-type ","
   file-type biogas_daily file-type ","
   file-type methane_content_daily file-type ","

   file-type accumul_CH4s_ml file-type ","
   file-type accumul_CO2s_ml file-type ","
   file-type accumul_hydrogens_ml file-type ","
   file-type Total_biogas_production file-type ","

   file-type total_carbs file-type ","
   file-type total_glucose file-type ","

   file-type total_proteins file-type ","
   file-type total_glycines file-type ","
   file-type total_serines file-type ","
   file-type total_threonines file-type ","
   file-type total_aspartates file-type ","
   file-type total_glutamics file-type ","

   file-type total_lipids file-type ","
   file-type total_myristates file-type ","
   file-type total_palmitates file-type ","
   file-type total_stearates file-type ","
   file-type total_oleates file-type ","
   file-type total_linoleates file-type ","

   file-type total_ammonium file-type ","
   file-type total_ammonia file-type ","
   file-type total_bicarbonates file-type ","

   file-type total_butyrates file-type ","
   file-type total_propionates file-type ","
   file-type total_ethanols file-type ","
   file-type total_acetates file-type ","

   file-type total_percentage_bacteroidales file-type ","
   file-type total_percentage_clostridiales file-type ","
   file-type total_percentage_thermotogales file-type ","
   file-type total_percentage_syntrophomonas file-type ","
   file-type total_percentage_syntrophus file-type ","
   file-type total_percentage_clostridium file-type ","
   file-type total_percentage_syntrophobacterales file-type ","
   file-type total_percentage_methanobacteriales file-type ","
   file-type total_percentage_methanomicrobiales file-type ","
   file-type total_percentage_methanosarcinales file-type ","
   file-type total_percentage_methanosaeta file-type ","

   file-type ((total_C.aceticum_FB5/HAB19) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100 file-type ","
   file-type ((total_Acetobacterium.woodii_FB5/HAB19) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100 file-type ","
   file-print ((total_C.aceticum_HAB19) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100

  file-close
end


;;;; HELPER PROCEDURES

to setup-feed-df0.70

  ;;;CARBS;;;

  set-default-shape carbs "circle";; Carbohydrates shape
  Create-carbs (933) ;; Create the carbs available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set carbs_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.21 * 0.70) / 1000 / 1.1852 / 162.141 * 1000)/ 933 / 24
    setxy random-xcor random-ycor
  ]

  ;;;PROTEINS;;;

  set-default-shape proteins "circle";; Proteins shape
  Create-proteins (1000) ;; Create the proteins available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set proteins_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.30 * 0.70) / 1000 / 1.5 / 352.391 * 1000)/ 1000 / 24
    setxy random-xcor random-ycor
  ]

  ;;;LIPIDS;;;

  set-default-shape lipids "circle";; Lipids shape
  Create-lipids (1000) ;; Create the lipids available in mmol/d, then initialize their variables
  [
    set color white
    set size 0.5
    set lipids_mass (OLR_Feed * 1000 * Reactor_working_volume * mgCOD/mgVSS * (0.39 * 0.70) / 1000 / 2.8295 / 787.264 * 1000)/ 1000 / 24
    setxy random-xcor random-ycor
  ]

  ;;; AMMONIUM;;;

  set-default-shape ammonium "triangle"
  Create-Ammonium (222) ;; Create the ammonium available in mmol/h, then initialize ther variables
  [
    set color pink
    set size 0.5
    set ammonium_mass (283) * feed_volume / 1000 / 18.0385 * 1000 / 222
    setxy random-xcor random-ycor
  ]

  ;;; BICARBONATES ;;;
  set-default-shape bicarbonates "default"
  create-bicarbonates (289)
  [ set color lime
    set size 0.5
    set bicarbonates_mass (( 126 * reactor_working_volume / 1000 / 61.0168 * 1000) / 289)
    setxy random-xcor random-ycor
  ]
end

to make_hydrolysed_glucose
let old-heading heading
end

to count_carbs
  set total_carbs (sum [carbs_mass] of carbs)
   let num_carbs count carbs
  ask n-of (count carbs * 0.002) carbs [die]
end

to count_glucose
  set total_glucose (sum [glucose_mass] of glucose)
  let num_glucose count glucose
  ask n-of (count glucose * 0.002) glucose [die]
end


to count_proteins
  set total_proteins (sum [proteins_mass] of proteins)
   let num_proteins count proteins
  ask n-of (count proteins * 0.002) proteins [die]
end

to count_glycines
  set total_glycines (sum [glycines_mass] of glycines)
  let num_glycines count glycines
  ask n-of (count glycines * 0.002) glycines [die]
  end

to count_serines
  set total_serines (sum [serines_mass] of serines)
  let num_serines count serines
  ask n-of (count serines * 0.002) serines [die]
end

to count_threonines
  set total_threonines (sum [threonines_mass] of threonines)
  let num_threonines count threonines
  ask n-of (count threonines * 0.002) threonines [die]
end

to count_aspartates
  set total_aspartates (sum [aspartates_mass] of aspartates)
  let num_aspartates count aspartates
  ask n-of (count aspartates * 0.002) aspartates [die]
end

to count_glutamics
  set total_glutamics (sum [glutamics_mass] of glutamics)
  let num_glutamics count glutamics
  ask n-of (count glutamics * 0.002) glutamics [die]
end


to count_lipids
  set total_lipids (sum [lipids_mass] of lipids)
  let num_lipids count lipids
  ask n-of (count lipids * 0.002) lipids [die]
end

to count_myristates
  set total_myristates (sum [myristates_mass] of myristates)
  let num_myristates count myristates
  ask n-of (count myristates * 0.002) myristates [die]
end

to count_palmitates
  set total_palmitates (sum [palmitates_mass] of palmitates)
  let num_palmitates count palmitates
  ask n-of (count palmitates * 0.002) palmitates [die]
end
to count_stearates
  set total_stearates (sum [stearates_mass] of stearates)
  let num_stearates count stearates
  ask n-of (count stearates * 0.002) stearates [die]
end
to count_oleates
  set total_oleates (sum [oleates_mass] of oleates)
  let num_oleates count oleates
  ask n-of (count oleates * 0.002) oleates [die]
end
to count_linoleates
  set total_linoleates (sum [linoleates_mass] of linoleates)
  let num_linoleates count linoleates
  ask n-of (count linoleates * 0.002) linoleates [die]
end


 to count_protons
  set total_protons (sum [protons_mass] of protons)
  ifelse total_protons > (10 ^ (- pH) * Reactor_working_volume * 1000)
  [
    ask n-of (count protons * 0.5) protons [die]
  ]
  [
    let num_protons count protons
    ask protons [set protons_mass ((10 ^ (- pH) * Reactor_working_volume * 1000) / num_protons)]
   ]
end

to count_ammonium
  set total_ammonium (sum [ammonium_mass] of ammonium )
  let num_ammonium count ammonium
  ask n-of (count ammonium * 0.002) ammonium [die]
end

to count_ammonia
  set total_ammonia (sum [ammonia_mass] of ammonia )
  let num_ammonia count ammonia
  ask n-of (count ammonia * 0.002) ammonia [die]
end

to count_butyrates
    set total_butyrates (sum [butyrates_mass] of butyrates)
    let num_butyrates count butyrates
  ask n-of (count butyrates * 0.002) butyrates [die]
end

 to count_propionates
    set total_propionates (sum [propionates_mass] of propionates)
    let num_propionates count propionates
  ask n-of (count propionates * 0.002) propionates [die]
end

 to count_ethanols
    set total_ethanols ( sum [ethanols_mass] of ethanols)
    let num_ethanols count ethanols
  ask n-of (count ethanols * 0.002) ethanols [die]
end

 to count_acetates
    set total_acetates (sum [acetates_mass] of acetates)
    let num_acetates count acetates
  ask n-of (count acetates * 0.002) acetates [die]
end




to count_bicarbonates
     set total_bicarbonates ( sum [bicarbonates_mass] of bicarbonates)
  if total_bicarbonates > ( 126 * reactor_working_volume / 1000 / 61.0168 * 1000)
  [
  ask n-of (count bicarbonates * 0.9) bicarbonates [die]
  ]
end

 to count_CO2s_mol
    set total_CO2s_mol (sum [CO2s_mass] of CO2s)
    ifelse total_CO2s_mol > ((((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))) * ((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000))
    [
      set effluent_CO2s_mol ((sum [CO2s_mass] of CO2s) - ((((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))) * ((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)))
    ]
    [
      set effluent_Co2s_mol 0.00000000001
    ]
end


 to count_CO2s_ml
   set total_CO2s_ml (((((0 + effluent_CO2s_mol ) / 1000) * 0.08205 * temp) / 1) * 1000)
 end

 to count_accumul_CO2s_ml
  set accumul_CO2s_ml accumul_Co2s_ml + total_CO2s_ml
end

to count_accumul_CO2s_ml_daily
  if ticks > 1  and ticks mod 24 = 0
  [set accumul_CO2s_ml_daily accumul_Co2s_ml ]
end

 to count_CH4s_mol
    set total_CH4s_mol (sum [CH4s_mass] of CH4s )
    ifelse total_CH4s_mol > (((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * reactor_working_volume) * (((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000))))
    [
      set effluent_CH4s_mol ((sum [CH4s_mass] of CH4s) - (((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * reactor_working_volume) * (((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)/ (((((0.00033 / 1000 * 101325) * e ^ (2400 * (1 / Temp - 1 / 298.15))) * 1 * 44.01 * 1000) * reactor_working_volume / 1000 / 44.01 * 1000)+((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 2.02 * 1000) * reactor_working_volume / 1000 / 2.02 * 1000)+((((0.000014 / 1000 * 101325) * e ^ (1600 * (1 / Temp - 1 / 298.15))) * 1 * 16.04 * 1000) * reactor_working_volume / 1000 / 16.04 * 1000)))))
    ]
    [
      set effluent_CH4s_mol 0.0000000000001
    ]
end


to count_CH4s_ml
    set total_CH4s_ml (((((0 + effluent_CH4s_mol) / 1000) * 0.08205 * temp) / 1) * 1000)
end

to count_accumul_CH4s_ml
  set accumul_CH4s_ml accumul_Ch4s_ml + total_CH4s_ml
end

to count_accumul_CH4s_ml_daily
  if ticks > 1  and ticks mod 24 = 0
  [set accumul_CH4s_ml_daily accumul_Ch4s_ml ]
end


 to count_hydrogens_mol
    set total_hydrogens_mol (sum [hydrogens_mass] of hydrogens )
    ifelse total_hydrogens_mol > ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * reactor_working_volume)
    [
      set effluent_H2s_mol ((sum [hydrogens_mass] of hydrogens) - ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * reactor_working_volume))
    ]
    [
      set effluent_H2s_mol 0.00000000000000000001
    ]

end

  to count_hydrogens_ml
  ifelse effluent_H2s_mol > last_tick_hydrogen
  [
    set total_hydrogens_ml ((((( 0 + effluent_H2s_mol ) / 1000) * 0.08205 * temp) / 1) * 1000)
  ]
  [
    set total_hydrogens_ml 0.000000000000000000001
  ]
end

to count_accumul_hydrogens_ml
  set accumul_hydrogens_ml accumul_hydrogens_ml + total_hydrogens_ml
end

to count_accumul_hydrogens_ml_daily
  if ticks > 1  and ticks mod 24 = 0
  [set accumul_hydrogens_ml_daily accumul_hydrogens_ml]
end


 to count_total_biogas_production
   set Total_biogas_production (total_biogas_production + total_CO2s_ml + total_CH4s_ml  + total_hydrogens_ml)
 end

to count_total_biogas_daily
  if ticks > 1  and ticks mod 24 = 0
    [set Total_biogas_daily (total_biogas_production )]
 end


to count_methane_content_hourly
   set Methane_content_hourly ((total_CH4s_ml * 100) / (total_CO2s_ml + total_CH4s_ml + total_hydrogens_ml))
end


to count_methane_daily
  if ticks > 1  and ticks mod 24 = 0
  [
    set Methane_daily (accumul_CH4s_ml - last_day_methane)
  ]
end

to count_CO2_daily
  if ticks > 1  and ticks mod 24 = 0
  [
    set CO2_daily (accumul_CO2s_ml - last_day_CO2)
  ]
end

to count_biogas_daily
  if ticks > 1  and ticks mod 24 = 0
  [
    set biogas_daily (total_biogas_production - last_day_biogas)
  ]
end


to count_methane_content_daily
  if ticks > 1  and ticks mod 24 = 0
  [
    set Methane_content_daily ((Methane_daily) * 100 / ( biogas_daily))
  ]
end

to escape_CO2s
    let num_CO2s count CO2s
    ask CO2s [set CO2s_mass ((total_CO2s_mol - effluent_CO2s_mol) / num_CO2s)]
end

to escape_CH4s
    let num_CH4s count CH4s
    ask CH4s [set CH4s_mass ((total_CH4s_mol - effluent_CH4s_mol) / num_CH4s)]
end

to escape_hydrogens
    let num_hydrogens count hydrogens
    if total_hydrogens_mol > ((((0.0000078 / 1000 * 101325) * e ^ (530 * (1 / Temp - 1 / 298.15))) * 1 * 1000) * reactor_working_volume)
    [
      ask hydrogens [set hydrogens_mass ((total_hydrogens_mol - effluent_H2s_mol) / num_hydrogens)]
    ]
end

 to count_clostridiales_FB1
    set total_clostridiales_FB1 sum [clostridiales_FB1_mass] of clostridiales_FB1
end

 to count_clostridiales_FB2
    set total_clostridiales_FB2 sum [clostridiales_FB2_mass] of clostridiales_FB2
end

 to count_clostridiales_FB3
    set total_clostridiales_FB3 sum [clostridiales_FB3_mass] of clostridiales_FB3
end

 to count_clostridiales_FB4
    set total_clostridiales_FB4 sum [clostridiales_FB4_mass] of clostridiales_FB4
end

 to count_clostridiales_FB6
    set total_clostridiales_FB6 sum [clostridiales_FB6_mass] of clostridiales_FB6
end
 to count_clostridiales_FB7
    set total_clostridiales_FB7 sum [clostridiales_FB7_mass] of clostridiales_FB7
end
 to count_clostridiales_FB8
    set total_clostridiales_FB8 sum [clostridiales_FB8_mass] of clostridiales_FB8
end
 to count_clostridiales_FB9
    set total_clostridiales_FB9 sum [clostridiales_FB9_mass] of clostridiales_FB9
end
 to count_clostridiales_FB10
    set total_clostridiales_FB10 sum [clostridiales_FB10_mass] of clostridiales_FB10
end



 to count_bacteroidales_FB1
    set total_bacteroidales_FB1 sum [bacteroidales_FB1_mass] of bacteroidales_FB1
end

 to count_bacteroidales_FB2
    set total_bacteroidales_FB2 sum [bacteroidales_FB2_mass] of bacteroidales_FB2
end
 to count_bacteroidales_FB3
    set total_bacteroidales_FB3 sum [bacteroidales_FB3_mass] of bacteroidales_FB3
end
 to count_bacteroidales_FB4
    set total_bacteroidales_FB4 sum [bacteroidales_FB4_mass] of bacteroidales_FB4
end
 to count_bacteroidales_FB5
    set total_bacteroidales_FB5 sum [bacteroidales_FB5_mass] of bacteroidales_FB5
end
   to count_bacteroidales_FB6
    set total_bacteroidales_FB6 sum [bacteroidales_FB6_mass] of bacteroidales_FB6
end
   to count_bacteroidales_FB7
    set total_bacteroidales_FB7 sum [bacteroidales_FB7_mass] of bacteroidales_FB7
end
   to count_bacteroidales_FB8
    set total_bacteroidales_FB8 sum [bacteroidales_FB8_mass] of bacteroidales_FB8
end


  to count_thermotogales_FB5
    set total_thermotogales_FB5 sum [thermotogales_FB5_mass] of thermotogales_FB5
end
   to count_thermotogales_FB6
    set total_thermotogales_FB6 sum [thermotogales_FB6_mass] of thermotogales_FB6
end
   to count_thermotogales_FB7
    set total_thermotogales_FB7 sum [thermotogales_FB7_mass] of thermotogales_FB7
end
   to count_thermotogales_FB8
    set total_thermotogales_FB8 sum [thermotogales_FB8_mass] of thermotogales_FB8
end
   to count_thermotogales_FB9
    set total_thermotogales_FB9 sum [thermotogales_FB9_mass] of thermotogales_FB9
end
   to count_thermotogales_FB10
    set total_thermotogales_FB10 sum [thermotogales_FB10_mass] of thermotogales_FB10
end


 to count_syntrophomonas_AC11
    set total_syntrophomonas_AC11 sum [syntrophomonas_AC11_mass] of syntrophomonas_AC11
end
   to count_syntrophomonas_AC12
    set total_syntrophomonas_AC12 sum [syntrophomonas_AC12_mass] of syntrophomonas_AC12
end
   to count_syntrophomonas_AC13
    set total_syntrophomonas_AC13 sum [syntrophomonas_AC13_mass] of syntrophomonas_AC13
end
   to count_syntrophomonas_AC14
    set total_syntrophomonas_AC14 sum [syntrophomonas_AC14_mass] of syntrophomonas_AC14
end
   to count_syntrophomonas_AC15
    set total_syntrophomonas_AC15 sum [syntrophomonas_AC15_mass] of syntrophomonas_AC15
end
 to count_syntrophomonas_AC16
    set total_syntrophomonas_AC16 sum [syntrophomonas_AC16_mass] of syntrophomonas_AC16
end


 to count_syntrophus_AC12
    set total_syntrophus_AC12 sum [syntrophus_AC12_mass] of syntrophus_AC12
end
 to count_syntrophus_AC13
    set total_syntrophus_AC13 sum [syntrophus_AC13_mass] of syntrophus_AC13
end
 to count_syntrophus_AC16
    set total_syntrophus_AC16 sum [syntrophus_AC16_mass] of syntrophus_AC16
end


to count_syntrophobacterales_AC17
    set total_syntrophobacterales_AC17 sum [syntrophobacterales_AC17_mass] of syntrophobacterales_AC17
end



 to count_C.kluyveri_AC18
    set total_C.kluyveri_AC18  sum [C.kluyveri_AC18_mass] of C.kluyveri_AC18
end

 to count_C.aceticum_HAB19
    set total_C.aceticum_HAB19 sum [C.aceticum_HAB19_mass] of C.aceticum_HAB19
end

 to count_C.ultunense_FB5/HPB20
    set total_C.ultunense_FB5/HPB20 sum [C.ultunense_FB5/HPB20_mass] of C.ultunense_FB5/HPB20
end

 to count_C.aceticum_FB5/HAB19
    set total_C.aceticum_FB5/HAB19 sum [C.aceticum_FB5/HAB19_mass] of C.aceticum_FB5/HAB19
end

 to count_Acetobacterium.woodii_FB5/HAB19
    set total_Acetobacterium.woodii_FB5/HAB19 sum [Acetobacterium.woodii_FB5/HAB19_mass] of Acetobacterium.woodii_FB5/HAB19
end



 to count_M.sarcinales_AM21/HM22
    set total_M.sarcinales_AM21/HM22 sum [M.sarcinales_AM21/HM22_mass] of M.sarcinales_AM21/HM22
end



 to count_M.concilii_AM21
    set total_M.concilii_AM21 sum [M.concilii_AM21_mass] of M.concilii_AM21
end



 to count_M.microbiales_HM22
    set total_M.microbiales_HM22 sum [M.microbiales_HM22_mass] of M.microbiales_HM22
end



 to count_M.bacteriales_HM22
    set total_M.bacteriales_HM22 sum [M.bacteriales_HM22_mass] of M.bacteriales_HM22
end



 to calculate_bacteroidales_percentage
   set total_percentage_bacteroidales ((total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 +  total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8  ) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_clostridiales_percentage
   set total_percentage_clostridiales ((total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 +  total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_thermotogales_percentage
   set total_percentage_thermotogales ((total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22) )* 100
 end

 to calculate_syntrophomonas_percentage
   set total_percentage_syntrophomonas ((total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_Syntrophomonas_AC16) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_syntrophus_percentage
   set total_percentage_syntrophus ((total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_clostridium_percentage
   set total_percentage_clostridium ((total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_syntrophobacterales_percentage
   set total_percentage_syntrophobacterales ((total_syntrophobacterales_AC17) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22) )* 100
 end


 to calculate_methanobacteriales_percentage
   set total_percentage_methanobacteriales ((total_M.bacteriales_HM22 ) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22) )* 100
 end

 to calculate_methanomicrobiales_percentage
   set total_percentage_methanomicrobiales ((total_M.microbiales_HM22 ) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_methanosarcinales_percentage
   set total_percentage_methanosarcinales ((total_M.sarcinales_AM21/HM22 ) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22 ) )* 100
 end

 to calculate_methanosaeta_percentage
   set total_percentage_methanosaeta ((total_M.concilii_AM21 ) / (total_bacteroidales_FB1 + total_bacteroidales_FB2 + total_bacteroidales_FB3 + total_bacteroidales_FB4 + total_bacteroidales_FB5 + total_bacteroidales_FB6 + total_bacteroidales_FB7 + total_bacteroidales_FB8 + total_clostridiales_FB1 + total_clostridiales_FB2 + total_clostridiales_FB3 + total_clostridiales_FB4 + total_clostridiales_FB6 + total_clostridiales_FB7 + total_clostridiales_FB8 + total_clostridiales_FB9 + total_clostridiales_FB10 + total_thermotogales_FB5 + total_thermotogales_FB6 + total_thermotogales_FB7 + total_thermotogales_FB8 + total_thermotogales_FB9 + total_thermotogales_FB10 + total_syntrophomonas_AC11 + total_syntrophomonas_AC12 + total_syntrophomonas_AC13 + total_syntrophomonas_AC14 + total_syntrophomonas_AC15 + total_syntrophomonas_AC16 + total_syntrophus_AC12 + total_syntrophus_AC13 + total_syntrophus_AC16 + total_syntrophobacterales_AC17 + total_C.kluyveri_AC18 + total_C.aceticum_HAB19 + total_C.ultunense_FB5/HPB20 + total_C.aceticum_FB5/HAB19 + total_Acetobacterium.woodii_FB5/HAB19 + total_M.sarcinales_AM21/HM22 + total_M.concilii_AM21 + total_M.microbiales_HM22 + total_M.bacteriales_HM22) )* 100
 end
@#$#@#$#@
GRAPHICS-WINDOW
25
405
643
824
-1
-1
10.0
1
10
1
1
1
0
1
0
1
-30
30
-20
20
1
1
1
ticks
30.0

INPUTBOX
30
77
183
137
OLR_Feed
0.75
1
0
Number

TEXTBOX
42
47
169
81
Food/feed variables
14
0.0
1

INPUTBOX
196
142
351
202
Temperature
35.0
1
0
Number

INPUTBOX
196
77
351
137
Reactor_working_volume
4.0
1
0
Number

TEXTBOX
201
48
351
66
Reactor's parameters
14
0.0
1

INPUTBOX
197
270
352
330
MLVSS
6300.0
1
0
Number

BUTTON
375
311
486
370
Set-up
Setup
NIL
1
T
OBSERVER
NIL
NIL
NIL
NIL
1

BUTTON
501
312
615
371
Go
Go
T
1
T
OBSERVER
NIL
NIL
NIL
NIL
0

INPUTBOX
370
74
525
134
Bacteroidales_percentage
42.78
1
0
Number

INPUTBOX
29
204
184
264
Ammonium_concentration
283.0
1
0
Number

TEXTBOX
944
205
1021
227
Outputs
18
0.0
1

INPUTBOX
29
139
184
199
mgCOD/mgVSS
1.8
1
0
Number

INPUTBOX
370
137
525
197
Clostridiales_percentage
23.04
1
0
Number

TEXTBOX
364
47
556
77
Fermentive/Acidogenic Bacteria
12
0.0
1

TEXTBOX
633
49
783
67
Acetogenic Bacteria
12
0.0
1

TEXTBOX
982
44
1125
62
Methanogenic bacteria
12
0.0
1

INPUTBOX
371
203
526
263
Thermotogales_percentage
8.74
1
0
Number

INPUTBOX
546
77
701
137
Syntrophomonas_percentage
9.12
1
0
Number

INPUTBOX
707
75
862
135
Clostridium_percentage
7.95
1
0
Number

INPUTBOX
708
138
863
198
Syntrophobacterales_percentage
0.69
1
0
Number

INPUTBOX
547
140
702
200
Syntrophus_percentage
0.43
1
0
Number

INPUTBOX
1070
72
1242
132
Methanosarcinales_percentage
0.56
1
0
Number

INPUTBOX
886
74
1059
134
Methanobacteriales_percentage
0.13
1
0
Number

INPUTBOX
886
139
1060
199
Methanomicrobiales_percentage
0.22
1
0
Number

INPUTBOX
196
206
351
266
SRT
20.0
1
0
Number

INPUTBOX
28
269
183
329
Ammonium_std_dev
14.0
1
0
Number

INPUTBOX
1070
141
1242
201
Methanosaeta_percentage
0.0
1
0
Number

PLOT
826
355
1241
602
Biogas production (ml)
Time (h)
Accumulative biogas mL
0.0
10.0
0.0
10.0
true
true
"" ""
PENS
"CH4" 1.0 0 -16449023 true "" "plot accumul_CH4s_ml"
"CO2" 1.0 0 -4699768 true "" "plot accumul_CO2s_ml"

MONITOR
659
687
804
732
Clostridiales (%)
total_percentage_clostridiales
2
1
11

TEXTBOX
648
613
829
643
Fermentive/Acidogenic Bacteria
12
0.0
1

TEXTBOX
440
10
590
32
Inputs
18
0.0
1

MONITOR
827
637
964
682
Syntrophomonas (%)
total_percentage_syntrophomonas
2
1
11

TEXTBOX
837
614
987
632
Acetogenic Bacteria
12
0.0
1

TEXTBOX
1022
613
1156
633
Methanogenic Bacteria
12
0.0
1

MONITOR
828
731
963
776
Clostridium (%)
total_percentage_clostridium
2
1
11

MONITOR
828
780
962
825
Syntrophobacterales (%)
total_percentage_syntrophobacterales
2
1
11

MONITOR
975
636
1105
681
Methanobacteriales (%)
total_percentage_methanobacteriales
2
1
11

MONITOR
976
687
1106
732
Methanomicrobiales (%)
total_percentage_methanomicrobiales
2
1
11

MONITOR
1109
637
1237
682
Methanosarcinales (%)
total_percentage_methanosarcinales
2
1
11

MONITOR
1109
687
1237
732
Methanosaetas (%)
total_percentage_methanosaeta
2
1
11

MONITOR
679
294
805
339
Acc. CH4 prod (mL)
accumul_CH4s_ml
2
1
11

MONITOR
1092
294
1243
339
Acc. biogas production (mL)
Total_biogas_production
2
1
11

MONITOR
658
638
804
683
Bacteroidales (%)
total_percentage_bacteroidales
2
1
11

MONITOR
660
735
803
780
Thermotogales (%)
total_percentage_thermotogales
2
1
11

MONITOR
828
684
963
729
Syntrophus (%)
total_percentage_syntrophus
2
1
11

INPUTBOX
196
332
351
392
pH
7.0
1
0
Number

MONITOR
954
242
1076
287
Daily methane (%)
methane_content_daily
2
1
11

MONITOR
816
294
943
339
Acc. CO2 prod (mL)
accumul_CO2s_ml
2
1
11

MONITOR
956
294
1077
339
Acc. H2 prod (mL)
accumul_hydrogens_ml
2
1
11

INPUTBOX
29
332
184
392
VSS_sludge
17.09
1
0
Number

MONITOR
679
242
805
287
Daily CH4 prod (mL)
Methane_daily
2
1
11

MONITOR
815
243
942
288
Daily CO2 prod (mL)
CO2_daily
2
1
11

MONITOR
1092
242
1242
287
Daily biogas prod (mL)
Biogas_daily
2
1
11

@#$#@#$#@
## WHAT IS IT?

(a general understanding of what the model is trying to show or explain)

## HOW IT WORKS

(what rules the agents use to create the overall behavior of the model)

## HOW TO USE IT

(how to use the model, including a description of each of the items in the Interface tab)

## THINGS TO NOTICE

(suggested things for the user to notice while running the model)

## THINGS TO TRY

(suggested things for the user to try to do (move sliders, switches, etc.) with the model)

## EXTENDING THE MODEL

(suggested things to add or change in the Code tab to make the model more complicated, detailed, accurate, etc.)

## NETLOGO FEATURES

(interesting or unusual features of NetLogo that the model uses, particularly in the Code tab; or where workarounds were needed for missing features)

## RELATED MODELS

(models in the NetLogo Models Library and elsewhere which are of related interest)

## CREDITS AND REFERENCES

(a reference to the model's URL on the web if it has one, as well as any other necessary credits, citations, and links)
@#$#@#$#@
default
true
0
Polygon -7500403 true true 150 5 40 250 150 205 260 250

airplane
true
0
Polygon -7500403 true true 150 0 135 15 120 60 120 105 15 165 15 195 120 180 135 240 105 270 120 285 150 270 180 285 210 270 165 240 180 180 285 195 285 165 180 105 180 60 165 15

arrow
true
0
Polygon -7500403 true true 150 0 0 150 105 150 105 293 195 293 195 150 300 150

box
false
0
Polygon -7500403 true true 150 285 285 225 285 75 150 135
Polygon -7500403 true true 150 135 15 75 150 15 285 75
Polygon -7500403 true true 15 75 15 225 150 285 150 135
Line -16777216 false 150 285 150 135
Line -16777216 false 150 135 15 75
Line -16777216 false 150 135 285 75

bug
true
0
Circle -7500403 true true 96 182 108
Circle -7500403 true true 110 127 80
Circle -7500403 true true 110 75 80
Line -7500403 true 150 100 80 30
Line -7500403 true 150 100 220 30

butterfly
true
0
Polygon -7500403 true true 150 165 209 199 225 225 225 255 195 270 165 255 150 240
Polygon -7500403 true true 150 165 89 198 75 225 75 255 105 270 135 255 150 240
Polygon -7500403 true true 139 148 100 105 55 90 25 90 10 105 10 135 25 180 40 195 85 194 139 163
Polygon -7500403 true true 162 150 200 105 245 90 275 90 290 105 290 135 275 180 260 195 215 195 162 165
Polygon -16777216 true false 150 255 135 225 120 150 135 120 150 105 165 120 180 150 165 225
Circle -16777216 true false 135 90 30
Line -16777216 false 150 105 195 60
Line -16777216 false 150 105 105 60

car
false
0
Polygon -7500403 true true 300 180 279 164 261 144 240 135 226 132 213 106 203 84 185 63 159 50 135 50 75 60 0 150 0 165 0 225 300 225 300 180
Circle -16777216 true false 180 180 90
Circle -16777216 true false 30 180 90
Polygon -16777216 true false 162 80 132 78 134 135 209 135 194 105 189 96 180 89
Circle -7500403 true true 47 195 58
Circle -7500403 true true 195 195 58

circle
false
0
Circle -7500403 true true 0 0 300

circle 2
false
0
Circle -7500403 true true 0 0 300
Circle -16777216 true false 30 30 240

cow
false
0
Polygon -7500403 true true 200 193 197 249 179 249 177 196 166 187 140 189 93 191 78 179 72 211 49 209 48 181 37 149 25 120 25 89 45 72 103 84 179 75 198 76 252 64 272 81 293 103 285 121 255 121 242 118 224 167
Polygon -7500403 true true 73 210 86 251 62 249 48 208
Polygon -7500403 true true 25 114 16 195 9 204 23 213 25 200 39 123

cylinder
false
0
Circle -7500403 true true 0 0 300

dot
false
0
Circle -7500403 true true 90 90 120

face happy
false
0
Circle -7500403 true true 8 8 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Polygon -16777216 true false 150 255 90 239 62 213 47 191 67 179 90 203 109 218 150 225 192 218 210 203 227 181 251 194 236 217 212 240

face neutral
false
0
Circle -7500403 true true 8 7 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Rectangle -16777216 true false 60 195 240 225

face sad
false
0
Circle -7500403 true true 8 8 285
Circle -16777216 true false 60 75 60
Circle -16777216 true false 180 75 60
Polygon -16777216 true false 150 168 90 184 62 210 47 232 67 244 90 220 109 205 150 198 192 205 210 220 227 242 251 229 236 206 212 183

fish
false
0
Polygon -1 true false 44 131 21 87 15 86 0 120 15 150 0 180 13 214 20 212 45 166
Polygon -1 true false 135 195 119 235 95 218 76 210 46 204 60 165
Polygon -1 true false 75 45 83 77 71 103 86 114 166 78 135 60
Polygon -7500403 true true 30 136 151 77 226 81 280 119 292 146 292 160 287 170 270 195 195 210 151 212 30 166
Circle -16777216 true false 215 106 30

flag
false
0
Rectangle -7500403 true true 60 15 75 300
Polygon -7500403 true true 90 150 270 90 90 30
Line -7500403 true 75 135 90 135
Line -7500403 true 75 45 90 45

flower
false
0
Polygon -10899396 true false 135 120 165 165 180 210 180 240 150 300 165 300 195 240 195 195 165 135
Circle -7500403 true true 85 132 38
Circle -7500403 true true 130 147 38
Circle -7500403 true true 192 85 38
Circle -7500403 true true 85 40 38
Circle -7500403 true true 177 40 38
Circle -7500403 true true 177 132 38
Circle -7500403 true true 70 85 38
Circle -7500403 true true 130 25 38
Circle -7500403 true true 96 51 108
Circle -16777216 true false 113 68 74
Polygon -10899396 true false 189 233 219 188 249 173 279 188 234 218
Polygon -10899396 true false 180 255 150 210 105 210 75 240 135 240

house
false
0
Rectangle -7500403 true true 45 120 255 285
Rectangle -16777216 true false 120 210 180 285
Polygon -7500403 true true 15 120 150 15 285 120
Line -16777216 false 30 120 270 120

leaf
false
0
Polygon -7500403 true true 150 210 135 195 120 210 60 210 30 195 60 180 60 165 15 135 30 120 15 105 40 104 45 90 60 90 90 105 105 120 120 120 105 60 120 60 135 30 150 15 165 30 180 60 195 60 180 120 195 120 210 105 240 90 255 90 263 104 285 105 270 120 285 135 240 165 240 180 270 195 240 210 180 210 165 195
Polygon -7500403 true true 135 195 135 240 120 255 105 255 105 285 135 285 165 240 165 195

line
true
0
Line -7500403 true 150 0 150 300

line half
true
0
Line -7500403 true 150 0 150 150

pentagon
false
0
Polygon -7500403 true true 150 15 15 120 60 285 240 285 285 120

person
false
0
Circle -7500403 true true 110 5 80
Polygon -7500403 true true 105 90 120 195 90 285 105 300 135 300 150 225 165 300 195 300 210 285 180 195 195 90
Rectangle -7500403 true true 127 79 172 94
Polygon -7500403 true true 195 90 240 150 225 180 165 105
Polygon -7500403 true true 105 90 60 150 75 180 135 105

plant
false
0
Rectangle -7500403 true true 135 90 165 300
Polygon -7500403 true true 135 255 90 210 45 195 75 255 135 285
Polygon -7500403 true true 165 255 210 210 255 195 225 255 165 285
Polygon -7500403 true true 135 180 90 135 45 120 75 180 135 210
Polygon -7500403 true true 165 180 165 210 225 180 255 120 210 135
Polygon -7500403 true true 135 105 90 60 45 45 75 105 135 135
Polygon -7500403 true true 165 105 165 135 225 105 255 45 210 60
Polygon -7500403 true true 135 90 120 45 150 15 180 45 165 90

sheep
false
15
Circle -1 true true 203 65 88
Circle -1 true true 70 65 162
Circle -1 true true 150 105 120
Polygon -7500403 true false 218 120 240 165 255 165 278 120
Circle -7500403 true false 214 72 67
Rectangle -1 true true 164 223 179 298
Polygon -1 true true 45 285 30 285 30 240 15 195 45 210
Circle -1 true true 3 83 150
Rectangle -1 true true 65 221 80 296
Polygon -1 true true 195 285 210 285 210 240 240 210 195 210
Polygon -7500403 true false 276 85 285 105 302 99 294 83
Polygon -7500403 true false 219 85 210 105 193 99 201 83

square
false
0
Rectangle -7500403 true true 30 30 270 270

square 2
false
0
Rectangle -7500403 true true 30 30 270 270
Rectangle -16777216 true false 60 60 240 240

star
false
0
Polygon -7500403 true true 151 1 185 108 298 108 207 175 242 282 151 216 59 282 94 175 3 108 116 108

target
false
0
Circle -7500403 true true 0 0 300
Circle -16777216 true false 30 30 240
Circle -7500403 true true 60 60 180
Circle -16777216 true false 90 90 120
Circle -7500403 true true 120 120 60

tree
false
0
Circle -7500403 true true 118 3 94
Rectangle -6459832 true false 120 195 180 300
Circle -7500403 true true 65 21 108
Circle -7500403 true true 116 41 127
Circle -7500403 true true 45 90 120
Circle -7500403 true true 104 74 152

triangle
false
0
Polygon -7500403 true true 150 30 15 255 285 255

triangle 2
false
0
Polygon -7500403 true true 150 30 15 255 285 255
Polygon -16777216 true false 151 99 225 223 75 224

truck
false
0
Rectangle -7500403 true true 4 45 195 187
Polygon -7500403 true true 296 193 296 150 259 134 244 104 208 104 207 194
Rectangle -1 true false 195 60 195 105
Polygon -16777216 true false 238 112 252 141 219 141 218 112
Circle -16777216 true false 234 174 42
Rectangle -7500403 true true 181 185 214 194
Circle -16777216 true false 144 174 42
Circle -16777216 true false 24 174 42
Circle -7500403 false true 24 174 42
Circle -7500403 false true 144 174 42
Circle -7500403 false true 234 174 42

turtle
true
0
Polygon -10899396 true false 215 204 240 233 246 254 228 266 215 252 193 210
Polygon -10899396 true false 195 90 225 75 245 75 260 89 269 108 261 124 240 105 225 105 210 105
Polygon -10899396 true false 105 90 75 75 55 75 40 89 31 108 39 124 60 105 75 105 90 105
Polygon -10899396 true false 132 85 134 64 107 51 108 17 150 2 192 18 192 52 169 65 172 87
Polygon -10899396 true false 85 204 60 233 54 254 72 266 85 252 107 210
Polygon -7500403 true true 119 75 179 75 209 101 224 135 220 225 175 261 128 261 81 224 74 135 88 99

wheel
false
0
Circle -7500403 true true 3 3 294
Circle -16777216 true false 30 30 240
Line -7500403 true 150 285 150 15
Line -7500403 true 15 150 285 150
Circle -7500403 true true 120 120 60
Line -7500403 true 216 40 79 269
Line -7500403 true 40 84 269 221
Line -7500403 true 40 216 269 79
Line -7500403 true 84 40 221 269

wolf
false
0
Polygon -16777216 true false 253 133 245 131 245 133
Polygon -7500403 true true 2 194 13 197 30 191 38 193 38 205 20 226 20 257 27 265 38 266 40 260 31 253 31 230 60 206 68 198 75 209 66 228 65 243 82 261 84 268 100 267 103 261 77 239 79 231 100 207 98 196 119 201 143 202 160 195 166 210 172 213 173 238 167 251 160 248 154 265 169 264 178 247 186 240 198 260 200 271 217 271 219 262 207 258 195 230 192 198 210 184 227 164 242 144 259 145 284 151 277 141 293 140 299 134 297 127 273 119 270 105
Polygon -7500403 true true -1 195 14 180 36 166 40 153 53 140 82 131 134 133 159 126 188 115 227 108 236 102 238 98 268 86 269 92 281 87 269 103 269 113

x
false
0
Polygon -7500403 true true 270 75 225 30 30 225 75 270
Polygon -7500403 true true 30 75 75 30 270 225 225 270
@#$#@#$#@
NetLogo 6.1.0
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
@#$#@#$#@
default
0.0
-0.2 0 0.0 1.0
0.0 1 1.0 0.0
0.2 0 0.0 1.0
link direction
true
0
Line -7500403 true 150 150 90 180
Line -7500403 true 150 150 210 180
@#$#@#$#@
0
@#$#@#$#@
